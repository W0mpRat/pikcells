!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.configurator=e():t.configurator=e()}(this,(function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=105)}([function(t,e,i){(function(e){var i=function(t){return t&&t.Math==Math&&t};t.exports=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof e&&e)||Function("return this")()}).call(this,i(85))},function(t){t.exports=JSON.parse('{"layerMenus":[{"name":"Vanity","layer_name":"Vanity","description":"One of the hardest-working pieces of furniture in your home, vanities offer exceptional storage and are the anchor for the overall style of the room.","thumbnail":"Vanity.svg","hotspot":{"x":0.81,"y":1.36}},{"name":"Mirrors","layer_name":"Mirrors","description":"One of the hardest-working pieces of furniture in your home, vanities offer exceptional storage and are the anchor for the overall style of the room.","thumbnail":"Mirror.svg","hotspot":{"x":0.65,"y":1.82}},{"name":"Lighting","layer_name":"Sconce Lights","description":"One of the hardest-working pieces of furniture in your home, vanities offer exceptional storage and are the anchor for the overall style of the room.","thumbnail":"Lighting.svg","hotspot":{"x":0.87,"y":1.87}},{"name":"Fixtures","thumbnail":"Fixture.svg","layer_name":"Shower Fixtures","description":"One of the hardest-working pieces of furniture in your home, vanities offer exceptional storage and are the anchor for the overall style of the room.","hotspot":{"x":2.06,"y":1.57},"nested_layers":[{"name":"Shower Fixtures","layer_name":"Shower Fixtures","thumbnail":""},{"name":"Tub Faucets","layer_name":"Tub Faucets","thumbnail":""},{"name":"Vanity Faucets","layer_name":"Vanity Faucets","thumbnail":""},{"name":"Hand Towel Ring","layer_name":"Hand Towel Ring Bar","thumbnail":""},{"name":"Towel Rod Rail","layer_name":"Towel Rod Rail","thumbnail":""}]},{"name":"Toilet","layer_name":"Toilets","description":"One of the hardest-working pieces of furniture in your home, vanities offer exceptional storage and are the anchor for the overall style of the room.","thumbnail":"Toilet.svg","hotspot":{"x":2.99,"y":1.21}},{"name":"Tub","layer_name":"Tubs","description":"One of the hardest-working pieces of furniture in your home, vanities offer exceptional storage and are the anchor for the overall style of the room.","thumbnail":"Tub.svg","hotspot":{"x":1.58,"y":1.3}},{"name":"Walls","thumbnail":"Walls.svg","layer_name":"Wall Paint","description":"One of the hardest-working pieces of furniture in your home, vanities offer exceptional storage and are the anchor for the overall style of the room.","hotspot":{"x":1.26,"y":1.8},"nested_layers":[{"name":"Wall Paint","layer_name":"Wall Paint","thumbnail":""},{"name":"Wallpaper","layer_name":"Wallpaper","thumbnail":""}]},{"name":"Floor","layer_name":"Floors","description":"One of the hardest-working pieces of furniture in your home, vanities offer exceptional storage and are the anchor for the overall style of the room.","thumbnail":"Floors.svg","hotspot":{"x":1.24,"y":1.05}},{"name":"Shower Tile","layer_name":"Shower Tiles","description":"One of the hardest-working pieces of furniture in your home, vanities offer exceptional storage and are the anchor for the overall style of the room.","thumbnail":"Shower Tile.svg","hotspot":{"x":2.38,"y":1.44},"nested_layers":[{"name":"Wall Tiles","layer_name":"Shower Wall Tiles","thumbnail":""},{"name":"Floor Tiles","layer_name":"Showers Floor Tiles","thumbnail":""}]},{"name":"Storage","layer_name":"Floating Shelves","description":"One of the hardest-working pieces of furniture in your home, vanities offer exceptional storage and are the anchor for the overall style of the room.","thumbnail":"Storage.svg","hotspot":{"x":2.98,"y":1.81},"nested_layers":[{"name":"Floating Shelves","layer_name":"Floating Shelves","thumbnail":""},{"name":"Linen Closets","layer_name":"Linen Closets","thumbnail":""}]}]}')},function(t,e){var i={}.hasOwnProperty;t.exports=function(t,e){return i.call(t,e)}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,i){var n=i(5),r=i(44),s=i(13),o=i(16),a=Object.defineProperty;e.f=n?a:function(t,e,i){if(s(t),e=o(e,!0),s(i),r)try{return a(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported");return"value"in i&&(t[e]=i.value),t}},function(t,e,i){var n=i(3);t.exports=!n((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,i){"use strict";var n=i(10),r=i(59);n({target:"Array",proto:!0,forced:[].forEach!=r},{forEach:r})},function(t,e,i){var n=i(0),r=i(97),s=i(59),o=i(11);for(var a in r){var h=n[a],c=h&&h.prototype;if(c&&c.forEach!==s)try{o(c,"forEach",s)}catch(t){c.forEach=s}}},function(t,e,i){var n=i(0),r=i(24),s=i(2),o=i(25),a=i(31),h=i(57),c=r("wks"),l=n.Symbol,u=h?l:l&&l.withoutSetter||o;t.exports=function(t){return s(c,t)||(a&&s(l,t)?c[t]=l[t]:c[t]=u("Symbol."+t)),c[t]}},function(t,e,i){var n=i(0),r=i(21).f,s=i(11),o=i(46),a=i(22),h=i(51),c=i(90);t.exports=function(t,e){var i,l,u,d,E,m=t.target,f=t.global,p=t.stat;if(i=f?n:p?n[m]||a(m,{}):(n[m]||{}).prototype)for(l in e){if(d=e[l],u=t.noTargetGet?(E=r(i,l))&&E.value:i[l],!c(f?l:m+(p?".":"#")+l,t.forced)&&void 0!==u){if(typeof d==typeof u)continue;h(d,u)}(t.sham||u&&u.sham)&&s(d,"sham",!0),o(i,l,d,t)}}},function(t,e,i){var n=i(5),r=i(4),s=i(15);t.exports=n?function(t,e,i){return r.f(t,e,s(1,i))}:function(t,e,i){return t[e]=i,t}},function(t,e,i){var n=i(41),r=i(43);t.exports=function(t){return n(r(t))}},function(t,e,i){var n=i(6);t.exports=function(t){if(!n(t))throw TypeError(String(t)+" is not an object");return t}},function(t,e,i){var n=i(5),r=i(4).f,s=Function.prototype,o=s.toString,a=/^\s*function ([^ (]*)/;n&&!("name"in s)&&r(s,"name",{configurable:!0,get:function(){try{return o.call(this).match(a)[1]}catch(t){return""}}})},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,i){var n=i(6);t.exports=function(t,e){if(!n(t))return t;var i,r;if(e&&"function"==typeof(i=t.toString)&&!n(r=i.call(t)))return r;if("function"==typeof(i=t.valueOf)&&!n(r=i.call(t)))return r;if(!e&&"function"==typeof(i=t.toString)&&!n(r=i.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports={}},function(t,e,i){var n=i(52),r=i(0),s=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?s(n[t])||s(r[t]):n[t]&&n[t][e]||r[t]&&r[t][e]}},function(t,e,i){var n=i(94),r=i(41),s=i(30),o=i(27),a=i(56),h=[].push,c=function(t){var e=1==t,i=2==t,c=3==t,l=4==t,u=6==t,d=5==t||u;return function(E,m,f,p){for(var T,R,A=s(E),g=r(A),v=n(m,f,3),_=o(g.length),O=0,I=p||a,C=e?I(E,_):i?I(E,0):void 0;_>O;O++)if((d||O in g)&&(R=v(T=g[O],O,A),t))if(e)C[O]=R;else if(R)switch(t){case 3:return!0;case 5:return T;case 6:return O;case 2:h.call(C,T)}else if(l)return!1;return u?-1:c||l?l:C}};t.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6)}},function(t,e){t.exports="precision highp float;\r\n\r\nuniform mat4 uMVP;\r\n\r\nattribute vec3 aPosition;\r\nattribute vec2 aTexcoord;\r\n\r\nvarying vec3 vPosition;\r\nvarying vec2 vTexcoord;\r\n\r\nvoid main() {\r\n\r\n  gl_Position = uMVP * vec4(aPosition.xyz, 1.0);\r\n\r\n  vPosition = aPosition;\r\n  vTexcoord = aTexcoord;\r\n}\r\n"},function(t,e,i){var n=i(5),r=i(40),s=i(15),o=i(12),a=i(16),h=i(2),c=i(44),l=Object.getOwnPropertyDescriptor;e.f=n?l:function(t,e){if(t=o(t),e=a(e,!0),c)try{return l(t,e)}catch(t){}if(h(t,e))return s(!r.f.call(t,e),t[e])}},function(t,e,i){var n=i(0),r=i(11);t.exports=function(t,e){try{r(n,t,e)}catch(i){n[t]=e}return e}},function(t,e,i){var n=i(24),r=i(25),s=n("keys");t.exports=function(t){return s[t]||(s[t]=r(t))}},function(t,e,i){var n=i(50),r=i(48);(t.exports=function(t,e){return r[t]||(r[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.6.4",mode:n?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(t,e){var i=0,n=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++i+n).toString(36)}},function(t,e,i){var n=i(53),r=i(28).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,r)}},function(t,e,i){var n=i(54),r=Math.min;t.exports=function(t){return t>0?r(n(t),9007199254740991):0}},function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,e,i){var n=i(42);t.exports=Array.isArray||function(t){return"Array"==n(t)}},function(t,e,i){var n=i(43);t.exports=function(t){return Object(n(t))}},function(t,e,i){var n=i(3);t.exports=!!Object.getOwnPropertySymbols&&!n((function(){return!String(Symbol())}))},function(t,e,i){var n=i(5),r=i(3),s=i(2),o=Object.defineProperty,a={},h=function(t){throw t};t.exports=function(t,e){if(s(a,t))return a[t];e||(e={});var i=[][t],c=!!s(e,"ACCESSORS")&&e.ACCESSORS,l=s(e,0)?e[0]:h,u=s(e,1)?e[1]:void 0;return a[t]=!!i&&!r((function(){if(c&&!n)return!0;var t={length:-1};c?o(t,1,{enumerable:!0,get:h}):t[1]=1,i.call(t,l,u)}))}},function(t,e,i){"use strict";var n=i(10),r=i(19).findIndex,s=i(65),o=i(32),a=!0,h=o("findIndex");"findIndex"in[]&&Array(1).findIndex((function(){a=!1})),n({target:"Array",proto:!0,forced:a||!h},{findIndex:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),s("findIndex")},function(t,e){t.exports="precision lowp float;\r\n\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexcoord;\r\n\r\nvarying vec2 vPosition;\r\nvarying vec2 vTexcoord;\r\n\r\nvoid main() {\r\n\r\n  gl_Position = vec4(aPosition.xy, 0.0, 1.0);\r\n\r\n  vPosition = aPosition;\r\n  vTexcoord = aTexcoord;\r\n}"},function(t,e,i){"use strict";var n=i(81),r="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),s=Object.prototype.toString,o=Array.prototype.concat,a=Object.defineProperty,h=a&&function(){var t={};try{for(var e in a(t,"x",{enumerable:!1,value:t}),t)return!1;return t.x===t}catch(t){return!1}}(),c=function(t,e,i,n){var r;(!(e in t)||"function"==typeof(r=n)&&"[object Function]"===s.call(r)&&n())&&(h?a(t,e,{configurable:!0,enumerable:!1,value:i,writable:!0}):t[e]=i)},l=function(t,e){var i=arguments.length>2?arguments[2]:{},s=n(e);r&&(s=o.call(s,Object.getOwnPropertySymbols(e)));for(var a=0;a<s.length;a+=1)c(t,s[a],e[s[a]],i[s[a]])};l.supportsDescriptors=!!h,t.exports=l},function(t,e,i){"use strict";var n=Object.prototype.toString;t.exports=function(t){var e=n.call(t),i="[object Arguments]"===e;return i||(i="[object Array]"!==e&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===n.call(t.callee)),i}},function(t,e,i){"use strict";t.exports=function(t){if(arguments.length<1)throw new TypeError("1 argument is required");if("object"!=typeof t)throw new TypeError("Argument 1 (”other“) to Node.contains must be an instance of Node");var e=t;do{if(this===e)return!0;e&&(e=e.parentNode)}while(e);return!1}},function(t,e,i){"use strict";var n=i(37);t.exports=function(){if("undefined"!=typeof document){if(document.contains)return document.contains;if(document.body&&document.body.contains)return document.body.contains}return n}},function(t,e,i){"use strict";var n=i(10),r=i(3),s=i(29),o=i(6),a=i(30),h=i(27),c=i(91),l=i(56),u=i(92),d=i(9),E=i(58),m=d("isConcatSpreadable"),f=E>=51||!r((function(){var t=[];return t[m]=!1,t.concat()[0]!==t})),p=u("concat"),T=function(t){if(!o(t))return!1;var e=t[m];return void 0!==e?!!e:s(t)};n({target:"Array",proto:!0,forced:!f||!p},{concat:function(t){var e,i,n,r,s,o=a(this),u=l(o,0),d=0;for(e=-1,n=arguments.length;e<n;e++)if(T(s=-1===e?o:arguments[e])){if(d+(r=h(s.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(i=0;i<r;i++,d++)i in s&&c(u,d,s[i])}else{if(d>=9007199254740991)throw TypeError("Maximum allowed index exceeded");c(u,d++,s)}return u.length=d,u}})},function(t,e,i){"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,s=r&&!n.call({1:2},1);e.f=s?function(t){var e=r(this,t);return!!e&&e.enumerable}:n},function(t,e,i){var n=i(3),r=i(42),s="".split;t.exports=n((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==r(t)?s.call(t,""):Object(t)}:Object},function(t,e){var i={}.toString;t.exports=function(t){return i.call(t).slice(8,-1)}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t}},function(t,e,i){var n=i(5),r=i(3),s=i(45);t.exports=!n&&!r((function(){return 7!=Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}))},function(t,e,i){var n=i(0),r=i(6),s=n.document,o=r(s)&&r(s.createElement);t.exports=function(t){return o?s.createElement(t):{}}},function(t,e,i){var n=i(0),r=i(11),s=i(2),o=i(22),a=i(47),h=i(49),c=h.get,l=h.enforce,u=String(String).split("String");(t.exports=function(t,e,i,a){var h=!!a&&!!a.unsafe,c=!!a&&!!a.enumerable,d=!!a&&!!a.noTargetGet;"function"==typeof i&&("string"!=typeof e||s(i,"name")||r(i,"name",e),l(i).source=u.join("string"==typeof e?e:"")),t!==n?(h?!d&&t[e]&&(c=!0):delete t[e],c?t[e]=i:r(t,e,i)):c?t[e]=i:o(e,i)})(Function.prototype,"toString",(function(){return"function"==typeof this&&c(this).source||a(this)}))},function(t,e,i){var n=i(48),r=Function.toString;"function"!=typeof n.inspectSource&&(n.inspectSource=function(t){return r.call(t)}),t.exports=n.inspectSource},function(t,e,i){var n=i(0),r=i(22),s=n["__core-js_shared__"]||r("__core-js_shared__",{});t.exports=s},function(t,e,i){var n,r,s,o=i(86),a=i(0),h=i(6),c=i(11),l=i(2),u=i(23),d=i(17),E=a.WeakMap;if(o){var m=new E,f=m.get,p=m.has,T=m.set;n=function(t,e){return T.call(m,t,e),e},r=function(t){return f.call(m,t)||{}},s=function(t){return p.call(m,t)}}else{var R=u("state");d[R]=!0,n=function(t,e){return c(t,R,e),e},r=function(t){return l(t,R)?t[R]:{}},s=function(t){return l(t,R)}}t.exports={set:n,get:r,has:s,enforce:function(t){return s(t)?r(t):n(t,{})},getterFor:function(t){return function(e){var i;if(!h(e)||(i=r(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return i}}}},function(t,e){t.exports=!1},function(t,e,i){var n=i(2),r=i(87),s=i(21),o=i(4);t.exports=function(t,e){for(var i=r(e),a=o.f,h=s.f,c=0;c<i.length;c++){var l=i[c];n(t,l)||a(t,l,h(e,l))}}},function(t,e,i){var n=i(0);t.exports=n},function(t,e,i){var n=i(2),r=i(12),s=i(88).indexOf,o=i(17);t.exports=function(t,e){var i,a=r(t),h=0,c=[];for(i in a)!n(o,i)&&n(a,i)&&c.push(i);for(;e.length>h;)n(a,i=e[h++])&&(~s(c,i)||c.push(i));return c}},function(t,e){var i=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:i)(t)}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,i){var n=i(6),r=i(29),s=i(9)("species");t.exports=function(t,e){var i;return r(t)&&("function"!=typeof(i=t.constructor)||i!==Array&&!r(i.prototype)?n(i)&&null===(i=i[s])&&(i=void 0):i=void 0),new(void 0===i?Array:i)(0===e?0:e)}},function(t,e,i){var n=i(31);t.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(t,e,i){var n,r,s=i(0),o=i(93),a=s.process,h=a&&a.versions,c=h&&h.v8;c?r=(n=c.split("."))[0]+n[1]:o&&(!(n=o.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=o.match(/Chrome\/(\d+)/))&&(r=n[1]),t.exports=r&&+r},function(t,e,i){"use strict";var n=i(19).forEach,r=i(96),s=i(32),o=r("forEach"),a=s("forEach");t.exports=o&&a?[].forEach:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}},function(t,e,i){"use strict";var n=i(10),r=i(0),s=i(18),o=i(50),a=i(5),h=i(31),c=i(57),l=i(3),u=i(2),d=i(29),E=i(6),m=i(13),f=i(30),p=i(12),T=i(16),R=i(15),A=i(61),g=i(62),v=i(26),_=i(101),O=i(55),I=i(21),C=i(4),L=i(40),N=i(11),y=i(46),S=i(24),b=i(23),M=i(17),D=i(25),U=i(9),x=i(63),F=i(102),P=i(103),w=i(49),B=i(19).forEach,H=b("hidden"),G=U("toPrimitive"),k=w.set,Y=w.getterFor("Symbol"),X=Object.prototype,V=r.Symbol,$=s("JSON","stringify"),j=I.f,z=C.f,q=_.f,Z=L.f,W=S("symbols"),Q=S("op-symbols"),K=S("string-to-symbol-registry"),J=S("symbol-to-string-registry"),tt=S("wks"),et=r.QObject,it=!et||!et.prototype||!et.prototype.findChild,nt=a&&l((function(){return 7!=A(z({},"a",{get:function(){return z(this,"a",{value:7}).a}})).a}))?function(t,e,i){var n=j(X,e);n&&delete X[e],z(t,e,i),n&&t!==X&&z(X,e,n)}:z,rt=function(t,e){var i=W[t]=A(V.prototype);return k(i,{type:"Symbol",tag:t,description:e}),a||(i.description=e),i},st=c?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof V},ot=function(t,e,i){t===X&&ot(Q,e,i),m(t);var n=T(e,!0);return m(i),u(W,n)?(i.enumerable?(u(t,H)&&t[H][n]&&(t[H][n]=!1),i=A(i,{enumerable:R(0,!1)})):(u(t,H)||z(t,H,R(1,{})),t[H][n]=!0),nt(t,n,i)):z(t,n,i)},at=function(t,e){m(t);var i=p(e),n=g(i).concat(ut(i));return B(n,(function(e){a&&!ht.call(i,e)||ot(t,e,i[e])})),t},ht=function(t){var e=T(t,!0),i=Z.call(this,e);return!(this===X&&u(W,e)&&!u(Q,e))&&(!(i||!u(this,e)||!u(W,e)||u(this,H)&&this[H][e])||i)},ct=function(t,e){var i=p(t),n=T(e,!0);if(i!==X||!u(W,n)||u(Q,n)){var r=j(i,n);return!r||!u(W,n)||u(i,H)&&i[H][n]||(r.enumerable=!0),r}},lt=function(t){var e=q(p(t)),i=[];return B(e,(function(t){u(W,t)||u(M,t)||i.push(t)})),i},ut=function(t){var e=t===X,i=q(e?Q:p(t)),n=[];return B(i,(function(t){!u(W,t)||e&&!u(X,t)||n.push(W[t])})),n};(h||(y((V=function(){if(this instanceof V)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,e=D(t),i=function(t){this===X&&i.call(Q,t),u(this,H)&&u(this[H],e)&&(this[H][e]=!1),nt(this,e,R(1,t))};return a&&it&&nt(X,e,{configurable:!0,set:i}),rt(e,t)}).prototype,"toString",(function(){return Y(this).tag})),y(V,"withoutSetter",(function(t){return rt(D(t),t)})),L.f=ht,C.f=ot,I.f=ct,v.f=_.f=lt,O.f=ut,x.f=function(t){return rt(U(t),t)},a&&(z(V.prototype,"description",{configurable:!0,get:function(){return Y(this).description}}),o||y(X,"propertyIsEnumerable",ht,{unsafe:!0}))),n({global:!0,wrap:!0,forced:!h,sham:!h},{Symbol:V}),B(g(tt),(function(t){F(t)})),n({target:"Symbol",stat:!0,forced:!h},{for:function(t){var e=String(t);if(u(K,e))return K[e];var i=V(e);return K[e]=i,J[i]=e,i},keyFor:function(t){if(!st(t))throw TypeError(t+" is not a symbol");if(u(J,t))return J[t]},useSetter:function(){it=!0},useSimple:function(){it=!1}}),n({target:"Object",stat:!0,forced:!h,sham:!a},{create:function(t,e){return void 0===e?A(t):at(A(t),e)},defineProperty:ot,defineProperties:at,getOwnPropertyDescriptor:ct}),n({target:"Object",stat:!0,forced:!h},{getOwnPropertyNames:lt,getOwnPropertySymbols:ut}),n({target:"Object",stat:!0,forced:l((function(){O.f(1)}))},{getOwnPropertySymbols:function(t){return O.f(f(t))}}),$)&&n({target:"JSON",stat:!0,forced:!h||l((function(){var t=V();return"[null]"!=$([t])||"{}"!=$({a:t})||"{}"!=$(Object(t))}))},{stringify:function(t,e,i){for(var n,r=[t],s=1;arguments.length>s;)r.push(arguments[s++]);if(n=e,(E(e)||void 0!==t)&&!st(t))return d(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!st(e))return e}),r[1]=e,$.apply(null,r)}});V.prototype[G]||N(V.prototype,G,V.prototype.valueOf),P(V,"Symbol"),M[H]=!0},function(t,e,i){var n,r=i(13),s=i(99),o=i(28),a=i(17),h=i(100),c=i(45),l=i(23),u=l("IE_PROTO"),d=function(){},E=function(t){return"<script>"+t+"<\/script>"},m=function(){try{n=document.domain&&new ActiveXObject("htmlfile")}catch(t){}var t,e;m=n?function(t){t.write(E("")),t.close();var e=t.parentWindow.Object;return t=null,e}(n):((e=c("iframe")).style.display="none",h.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(E("document.F=Object")),t.close(),t.F);for(var i=o.length;i--;)delete m.prototype[o[i]];return m()};a[u]=!0,t.exports=Object.create||function(t,e){var i;return null!==t?(d.prototype=r(t),i=new d,d.prototype=null,i[u]=t):i=m(),void 0===e?i:s(i,e)}},function(t,e,i){var n=i(53),r=i(28);t.exports=Object.keys||function(t){return n(t,r)}},function(t,e,i){var n=i(9);e.f=n},function(t,e,i){"use strict";var n=i(10),r=i(5),s=i(0),o=i(2),a=i(6),h=i(4).f,c=i(51),l=s.Symbol;if(r&&"function"==typeof l&&(!("description"in l.prototype)||void 0!==l().description)){var u={},d=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof d?new l(t):void 0===t?l():l(t);return""===t&&(u[e]=!0),e};c(d,l);var E=d.prototype=l.prototype;E.constructor=d;var m=E.toString,f="Symbol(test)"==String(l("test")),p=/^Symbol\((.*)\)[^)]+$/;h(E,"description",{configurable:!0,get:function(){var t=a(this)?this.valueOf():this,e=m.call(t);if(o(u,t))return"";var i=f?e.slice(7,-1):e.replace(p,"$1");return""===i?void 0:i}}),n({global:!0,forced:!0},{Symbol:d})}},function(t,e,i){var n=i(9),r=i(61),s=i(4),o=n("unscopables"),a=Array.prototype;null==a[o]&&s.f(a,o,{configurable:!0,value:r(null)}),t.exports=function(t){a[o][t]=!0}},function(t,e,i){"use strict";var n=i(35),r=i(37),s=i(38),o=s(),a=function(t,e){return o.apply(t,[e])};n(a,{getPolyfill:s,implementation:r,shim:i(83)}),t.exports=a},function(t,e){t.exports="precision lowp float;\r\n\r\nuniform sampler2D uSamplerA;\r\nuniform sampler2D uSamplerB;\r\n\r\nuniform float uAlpha;\r\nuniform float uMixAB;\r\n\r\nvarying vec3 vPosition;\r\nvarying vec2 vTexcoord;\r\n\r\n// ________________________________________________________________________ Main\r\n\r\nvoid main() {\r\n\r\n  // Flip Y\r\n  vec2 texcoord = vec2(vTexcoord.x, 1.0 - vTexcoord.y);\r\n\r\n  // Sample\r\n  vec4 colourA = texture2D(uSamplerA, texcoord);\r\n  vec4 colourB = texture2D(uSamplerB, texcoord);\r\n\r\n  // Mix\r\n  vec4 colour = mix(colourA, colourB, uMixAB);\r\n\r\n  // Apply alpha\r\n  colour.a *= uAlpha;\r\n\r\n  // Out\r\n  gl_FragColor = colour;\r\n}\r\n"},function(t,e){t.exports="precision lowp float;\r\n\r\nuniform float uBlurred;\r\n\r\n// ________________________________________________________________________ Main\r\n\r\nvoid main() {\r\n  // Blurred to R\r\n  gl_FragColor = vec4(uBlurred, 0.0, 0.0, 1.0);\r\n}\r\n"},function(t,e){t.exports="precision lowp float;\r\n\r\nuniform sampler2D uSampler;\r\nuniform vec2 uResolution;\r\n\r\nvarying vec2 vPosition;\r\nvarying vec2 vTexcoord;\r\n\r\n/*\r\n  http://dev.theomader.com/gaussian-kernel-calculator/\r\n\r\n  9\r\n  0.000229\t0.005977\t0.060598\t0.241732\t0.382928\t0.241732\t0.060598\t0.005977\t0.000229\r\n\r\n  11\r\n  0.000003\t0.000229\t0.005977\t0.060598\t0.24173\t0.382925\t0.24173\t0.060598\t0.005977\t0.000229\t0.000003\r\n*/\r\n\r\nvoid main() {\r\n\r\n  float pixel = 1.0 / uResolution.x;\r\n  vec4 col = vec4(0.0, 0.0, 0.0, 1.0);\r\n\r\n  col += texture2D(uSampler, vec2(vTexcoord.x + (5.0 * pixel), vTexcoord.y)) * 0.000003;\r\n  col += texture2D(uSampler, vec2(vTexcoord.x + (4.0 * pixel), vTexcoord.y)) * 0.000229;\r\n  col += texture2D(uSampler, vec2(vTexcoord.x + (3.0 * pixel), vTexcoord.y)) * 0.005977;\r\n  col += texture2D(uSampler, vec2(vTexcoord.x + (2.0 * pixel), vTexcoord.y)) * 0.060598;\r\n  col += texture2D(uSampler, vec2(vTexcoord.x + (1.0 * pixel), vTexcoord.y)) * 0.24173;\r\n\r\n  col += texture2D(uSampler, vec2(vTexcoord.x, vTexcoord.y)) * 0.382925;\r\n\r\n  col += texture2D(uSampler, vec2(vTexcoord.x + (-1.0 * pixel), vTexcoord.y)) * 0.24173;\r\n  col += texture2D(uSampler, vec2(vTexcoord.x + (-2.0 * pixel), vTexcoord.y)) * 0.060598;\r\n  col += texture2D(uSampler, vec2(vTexcoord.x + (-3.0 * pixel), vTexcoord.y)) * 0.005977;\r\n  col += texture2D(uSampler, vec2(vTexcoord.x + (-4.0 * pixel), vTexcoord.y)) * 0.000229;\r\n  col += texture2D(uSampler, vec2(vTexcoord.x + (-5.0 * pixel), vTexcoord.y)) * 0.000003;\r\n\r\n  gl_FragColor = vec4(col.rgb, 1.0);\r\n}"},function(t,e){t.exports="precision lowp float;\r\n\r\nuniform sampler2D uSampler;\r\nuniform vec2 uResolution;\r\n\r\nvarying vec2 vPosition;\r\nvarying vec2 vTexcoord;\r\n\r\n\r\nvoid main() {\r\n\r\n  float pixel = 1.0 / uResolution.y;\r\n  vec4 col = vec4(0.0, 0.0, 0.0, 1.0);\r\n\r\n  col += texture2D(uSampler, vec2(vTexcoord.x, vTexcoord.y + (5.0 * pixel))) * 0.000003;\r\n  col += texture2D(uSampler, vec2(vTexcoord.x, vTexcoord.y + (4.0 * pixel))) * 0.000229;\r\n  col += texture2D(uSampler, vec2(vTexcoord.x, vTexcoord.y + (3.0 * pixel))) * 0.005977;\r\n  col += texture2D(uSampler, vec2(vTexcoord.x, vTexcoord.y + (2.0 * pixel))) * 0.060598;\r\n  col += texture2D(uSampler, vec2(vTexcoord.x, vTexcoord.y + (1.0 * pixel))) * 0.24173;\r\n\r\n  col += texture2D(uSampler, vec2(vTexcoord.x, vTexcoord.y )) * 0.382925;\r\n\r\n  col += texture2D(uSampler, vec2(vTexcoord.x, vTexcoord.y + (-1.0 * pixel))) * 0.24173;\r\n  col += texture2D(uSampler, vec2(vTexcoord.x, vTexcoord.y + (-2.0 * pixel))) * 0.060598;\r\n  col += texture2D(uSampler, vec2(vTexcoord.x, vTexcoord.y + (-3.0 * pixel))) * 0.005977;\r\n  col += texture2D(uSampler, vec2(vTexcoord.x, vTexcoord.y + (-4.0 * pixel))) * 0.000229;\r\n  col += texture2D(uSampler, vec2(vTexcoord.x, vTexcoord.y + (-5.0 * pixel))) * 0.000003;\r\n\r\n  gl_FragColor = vec4(col.rgb, 1.0);\r\n}"},function(t,e){t.exports="precision lowp float;\r\n\r\nattribute vec2 aPosition;\r\nattribute vec2 aTexcoord;\r\n\r\nvarying vec2 vPosition;\r\nvarying vec2 vTexcoord;\r\n\r\nvoid main() {\r\n\r\n  gl_Position = vec4(aPosition.xy, 0.0, 1.0);\r\n\r\n  vPosition = aPosition;\r\n  vTexcoord = aTexcoord;\r\n}"},function(t,e){t.exports="precision lowp float;\r\n\r\nuniform sampler2D uSamplerColour;\r\nuniform sampler2D uSamplerMask;\r\nuniform sampler2D uSamplerBlur;\r\n\r\nvarying vec2 vPosition;\r\nvarying vec2 vTexcoord;\r\n\r\n\r\nvec3 photoshop_desaturate(vec3 color) {\r\n    float bw = (min(color.r, min(color.g, color.b)) + max(color.r, max(color.g, color.b))) * 0.5;\r\n    return vec3(bw, bw, bw);\r\n}\r\n\r\n// ________________________________________________________________________ Main\r\n\r\nvoid main() {\r\n\r\n\t// Sample\r\n\tvec3 colourColour = texture2D(uSamplerColour, vTexcoord).xyz;\r\n  vec3 colourMask = texture2D(uSamplerMask, vTexcoord).xyz;\r\n  vec3 colourBlur = texture2D(uSamplerBlur, vTexcoord).xyz;\r\n\r\n  float blur = colourMask.r;\r\n  float desaturate = 1.0 - (blur * 0.5); // TODO Hardcoded desaturation amount\r\n\r\n  // Desaturate Colour Blur\r\n  vec3 colourBlurDesaturated = photoshop_desaturate(colourBlur);\r\n\r\n  // Mix\r\n  vec3 colour = mix(colourColour, colourBlurDesaturated, blur);\r\n\r\n  // Clamp\r\n  vec3 clamped = clamp(colour, 0.0, 1.0);\r\n\r\n\t// Out\r\n  gl_FragColor = vec4(clamped, 1.0);\r\n\r\n\t// DEV\r\n\t// gl_FragColor = vec4(colourColour.rgb, 1.0);\r\n\t// gl_FragColor = vec4(colourMask.rgb, 1.0);\r\n  // gl_FragColor = vec4(colourBlur.rgb, 1.0);\r\n\r\n  // gl_FragColor = vec4(mix(colourColour, colourMask, 0.5), 1.0);\r\n}\r\n"},function(t,e){t.exports="precision highp float;\r\n\r\nuniform mat4 uMVP;\r\n\r\nattribute vec3 aPosition;\r\nattribute vec2 aTexcoord;\r\n\r\nvarying vec3 vPosition;\r\nvarying vec2 vTexcoord;\r\n\r\nvoid main() {\r\n\r\n  gl_Position = uMVP * vec4(aPosition.xyz, 1.0);\r\n\r\n  vPosition = aPosition;\r\n  vTexcoord = aTexcoord;\r\n}\r\n"},function(t,e){t.exports="precision lowp float;\r\n\r\nvarying vec3 vPosition;\r\nvarying vec2 vTexcoord;\r\n\r\nuniform sampler2D uSampler;\r\n\r\nvoid main(){\r\n\r\n  // Flip Y\r\n  vec2 texcoord = vec2(vTexcoord.x, 1.0 - vTexcoord.y);\r\n\r\n  // Sample\r\n  vec4 colour = texture2D(uSampler, texcoord);\r\n\r\n\t// Out\r\n\tgl_FragColor = vec4(colour.xyz, 1.0);\r\n}"},,,,,,,function(t,e,i){"use strict";var n=Array.prototype.slice,r=i(36),s=Object.keys,o=s?function(t){return s(t)}:i(82),a=Object.keys;o.shim=function(){Object.keys?function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2)||(Object.keys=function(t){return r(t)?a(n.call(t)):a(t)}):Object.keys=o;return Object.keys||o},t.exports=o},function(t,e,i){"use strict";var n;if(!Object.keys){var r=Object.prototype.hasOwnProperty,s=Object.prototype.toString,o=i(36),a=Object.prototype.propertyIsEnumerable,h=!a.call({toString:null},"toString"),c=a.call((function(){}),"prototype"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],u=function(t){var e=t.constructor;return e&&e.prototype===t},d={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},E=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!d["$"+t]&&r.call(window,t)&&null!==window[t]&&"object"==typeof window[t])try{u(window[t])}catch(t){return!0}}catch(t){return!0}return!1}();n=function(t){var e=null!==t&&"object"==typeof t,i="[object Function]"===s.call(t),n=o(t),a=e&&"[object String]"===s.call(t),d=[];if(!e&&!i&&!n)throw new TypeError("Object.keys called on a non-object");var m=c&&i;if(a&&t.length>0&&!r.call(t,0))for(var f=0;f<t.length;++f)d.push(String(f));if(n&&t.length>0)for(var p=0;p<t.length;++p)d.push(String(p));else for(var T in t)m&&"prototype"===T||!r.call(t,T)||d.push(String(T));if(h)for(var R=function(t){if("undefined"==typeof window||!E)return u(t);try{return u(t)}catch(t){return!1}}(t),A=0;A<l.length;++A)R&&"constructor"===l[A]||!r.call(t,l[A])||d.push(l[A]);return d}}t.exports=n},function(t,e,i){"use strict";var n=i(35),r=i(38);t.exports=function(){var t=r();return"undefined"!=typeof document&&(n(document,{contains:t},{contains:function(){return document.contains!==t}}),"undefined"!=typeof Element&&n(Element.prototype,{contains:t},{contains:function(){return Element.prototype.contains!==t}})),t}},function(t,e,i){},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){var n=i(0),r=i(47),s=n.WeakMap;t.exports="function"==typeof s&&/native code/.test(r(s))},function(t,e,i){var n=i(18),r=i(26),s=i(55),o=i(13);t.exports=n("Reflect","ownKeys")||function(t){var e=r.f(o(t)),i=s.f;return i?e.concat(i(t)):e}},function(t,e,i){var n=i(12),r=i(27),s=i(89),o=function(t){return function(e,i,o){var a,h=n(e),c=r(h.length),l=s(o,c);if(t&&i!=i){for(;c>l;)if((a=h[l++])!=a)return!0}else for(;c>l;l++)if((t||l in h)&&h[l]===i)return t||l||0;return!t&&-1}};t.exports={includes:o(!0),indexOf:o(!1)}},function(t,e,i){var n=i(54),r=Math.max,s=Math.min;t.exports=function(t,e){var i=n(t);return i<0?r(i+e,0):s(i,e)}},function(t,e,i){var n=i(3),r=/#|\.prototype\./,s=function(t,e){var i=a[o(t)];return i==c||i!=h&&("function"==typeof e?n(e):!!e)},o=s.normalize=function(t){return String(t).replace(r,".").toLowerCase()},a=s.data={},h=s.NATIVE="N",c=s.POLYFILL="P";t.exports=s},function(t,e,i){"use strict";var n=i(16),r=i(4),s=i(15);t.exports=function(t,e,i){var o=n(e);o in t?r.f(t,o,s(0,i)):t[o]=i}},function(t,e,i){var n=i(3),r=i(9),s=i(58),o=r("species");t.exports=function(t){return s>=51||!n((function(){var e=[];return(e.constructor={})[o]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},function(t,e,i){var n=i(18);t.exports=n("navigator","userAgent")||""},function(t,e,i){var n=i(95);t.exports=function(t,e,i){if(n(t),void 0===e)return t;switch(i){case 0:return function(){return t.call(e)};case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,r){return t.call(e,i,n,r)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},function(t,e,i){"use strict";var n=i(3);t.exports=function(t,e){var i=[][t];return!!i&&n((function(){i.call(null,e||function(){throw 1},1)}))}},function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(t,e){Math.easeInOutQuad=function(t,e,i,n){return(t/=n/2)<1?i/2*t*t+e:-i/2*((t-=1)*(t-2)-1)+e}},function(t,e,i){var n=i(5),r=i(4),s=i(13),o=i(62);t.exports=n?Object.defineProperties:function(t,e){s(t);for(var i,n=o(e),a=n.length,h=0;a>h;)r.f(t,i=n[h++],e[i]);return t}},function(t,e,i){var n=i(18);t.exports=n("document","documentElement")},function(t,e,i){var n=i(12),r=i(26).f,s={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return o&&"[object Window]"==s.call(t)?function(t){try{return r(t)}catch(t){return o.slice()}}(t):r(n(t))}},function(t,e,i){var n=i(52),r=i(2),s=i(63),o=i(4).f;t.exports=function(t){var e=n.Symbol||(n.Symbol={});r(e,t)||o(e,t,{value:s.f(t)})}},function(t,e,i){var n=i(4).f,r=i(2),s=i(9)("toStringTag");t.exports=function(t,e,i){t&&!r(t=i?t:t.prototype,s)&&n(t,s,{configurable:!0,value:e})}},function(t,e,i){"use strict";var n=i(10),r=i(19).find,s=i(65),o=i(32),a=!0,h=o("find");"find"in[]&&Array(1).find((function(){a=!1})),n({target:"Array",proto:!0,forced:a||!h},{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),s("find")},function(t,e,i){"use strict";i.r(e),i.d(e,"create",(function(){return Fn}));var n={};i.r(n),i.d(n,"create",(function(){return R})),i.d(n,"clone",(function(){return A})),i.d(n,"copy",(function(){return g})),i.d(n,"fromValues",(function(){return v})),i.d(n,"set",(function(){return _})),i.d(n,"identity",(function(){return O})),i.d(n,"transpose",(function(){return I})),i.d(n,"invert",(function(){return C})),i.d(n,"adjoint",(function(){return L})),i.d(n,"determinant",(function(){return N})),i.d(n,"multiply",(function(){return y})),i.d(n,"translate",(function(){return S})),i.d(n,"scale",(function(){return b})),i.d(n,"rotate",(function(){return M})),i.d(n,"rotateX",(function(){return D})),i.d(n,"rotateY",(function(){return U})),i.d(n,"rotateZ",(function(){return x})),i.d(n,"fromTranslation",(function(){return F})),i.d(n,"fromScaling",(function(){return P})),i.d(n,"fromRotation",(function(){return w})),i.d(n,"fromXRotation",(function(){return B})),i.d(n,"fromYRotation",(function(){return H})),i.d(n,"fromZRotation",(function(){return G})),i.d(n,"fromRotationTranslation",(function(){return k})),i.d(n,"fromQuat2",(function(){return Y})),i.d(n,"getTranslation",(function(){return X})),i.d(n,"getScaling",(function(){return V})),i.d(n,"getRotation",(function(){return $})),i.d(n,"fromRotationTranslationScale",(function(){return j})),i.d(n,"fromRotationTranslationScaleOrigin",(function(){return z})),i.d(n,"fromQuat",(function(){return q})),i.d(n,"frustum",(function(){return Z})),i.d(n,"perspectiveNO",(function(){return W})),i.d(n,"perspective",(function(){return Q})),i.d(n,"perspectiveZO",(function(){return K})),i.d(n,"perspectiveFromFieldOfView",(function(){return J})),i.d(n,"orthoNO",(function(){return tt})),i.d(n,"ortho",(function(){return et})),i.d(n,"orthoZO",(function(){return it})),i.d(n,"lookAt",(function(){return nt})),i.d(n,"targetTo",(function(){return rt})),i.d(n,"str",(function(){return st})),i.d(n,"frob",(function(){return ot})),i.d(n,"add",(function(){return at})),i.d(n,"subtract",(function(){return ht})),i.d(n,"multiplyScalar",(function(){return ct})),i.d(n,"multiplyScalarAndAdd",(function(){return lt})),i.d(n,"exactEquals",(function(){return ut})),i.d(n,"equals",(function(){return dt})),i.d(n,"mul",(function(){return Et})),i.d(n,"sub",(function(){return mt}));var r={};i.r(r),i.d(r,"create",(function(){return ft})),i.d(r,"clone",(function(){return pt})),i.d(r,"length",(function(){return Tt})),i.d(r,"fromValues",(function(){return Rt})),i.d(r,"copy",(function(){return At})),i.d(r,"set",(function(){return gt})),i.d(r,"add",(function(){return vt})),i.d(r,"subtract",(function(){return _t})),i.d(r,"multiply",(function(){return Ot})),i.d(r,"divide",(function(){return It})),i.d(r,"ceil",(function(){return Ct})),i.d(r,"floor",(function(){return Lt})),i.d(r,"min",(function(){return Nt})),i.d(r,"max",(function(){return yt})),i.d(r,"round",(function(){return St})),i.d(r,"scale",(function(){return bt})),i.d(r,"scaleAndAdd",(function(){return Mt})),i.d(r,"distance",(function(){return Dt})),i.d(r,"squaredDistance",(function(){return Ut})),i.d(r,"squaredLength",(function(){return xt})),i.d(r,"negate",(function(){return Ft})),i.d(r,"inverse",(function(){return Pt})),i.d(r,"normalize",(function(){return wt})),i.d(r,"dot",(function(){return Bt})),i.d(r,"cross",(function(){return Ht})),i.d(r,"lerp",(function(){return Gt})),i.d(r,"hermite",(function(){return kt})),i.d(r,"bezier",(function(){return Yt})),i.d(r,"random",(function(){return Xt})),i.d(r,"transformMat4",(function(){return Vt})),i.d(r,"transformMat3",(function(){return $t})),i.d(r,"transformQuat",(function(){return jt})),i.d(r,"rotateX",(function(){return zt})),i.d(r,"rotateY",(function(){return qt})),i.d(r,"rotateZ",(function(){return Zt})),i.d(r,"angle",(function(){return Wt})),i.d(r,"zero",(function(){return Qt})),i.d(r,"str",(function(){return Kt})),i.d(r,"exactEquals",(function(){return Jt})),i.d(r,"equals",(function(){return te})),i.d(r,"sub",(function(){return ie})),i.d(r,"mul",(function(){return ne})),i.d(r,"div",(function(){return re})),i.d(r,"dist",(function(){return se})),i.d(r,"sqrDist",(function(){return oe})),i.d(r,"len",(function(){return ae})),i.d(r,"sqrLen",(function(){return he})),i.d(r,"forEach",(function(){return ce}));var s={};i.r(s),i.d(s,"create",(function(){return le})),i.d(s,"clone",(function(){return ue})),i.d(s,"fromValues",(function(){return de})),i.d(s,"copy",(function(){return Ee})),i.d(s,"set",(function(){return me})),i.d(s,"add",(function(){return fe})),i.d(s,"subtract",(function(){return pe})),i.d(s,"multiply",(function(){return Te})),i.d(s,"divide",(function(){return Re})),i.d(s,"ceil",(function(){return Ae})),i.d(s,"floor",(function(){return ge})),i.d(s,"min",(function(){return ve})),i.d(s,"max",(function(){return _e})),i.d(s,"round",(function(){return Oe})),i.d(s,"scale",(function(){return Ie})),i.d(s,"scaleAndAdd",(function(){return Ce})),i.d(s,"distance",(function(){return Le})),i.d(s,"squaredDistance",(function(){return Ne})),i.d(s,"length",(function(){return ye})),i.d(s,"squaredLength",(function(){return Se})),i.d(s,"negate",(function(){return be})),i.d(s,"inverse",(function(){return Me})),i.d(s,"normalize",(function(){return De})),i.d(s,"dot",(function(){return Ue})),i.d(s,"cross",(function(){return xe})),i.d(s,"lerp",(function(){return Fe})),i.d(s,"random",(function(){return Pe})),i.d(s,"transformMat4",(function(){return we})),i.d(s,"transformQuat",(function(){return Be})),i.d(s,"zero",(function(){return He})),i.d(s,"str",(function(){return Ge})),i.d(s,"exactEquals",(function(){return ke})),i.d(s,"equals",(function(){return Ye})),i.d(s,"sub",(function(){return Xe})),i.d(s,"mul",(function(){return Ve})),i.d(s,"div",(function(){return $e})),i.d(s,"dist",(function(){return je})),i.d(s,"sqrDist",(function(){return ze})),i.d(s,"len",(function(){return qe})),i.d(s,"sqrLen",(function(){return Ze})),i.d(s,"forEach",(function(){return We}));window.Element.prototype,window.Document.prototype,window.DocumentFragment.prototype;var o=window.Element.prototype,a=function(){o.closest||(o.closest=function(t){for(var e=this;e&&1===e.nodeType;){if(e.matches(t))return e;e=e.parentNode}return null})},h=(window.Element.prototype,window.Element.prototype,window.Element.prototype),c=window.Document.prototype,l=window.DocumentFragment.prototype,u=function(){h.prepend&&c.prepend&&l.prepend||(h.prepend=c.prepend=l.prepend=function(){var t=window.Array.prototype.slice.call(arguments),e=window.document.createDocumentFragment();t.forEach((function(t){var i=t instanceof window.Node;e.appendChild(i?t:document.createTextNode(window.String(t)))})),this.insertBefore(e,this.firstChild)})};window.NodeList.prototype,window.HTMLCollection.prototype,window.CharacterData.prototype,window.DocumentType.prototype,window.Element.prototype,window.Element.prototype,window.DocumentType.prototype,window.CharacterData.prototype,window.NodeList.prototype;const d=a,E=u;var m=i(66),f=(i.p,i(84),i(39),i(7),i(14),i(8),1e-6),p="undefined"!=typeof Float32Array?Float32Array:Array,T=Math.random;Math.PI;function R(){var t=new p(16);return p!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function A(t){var e=new p(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function g(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function v(t,e,i,n,r,s,o,a,h,c,l,u,d,E,m,f){var T=new p(16);return T[0]=t,T[1]=e,T[2]=i,T[3]=n,T[4]=r,T[5]=s,T[6]=o,T[7]=a,T[8]=h,T[9]=c,T[10]=l,T[11]=u,T[12]=d,T[13]=E,T[14]=m,T[15]=f,T}function _(t,e,i,n,r,s,o,a,h,c,l,u,d,E,m,f,p){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t[4]=s,t[5]=o,t[6]=a,t[7]=h,t[8]=c,t[9]=l,t[10]=u,t[11]=d,t[12]=E,t[13]=m,t[14]=f,t[15]=p,t}function O(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function I(t,e){if(t===e){var i=e[1],n=e[2],r=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=s,t[11]=e[14],t[12]=r,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function C(t,e){var i=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],h=e[6],c=e[7],l=e[8],u=e[9],d=e[10],E=e[11],m=e[12],f=e[13],p=e[14],T=e[15],R=i*a-n*o,A=i*h-r*o,g=i*c-s*o,v=n*h-r*a,_=n*c-s*a,O=r*c-s*h,I=l*f-u*m,C=l*p-d*m,L=l*T-E*m,N=u*p-d*f,y=u*T-E*f,S=d*T-E*p,b=R*S-A*y+g*N+v*L-_*C+O*I;return b?(b=1/b,t[0]=(a*S-h*y+c*N)*b,t[1]=(r*y-n*S-s*N)*b,t[2]=(f*O-p*_+T*v)*b,t[3]=(d*_-u*O-E*v)*b,t[4]=(h*L-o*S-c*C)*b,t[5]=(i*S-r*L+s*C)*b,t[6]=(p*g-m*O-T*A)*b,t[7]=(l*O-d*g+E*A)*b,t[8]=(o*y-a*L+c*I)*b,t[9]=(n*L-i*y-s*I)*b,t[10]=(m*_-f*g+T*R)*b,t[11]=(u*g-l*_-E*R)*b,t[12]=(a*C-o*N-h*I)*b,t[13]=(i*N-n*C+r*I)*b,t[14]=(f*A-m*v-p*R)*b,t[15]=(l*v-u*A+d*R)*b,t):null}function L(t,e){var i=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],h=e[6],c=e[7],l=e[8],u=e[9],d=e[10],E=e[11],m=e[12],f=e[13],p=e[14],T=e[15];return t[0]=a*(d*T-E*p)-u*(h*T-c*p)+f*(h*E-c*d),t[1]=-(n*(d*T-E*p)-u*(r*T-s*p)+f*(r*E-s*d)),t[2]=n*(h*T-c*p)-a*(r*T-s*p)+f*(r*c-s*h),t[3]=-(n*(h*E-c*d)-a*(r*E-s*d)+u*(r*c-s*h)),t[4]=-(o*(d*T-E*p)-l*(h*T-c*p)+m*(h*E-c*d)),t[5]=i*(d*T-E*p)-l*(r*T-s*p)+m*(r*E-s*d),t[6]=-(i*(h*T-c*p)-o*(r*T-s*p)+m*(r*c-s*h)),t[7]=i*(h*E-c*d)-o*(r*E-s*d)+l*(r*c-s*h),t[8]=o*(u*T-E*f)-l*(a*T-c*f)+m*(a*E-c*u),t[9]=-(i*(u*T-E*f)-l*(n*T-s*f)+m*(n*E-s*u)),t[10]=i*(a*T-c*f)-o*(n*T-s*f)+m*(n*c-s*a),t[11]=-(i*(a*E-c*u)-o*(n*E-s*u)+l*(n*c-s*a)),t[12]=-(o*(u*p-d*f)-l*(a*p-h*f)+m*(a*d-h*u)),t[13]=i*(u*p-d*f)-l*(n*p-r*f)+m*(n*d-r*u),t[14]=-(i*(a*p-h*f)-o*(n*p-r*f)+m*(n*h-r*a)),t[15]=i*(a*d-h*u)-o*(n*d-r*u)+l*(n*h-r*a),t}function N(t){var e=t[0],i=t[1],n=t[2],r=t[3],s=t[4],o=t[5],a=t[6],h=t[7],c=t[8],l=t[9],u=t[10],d=t[11],E=t[12],m=t[13],f=t[14],p=t[15];return(e*o-i*s)*(u*p-d*f)-(e*a-n*s)*(l*p-d*m)+(e*h-r*s)*(l*f-u*m)+(i*a-n*o)*(c*p-d*E)-(i*h-r*o)*(c*f-u*E)+(n*h-r*a)*(c*m-l*E)}function y(t,e,i){var n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],c=e[6],l=e[7],u=e[8],d=e[9],E=e[10],m=e[11],f=e[12],p=e[13],T=e[14],R=e[15],A=i[0],g=i[1],v=i[2],_=i[3];return t[0]=A*n+g*a+v*u+_*f,t[1]=A*r+g*h+v*d+_*p,t[2]=A*s+g*c+v*E+_*T,t[3]=A*o+g*l+v*m+_*R,A=i[4],g=i[5],v=i[6],_=i[7],t[4]=A*n+g*a+v*u+_*f,t[5]=A*r+g*h+v*d+_*p,t[6]=A*s+g*c+v*E+_*T,t[7]=A*o+g*l+v*m+_*R,A=i[8],g=i[9],v=i[10],_=i[11],t[8]=A*n+g*a+v*u+_*f,t[9]=A*r+g*h+v*d+_*p,t[10]=A*s+g*c+v*E+_*T,t[11]=A*o+g*l+v*m+_*R,A=i[12],g=i[13],v=i[14],_=i[15],t[12]=A*n+g*a+v*u+_*f,t[13]=A*r+g*h+v*d+_*p,t[14]=A*s+g*c+v*E+_*T,t[15]=A*o+g*l+v*m+_*R,t}function S(t,e,i){var n,r,s,o,a,h,c,l,u,d,E,m,f=i[0],p=i[1],T=i[2];return e===t?(t[12]=e[0]*f+e[4]*p+e[8]*T+e[12],t[13]=e[1]*f+e[5]*p+e[9]*T+e[13],t[14]=e[2]*f+e[6]*p+e[10]*T+e[14],t[15]=e[3]*f+e[7]*p+e[11]*T+e[15]):(n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],c=e[6],l=e[7],u=e[8],d=e[9],E=e[10],m=e[11],t[0]=n,t[1]=r,t[2]=s,t[3]=o,t[4]=a,t[5]=h,t[6]=c,t[7]=l,t[8]=u,t[9]=d,t[10]=E,t[11]=m,t[12]=n*f+a*p+u*T+e[12],t[13]=r*f+h*p+d*T+e[13],t[14]=s*f+c*p+E*T+e[14],t[15]=o*f+l*p+m*T+e[15]),t}function b(t,e,i){var n=i[0],r=i[1],s=i[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function M(t,e,i,n){var r,s,o,a,h,c,l,u,d,E,m,p,T,R,A,g,v,_,O,I,C,L,N,y,S=n[0],b=n[1],M=n[2],D=Math.hypot(S,b,M);return D<f?null:(S*=D=1/D,b*=D,M*=D,r=Math.sin(i),o=1-(s=Math.cos(i)),a=e[0],h=e[1],c=e[2],l=e[3],u=e[4],d=e[5],E=e[6],m=e[7],p=e[8],T=e[9],R=e[10],A=e[11],g=S*S*o+s,v=b*S*o+M*r,_=M*S*o-b*r,O=S*b*o-M*r,I=b*b*o+s,C=M*b*o+S*r,L=S*M*o+b*r,N=b*M*o-S*r,y=M*M*o+s,t[0]=a*g+u*v+p*_,t[1]=h*g+d*v+T*_,t[2]=c*g+E*v+R*_,t[3]=l*g+m*v+A*_,t[4]=a*O+u*I+p*C,t[5]=h*O+d*I+T*C,t[6]=c*O+E*I+R*C,t[7]=l*O+m*I+A*C,t[8]=a*L+u*N+p*y,t[9]=h*L+d*N+T*y,t[10]=c*L+E*N+R*y,t[11]=l*L+m*N+A*y,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function D(t,e,i){var n=Math.sin(i),r=Math.cos(i),s=e[4],o=e[5],a=e[6],h=e[7],c=e[8],l=e[9],u=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*r+c*n,t[5]=o*r+l*n,t[6]=a*r+u*n,t[7]=h*r+d*n,t[8]=c*r-s*n,t[9]=l*r-o*n,t[10]=u*r-a*n,t[11]=d*r-h*n,t}function U(t,e,i){var n=Math.sin(i),r=Math.cos(i),s=e[0],o=e[1],a=e[2],h=e[3],c=e[8],l=e[9],u=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*r-c*n,t[1]=o*r-l*n,t[2]=a*r-u*n,t[3]=h*r-d*n,t[8]=s*n+c*r,t[9]=o*n+l*r,t[10]=a*n+u*r,t[11]=h*n+d*r,t}function x(t,e,i){var n=Math.sin(i),r=Math.cos(i),s=e[0],o=e[1],a=e[2],h=e[3],c=e[4],l=e[5],u=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*r+c*n,t[1]=o*r+l*n,t[2]=a*r+u*n,t[3]=h*r+d*n,t[4]=c*r-s*n,t[5]=l*r-o*n,t[6]=u*r-a*n,t[7]=d*r-h*n,t}function F(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function P(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function w(t,e,i){var n,r,s,o=i[0],a=i[1],h=i[2],c=Math.hypot(o,a,h);return c<f?null:(o*=c=1/c,a*=c,h*=c,n=Math.sin(e),s=1-(r=Math.cos(e)),t[0]=o*o*s+r,t[1]=a*o*s+h*n,t[2]=h*o*s-a*n,t[3]=0,t[4]=o*a*s-h*n,t[5]=a*a*s+r,t[6]=h*a*s+o*n,t[7]=0,t[8]=o*h*s+a*n,t[9]=a*h*s-o*n,t[10]=h*h*s+r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function B(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=i,t[7]=0,t[8]=0,t[9]=-i,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function H(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-i,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=i,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function G(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=0,t[3]=0,t[4]=-i,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function k(t,e,i){var n=e[0],r=e[1],s=e[2],o=e[3],a=n+n,h=r+r,c=s+s,l=n*a,u=n*h,d=n*c,E=r*h,m=r*c,f=s*c,p=o*a,T=o*h,R=o*c;return t[0]=1-(E+f),t[1]=u+R,t[2]=d-T,t[3]=0,t[4]=u-R,t[5]=1-(l+f),t[6]=m+p,t[7]=0,t[8]=d+T,t[9]=m-p,t[10]=1-(l+E),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function Y(t,e){var i=new p(3),n=-e[0],r=-e[1],s=-e[2],o=e[3],a=e[4],h=e[5],c=e[6],l=e[7],u=n*n+r*r+s*s+o*o;return u>0?(i[0]=2*(a*o+l*n+h*s-c*r)/u,i[1]=2*(h*o+l*r+c*n-a*s)/u,i[2]=2*(c*o+l*s+a*r-h*n)/u):(i[0]=2*(a*o+l*n+h*s-c*r),i[1]=2*(h*o+l*r+c*n-a*s),i[2]=2*(c*o+l*s+a*r-h*n)),k(t,e,i),t}function X(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function V(t,e){var i=e[0],n=e[1],r=e[2],s=e[4],o=e[5],a=e[6],h=e[8],c=e[9],l=e[10];return t[0]=Math.hypot(i,n,r),t[1]=Math.hypot(s,o,a),t[2]=Math.hypot(h,c,l),t}function $(t,e){var i=new p(3);V(i,e);var n=1/i[0],r=1/i[1],s=1/i[2],o=e[0]*n,a=e[1]*r,h=e[2]*s,c=e[4]*n,l=e[5]*r,u=e[6]*s,d=e[8]*n,E=e[9]*r,m=e[10]*s,f=o+l+m,T=0;return f>0?(T=2*Math.sqrt(f+1),t[3]=.25*T,t[0]=(u-E)/T,t[1]=(d-h)/T,t[2]=(a-c)/T):o>l&&o>m?(T=2*Math.sqrt(1+o-l-m),t[3]=(u-E)/T,t[0]=.25*T,t[1]=(a+c)/T,t[2]=(d+h)/T):l>m?(T=2*Math.sqrt(1+l-o-m),t[3]=(d-h)/T,t[0]=(a+c)/T,t[1]=.25*T,t[2]=(u+E)/T):(T=2*Math.sqrt(1+m-o-l),t[3]=(a-c)/T,t[0]=(d+h)/T,t[1]=(u+E)/T,t[2]=.25*T),t}function j(t,e,i,n){var r=e[0],s=e[1],o=e[2],a=e[3],h=r+r,c=s+s,l=o+o,u=r*h,d=r*c,E=r*l,m=s*c,f=s*l,p=o*l,T=a*h,R=a*c,A=a*l,g=n[0],v=n[1],_=n[2];return t[0]=(1-(m+p))*g,t[1]=(d+A)*g,t[2]=(E-R)*g,t[3]=0,t[4]=(d-A)*v,t[5]=(1-(u+p))*v,t[6]=(f+T)*v,t[7]=0,t[8]=(E+R)*_,t[9]=(f-T)*_,t[10]=(1-(u+m))*_,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function z(t,e,i,n,r){var s=e[0],o=e[1],a=e[2],h=e[3],c=s+s,l=o+o,u=a+a,d=s*c,E=s*l,m=s*u,f=o*l,p=o*u,T=a*u,R=h*c,A=h*l,g=h*u,v=n[0],_=n[1],O=n[2],I=r[0],C=r[1],L=r[2],N=(1-(f+T))*v,y=(E+g)*v,S=(m-A)*v,b=(E-g)*_,M=(1-(d+T))*_,D=(p+R)*_,U=(m+A)*O,x=(p-R)*O,F=(1-(d+f))*O;return t[0]=N,t[1]=y,t[2]=S,t[3]=0,t[4]=b,t[5]=M,t[6]=D,t[7]=0,t[8]=U,t[9]=x,t[10]=F,t[11]=0,t[12]=i[0]+I-(N*I+b*C+U*L),t[13]=i[1]+C-(y*I+M*C+x*L),t[14]=i[2]+L-(S*I+D*C+F*L),t[15]=1,t}function q(t,e){var i=e[0],n=e[1],r=e[2],s=e[3],o=i+i,a=n+n,h=r+r,c=i*o,l=n*o,u=n*a,d=r*o,E=r*a,m=r*h,f=s*o,p=s*a,T=s*h;return t[0]=1-u-m,t[1]=l+T,t[2]=d-p,t[3]=0,t[4]=l-T,t[5]=1-c-m,t[6]=E+f,t[7]=0,t[8]=d+p,t[9]=E-f,t[10]=1-c-u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Z(t,e,i,n,r,s,o){var a=1/(i-e),h=1/(r-n),c=1/(s-o);return t[0]=2*s*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*s*h,t[6]=0,t[7]=0,t[8]=(i+e)*a,t[9]=(r+n)*h,t[10]=(o+s)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*c,t[15]=0,t}function W(t,e,i,n,r){var s,o=1/Math.tan(e/2);return t[0]=o/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(s=1/(n-r),t[10]=(r+n)*s,t[14]=2*r*n*s):(t[10]=-1,t[14]=-2*n),t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Q=W;function K(t,e,i,n,r){var s,o=1/Math.tan(e/2);return t[0]=o/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(s=1/(n-r),t[10]=r*s,t[14]=r*n*s):(t[10]=-1,t[14]=-n),t}function J(t,e,i,n){var r=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),h=2/(o+a),c=2/(r+s);return t[0]=h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(o-a)*h*.5,t[9]=(r-s)*c*.5,t[10]=n/(i-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*i/(i-n),t[15]=0,t}function tt(t,e,i,n,r,s,o){var a=1/(e-i),h=1/(n-r),c=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+i)*a,t[13]=(r+n)*h,t[14]=(o+s)*c,t[15]=1,t}var et=tt;function it(t,e,i,n,r,s,o){var a=1/(e-i),h=1/(n-r),c=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=c,t[11]=0,t[12]=(e+i)*a,t[13]=(r+n)*h,t[14]=s*c,t[15]=1,t}function nt(t,e,i,n){var r,s,o,a,h,c,l,u,d,E,m=e[0],p=e[1],T=e[2],R=n[0],A=n[1],g=n[2],v=i[0],_=i[1],I=i[2];return Math.abs(m-v)<f&&Math.abs(p-_)<f&&Math.abs(T-I)<f?O(t):(l=m-v,u=p-_,d=T-I,r=A*(d*=E=1/Math.hypot(l,u,d))-g*(u*=E),s=g*(l*=E)-R*d,o=R*u-A*l,(E=Math.hypot(r,s,o))?(r*=E=1/E,s*=E,o*=E):(r=0,s=0,o=0),a=u*o-d*s,h=d*r-l*o,c=l*s-u*r,(E=Math.hypot(a,h,c))?(a*=E=1/E,h*=E,c*=E):(a=0,h=0,c=0),t[0]=r,t[1]=a,t[2]=l,t[3]=0,t[4]=s,t[5]=h,t[6]=u,t[7]=0,t[8]=o,t[9]=c,t[10]=d,t[11]=0,t[12]=-(r*m+s*p+o*T),t[13]=-(a*m+h*p+c*T),t[14]=-(l*m+u*p+d*T),t[15]=1,t)}function rt(t,e,i,n){var r=e[0],s=e[1],o=e[2],a=n[0],h=n[1],c=n[2],l=r-i[0],u=s-i[1],d=o-i[2],E=l*l+u*u+d*d;E>0&&(l*=E=1/Math.sqrt(E),u*=E,d*=E);var m=h*d-c*u,f=c*l-a*d,p=a*u-h*l;return(E=m*m+f*f+p*p)>0&&(m*=E=1/Math.sqrt(E),f*=E,p*=E),t[0]=m,t[1]=f,t[2]=p,t[3]=0,t[4]=u*p-d*f,t[5]=d*m-l*p,t[6]=l*f-u*m,t[7]=0,t[8]=l,t[9]=u,t[10]=d,t[11]=0,t[12]=r,t[13]=s,t[14]=o,t[15]=1,t}function st(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function ot(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function at(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t[9]=e[9]+i[9],t[10]=e[10]+i[10],t[11]=e[11]+i[11],t[12]=e[12]+i[12],t[13]=e[13]+i[13],t[14]=e[14]+i[14],t[15]=e[15]+i[15],t}function ht(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t[9]=e[9]-i[9],t[10]=e[10]-i[10],t[11]=e[11]-i[11],t[12]=e[12]-i[12],t[13]=e[13]-i[13],t[14]=e[14]-i[14],t[15]=e[15]-i[15],t}function ct(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12]*i,t[13]=e[13]*i,t[14]=e[14]*i,t[15]=e[15]*i,t}function lt(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t[4]=e[4]+i[4]*n,t[5]=e[5]+i[5]*n,t[6]=e[6]+i[6]*n,t[7]=e[7]+i[7]*n,t[8]=e[8]+i[8]*n,t[9]=e[9]+i[9]*n,t[10]=e[10]+i[10]*n,t[11]=e[11]+i[11]*n,t[12]=e[12]+i[12]*n,t[13]=e[13]+i[13]*n,t[14]=e[14]+i[14]*n,t[15]=e[15]+i[15]*n,t}function ut(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function dt(t,e){var i=t[0],n=t[1],r=t[2],s=t[3],o=t[4],a=t[5],h=t[6],c=t[7],l=t[8],u=t[9],d=t[10],E=t[11],m=t[12],p=t[13],T=t[14],R=t[15],A=e[0],g=e[1],v=e[2],_=e[3],O=e[4],I=e[5],C=e[6],L=e[7],N=e[8],y=e[9],S=e[10],b=e[11],M=e[12],D=e[13],U=e[14],x=e[15];return Math.abs(i-A)<=f*Math.max(1,Math.abs(i),Math.abs(A))&&Math.abs(n-g)<=f*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(r-v)<=f*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(s-_)<=f*Math.max(1,Math.abs(s),Math.abs(_))&&Math.abs(o-O)<=f*Math.max(1,Math.abs(o),Math.abs(O))&&Math.abs(a-I)<=f*Math.max(1,Math.abs(a),Math.abs(I))&&Math.abs(h-C)<=f*Math.max(1,Math.abs(h),Math.abs(C))&&Math.abs(c-L)<=f*Math.max(1,Math.abs(c),Math.abs(L))&&Math.abs(l-N)<=f*Math.max(1,Math.abs(l),Math.abs(N))&&Math.abs(u-y)<=f*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(d-S)<=f*Math.max(1,Math.abs(d),Math.abs(S))&&Math.abs(E-b)<=f*Math.max(1,Math.abs(E),Math.abs(b))&&Math.abs(m-M)<=f*Math.max(1,Math.abs(m),Math.abs(M))&&Math.abs(p-D)<=f*Math.max(1,Math.abs(p),Math.abs(D))&&Math.abs(T-U)<=f*Math.max(1,Math.abs(T),Math.abs(U))&&Math.abs(R-x)<=f*Math.max(1,Math.abs(R),Math.abs(x))}var Et=y,mt=ht;function ft(){var t=new p(3);return p!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function pt(t){var e=new p(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Tt(t){var e=t[0],i=t[1],n=t[2];return Math.hypot(e,i,n)}function Rt(t,e,i){var n=new p(3);return n[0]=t,n[1]=e,n[2]=i,n}function At(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function gt(t,e,i,n){return t[0]=e,t[1]=i,t[2]=n,t}function vt(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}function _t(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}function Ot(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t}function It(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t}function Ct(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function Lt(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function Nt(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t}function yt(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t}function St(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function bt(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function Mt(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t}function Dt(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2];return Math.hypot(i,n,r)}function Ut(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2];return i*i+n*n+r*r}function xt(t){var e=t[0],i=t[1],n=t[2];return e*e+i*i+n*n}function Ft(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Pt(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function wt(t,e){var i=e[0],n=e[1],r=e[2],s=i*i+n*n+r*r;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function Bt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ht(t,e,i){var n=e[0],r=e[1],s=e[2],o=i[0],a=i[1],h=i[2];return t[0]=r*h-s*a,t[1]=s*o-n*h,t[2]=n*a-r*o,t}function Gt(t,e,i,n){var r=e[0],s=e[1],o=e[2];return t[0]=r+n*(i[0]-r),t[1]=s+n*(i[1]-s),t[2]=o+n*(i[2]-o),t}function kt(t,e,i,n,r,s){var o=s*s,a=o*(2*s-3)+1,h=o*(s-2)+s,c=o*(s-1),l=o*(3-2*s);return t[0]=e[0]*a+i[0]*h+n[0]*c+r[0]*l,t[1]=e[1]*a+i[1]*h+n[1]*c+r[1]*l,t[2]=e[2]*a+i[2]*h+n[2]*c+r[2]*l,t}function Yt(t,e,i,n,r,s){var o=1-s,a=o*o,h=s*s,c=a*o,l=3*s*a,u=3*h*o,d=h*s;return t[0]=e[0]*c+i[0]*l+n[0]*u+r[0]*d,t[1]=e[1]*c+i[1]*l+n[1]*u+r[1]*d,t[2]=e[2]*c+i[2]*l+n[2]*u+r[2]*d,t}function Xt(t,e){e=e||1;var i=2*T()*Math.PI,n=2*T()-1,r=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(i)*r,t[1]=Math.sin(i)*r,t[2]=n*e,t}function Vt(t,e,i){var n=e[0],r=e[1],s=e[2],o=i[3]*n+i[7]*r+i[11]*s+i[15];return o=o||1,t[0]=(i[0]*n+i[4]*r+i[8]*s+i[12])/o,t[1]=(i[1]*n+i[5]*r+i[9]*s+i[13])/o,t[2]=(i[2]*n+i[6]*r+i[10]*s+i[14])/o,t}function $t(t,e,i){var n=e[0],r=e[1],s=e[2];return t[0]=n*i[0]+r*i[3]+s*i[6],t[1]=n*i[1]+r*i[4]+s*i[7],t[2]=n*i[2]+r*i[5]+s*i[8],t}function jt(t,e,i){var n=i[0],r=i[1],s=i[2],o=i[3],a=e[0],h=e[1],c=e[2],l=r*c-s*h,u=s*a-n*c,d=n*h-r*a,E=r*d-s*u,m=s*l-n*d,f=n*u-r*l,p=2*o;return l*=p,u*=p,d*=p,E*=2,m*=2,f*=2,t[0]=a+l+E,t[1]=h+u+m,t[2]=c+d+f,t}function zt(t,e,i,n){var r=[],s=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],s[0]=r[0],s[1]=r[1]*Math.cos(n)-r[2]*Math.sin(n),s[2]=r[1]*Math.sin(n)+r[2]*Math.cos(n),t[0]=s[0]+i[0],t[1]=s[1]+i[1],t[2]=s[2]+i[2],t}function qt(t,e,i,n){var r=[],s=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],s[0]=r[2]*Math.sin(n)+r[0]*Math.cos(n),s[1]=r[1],s[2]=r[2]*Math.cos(n)-r[0]*Math.sin(n),t[0]=s[0]+i[0],t[1]=s[1]+i[1],t[2]=s[2]+i[2],t}function Zt(t,e,i,n){var r=[],s=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],s[0]=r[0]*Math.cos(n)-r[1]*Math.sin(n),s[1]=r[0]*Math.sin(n)+r[1]*Math.cos(n),s[2]=r[2],t[0]=s[0]+i[0],t[1]=s[1]+i[1],t[2]=s[2]+i[2],t}function Wt(t,e){var i=t[0],n=t[1],r=t[2],s=e[0],o=e[1],a=e[2],h=Math.sqrt(i*i+n*n+r*r)*Math.sqrt(s*s+o*o+a*a),c=h&&Bt(t,e)/h;return Math.acos(Math.min(Math.max(c,-1),1))}function Qt(t){return t[0]=0,t[1]=0,t[2]=0,t}function Kt(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Jt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function te(t,e){var i=t[0],n=t[1],r=t[2],s=e[0],o=e[1],a=e[2];return Math.abs(i-s)<=f*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(n-o)<=f*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=f*Math.max(1,Math.abs(r),Math.abs(a))}var ee,ie=_t,ne=Ot,re=It,se=Dt,oe=Ut,ae=Tt,he=xt,ce=(ee=ft(),function(t,e,i,n,r,s){var o,a;for(e||(e=3),i||(i=0),a=n?Math.min(n*e+i,t.length):t.length,o=i;o<a;o+=e)ee[0]=t[o],ee[1]=t[o+1],ee[2]=t[o+2],r(ee,ee,s),t[o]=ee[0],t[o+1]=ee[1],t[o+2]=ee[2];return t});function le(){var t=new p(4);return p!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function ue(t){var e=new p(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function de(t,e,i,n){var r=new p(4);return r[0]=t,r[1]=e,r[2]=i,r[3]=n,r}function Ee(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function me(t,e,i,n,r){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t}function fe(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t}function pe(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t}function Te(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t}function Re(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t[3]=e[3]/i[3],t}function Ae(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function ge(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function ve(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t[3]=Math.min(e[3],i[3]),t}function _e(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t[3]=Math.max(e[3],i[3]),t}function Oe(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function Ie(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t}function Ce(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t}function Le(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2],s=e[3]-t[3];return Math.hypot(i,n,r,s)}function Ne(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2],s=e[3]-t[3];return i*i+n*n+r*r+s*s}function ye(t){var e=t[0],i=t[1],n=t[2],r=t[3];return Math.hypot(e,i,n,r)}function Se(t){var e=t[0],i=t[1],n=t[2],r=t[3];return e*e+i*i+n*n+r*r}function be(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function Me(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function De(t,e){var i=e[0],n=e[1],r=e[2],s=e[3],o=i*i+n*n+r*r+s*s;return o>0&&(o=1/Math.sqrt(o)),t[0]=i*o,t[1]=n*o,t[2]=r*o,t[3]=s*o,t}function Ue(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function xe(t,e,i,n){var r=i[0]*n[1]-i[1]*n[0],s=i[0]*n[2]-i[2]*n[0],o=i[0]*n[3]-i[3]*n[0],a=i[1]*n[2]-i[2]*n[1],h=i[1]*n[3]-i[3]*n[1],c=i[2]*n[3]-i[3]*n[2],l=e[0],u=e[1],d=e[2],E=e[3];return t[0]=u*c-d*h+E*a,t[1]=-l*c+d*o-E*s,t[2]=l*h-u*o+E*r,t[3]=-l*a+u*s-d*r,t}function Fe(t,e,i,n){var r=e[0],s=e[1],o=e[2],a=e[3];return t[0]=r+n*(i[0]-r),t[1]=s+n*(i[1]-s),t[2]=o+n*(i[2]-o),t[3]=a+n*(i[3]-a),t}function Pe(t,e){var i,n,r,s,o,a;e=e||1;do{o=(i=2*T()-1)*i+(n=2*T()-1)*n}while(o>=1);do{a=(r=2*T()-1)*r+(s=2*T()-1)*s}while(a>=1);var h=Math.sqrt((1-o)/a);return t[0]=e*i,t[1]=e*n,t[2]=e*r*h,t[3]=e*s*h,t}function we(t,e,i){var n=e[0],r=e[1],s=e[2],o=e[3];return t[0]=i[0]*n+i[4]*r+i[8]*s+i[12]*o,t[1]=i[1]*n+i[5]*r+i[9]*s+i[13]*o,t[2]=i[2]*n+i[6]*r+i[10]*s+i[14]*o,t[3]=i[3]*n+i[7]*r+i[11]*s+i[15]*o,t}function Be(t,e,i){var n=e[0],r=e[1],s=e[2],o=i[0],a=i[1],h=i[2],c=i[3],l=c*n+a*s-h*r,u=c*r+h*n-o*s,d=c*s+o*r-a*n,E=-o*n-a*r-h*s;return t[0]=l*c+E*-o+u*-h-d*-a,t[1]=u*c+E*-a+d*-o-l*-h,t[2]=d*c+E*-h+l*-a-u*-o,t[3]=e[3],t}function He(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function Ge(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function ke(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function Ye(t,e){var i=t[0],n=t[1],r=t[2],s=t[3],o=e[0],a=e[1],h=e[2],c=e[3];return Math.abs(i-o)<=f*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(n-a)<=f*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-h)<=f*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(s-c)<=f*Math.max(1,Math.abs(s),Math.abs(c))}var Xe=pe,Ve=Te,$e=Re,je=Le,ze=Ne,qe=ye,Ze=Se,We=function(){var t=le();return function(e,i,n,r,s,o){var a,h;for(i||(i=4),n||(n=0),h=r?Math.min(r*i+n,e.length):e.length,a=n;a<h;a+=i)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}}();class Qe{constructor(){this.fovY=45,this.near=.001,this.far=10,this.aspectRatio=1,this.positionEye=r.fromValues(0,0,-2),this.positionTarget=r.fromValues(0,0,0),this.vectorUp=r.fromValues(0,1,0),this.matrixP=n.create(),this.matrixMV=n.create(),this.matrixMVP=n.create(),this.matrixLookat=n.create(),this.update()}update(){const t=this.matrixP,e=this.matrixMV,i=this.matrixMVP,r=this.matrixLookat;n.perspective(t,this.fovY,this.aspectRatio,this.near,this.far),n.lookAt(r,this.positionEye,this.positionTarget,this.vectorUp),n.multiply(t,t,r),n.identity(e),n.copy(i,t),n.multiply(i,i,e)}setPositionEye(t,e,i){this.positionEye[0]=t,this.positionEye[1]=e,this.positionEye[2]=i}setPositionTarget(t,e,i){this.positionTarget[0]=t,this.positionTarget[1]=e,this.positionTarget[2]=i}setFOV(t){this.fovY=t}setAspectRatio(t,e){this.aspectRatio=t/e}getDirectionNormalised(){const t=this.positionEye,e=this.positionTarget,i=r.fromValues(t[0]-e[0],t[1]-e[1],t[2]-e[2]);return r.normalize(i,i),i}getMatrixMVP(){return this.matrixMVP}}class Ke{constructor(t){this.CONTROLLER=t}init(t){this.CAMERA_PERSPECTIVE=new Qe,this.RADIUS_INTERIOR=1e-4,this.RADIUS_EXTERIOR=1.5,this.RADIUS_LERP=.1,this.radius=this.RADIUS_INTERIOR,this.radiusTarget=this.radius,this.ROTATION_LERP=t.rotationLerp?t.rotationLerp:.1,this.rotationThetaMin=0,this.rotationThetaMax=0,this.rotationThetaIsLimited=!1,this.rotationPhiMin=.01*Math.PI,this.rotationPhiMax=.99*Math.PI,this.rotationTheta=t.rotationThetaInitial?t.rotationThetaInitial:0,this.rotationPhi=t.rotationPhiInitial?t.rotationPhiInitial:.5*Math.PI,this.rotationTargetTheta=this.rotationTheta,this.rotationTargetPhi=this.rotationPhi,this.ZOOM_FOV_BASE=45,this.ZOOM_MAX=.5,this.ZOOM_DELTA=this.ZOOM_MAX/5,this.ZOOM_LERP=.1,this.zoom=0,this.zoomTarget=0,this.DISTANCE_MOVE_FOR_CHANGE=1e-5,this.hasChangedThisFrame=!0,this.tick()}tick(){const{ROTATION_LERP:t,CAMERA_PERSPECTIVE:e,DISTANCE_MOVE_FOR_CHANGE:i}=this,n=2*Math.PI,r=this.radius,s=this.zoom,o=this.rotationTheta,a=this.rotationPhi;this.radius+=(this.radiusTarget-this.radius)*this.RADIUS_LERP,this.rotationTheta+=(this.rotationTargetTheta-this.rotationTheta)*t,this.rotationTheta>n&&(this.rotationTheta-=n,this.rotationTargetTheta-=n),this.rotationTheta<-n&&(this.rotationTheta+=n,this.rotationTargetTheta+=n),this.rotationPhi+=(this.rotationTargetPhi-this.rotationPhi)*t;const h=Math.sin(this.rotationTheta),c=Math.cos(this.rotationTheta),l=Math.sin(this.rotationPhi),u=Math.cos(this.rotationPhi);e.setPositionEye(l*h*this.radius,u*this.radius,l*c*this.radius),this.zoom+=(this.zoomTarget-this.zoom)*this.ZOOM_LERP,e.setFOV(this.ZOOM_FOV_BASE+this.zoom),e.update();let d=!1;Math.abs(r-this.radius)>i&&(d=!0),Math.abs(s-this.zoom)>i&&(d=!0),Math.abs(o-this.rotationTheta)>i&&(d=!0),Math.abs(a-this.rotationPhi)>i&&(d=!0),this.hasChangedThisFrame=d}getThetaBound(t){if(!1===this.rotationThetaIsLimited)return t;let e=t;const{rotationThetaMin:i}=this,{rotationThetaMax:n}=this;return e<i&&(e=i),e>n&&(e=n),e}getPhiBound(t){const{rotationPhiMin:e}=this,{rotationPhiMax:i}=this;let n=t;return n<e&&(n=e),n>i&&(n=i),n}rotateHorizontal(t){const e=t*(1+this.zoom),i=this.rotationTargetTheta-e;this.rotationTargetTheta=this.getThetaBound(i)}rotateVertical(t){const e=t*(1+this.zoom),i=this.rotationTargetPhi-e;this.rotationTargetPhi=this.getPhiBound(i)}setRotation(t,e){this.rotationTheta=this.getThetaBound(t),this.rotationTargetTheta=this.rotationTheta,this.rotationPhi=this.getPhiBound(e),this.rotationTargetPhi=this.rotationPhi}setRotationTarget(t,e){const i=2*Math.PI;let n=t;for(;n>i;)n-=i;for(;n<-i;)n+=i;n=this.getThetaBound(n),n=this.closestRotation(n,this.rotationTargetTheta),this.rotationTargetTheta=n,this.rotationTargetPhi=this.getPhiBound(e)}closestRotation(t,e){let i=t;for(;i>e+Math.PI;)i-=2*Math.PI;for(;i<e-Math.PI;)i+=2*Math.PI;return i}setRotationLimitsTheta(t,e){this.rotationThetaMin=t,this.rotationThetaMax=e,this.rotationThetaIsLimited=!0}clearRotationLimitsTheta(){this.rotationThetaMin=0,this.rotationThetaMax=0,this.rotationThetaIsLimited=!1}setRotationLimitsPhi(t,e){this.rotationPhiMin=t,this.rotationPhiMax=e}clearRotationLimitsPhi(){this.rotationPhiMin=.01*Math.PI,this.rotationPhiMax=.99*Math.PI}zoomIn(){const{ZOOM_MAX:t}=this;let e=this.zoomTarget-this.ZOOM_DELTA;e<-t&&(e=-t),this.zoomTarget=e}zoomOut(){let t=this.zoomTarget+this.ZOOM_DELTA;t>0&&(t=0),this.zoomTarget=t}setZoom(t){const{ZOOM_MAX:e}=this;let i=-t;i<-e&&(i=-e),i>0&&(i=0),this.zoom=i,this.zoomTarget=i}setZoomTarget(t){const{ZOOM_MAX:e}=this;let i=-t;i<-e&&(i=-e),this.zoomTarget=i}setExternalView(t){this.radiusTarget=t?this.RADIUS_EXTERIOR:this.RADIUS_INTERIOR}setSize(t,e){const{CAMERA_PERSPECTIVE:i}=this;i.setAspectRatio(t,e)}getMatrixMVP(){return this.CAMERA_PERSPECTIVE.getMatrixMVP()}getDirectionNormalised(){return this.CAMERA_PERSPECTIVE.getDirectionNormalised()}getDirectionNormalisedInverted(){const t=this.CAMERA_PERSPECTIVE.getDirectionNormalised();return t[0]=-t[0],t[1]=-t[1],t[2]=-t[2],t}getRotationPhi(){return this.rotationPhi}getRotationTheta(){return this.rotationTheta}getHasChangedThisFrame(){return this.hasChangedThisFrame}}class Je{constructor(t,e){this.CONTROLLER=t,this.CANVAS=e,this.positionPreviousX=-1,this.positionPreviousY=-1,this.isDown=!1}enable(){const{CANVAS:t}=this;this.disable(),t.onmousedown=this.onMouseDown.bind(this),t.ontouchstart=this.onTouchStart.bind(this),t.onmousemove=this.onMouseMove.bind(this),t.ontouchmove=this.onTouchMove.bind(this),t.onmouseup=this.onMouseUp.bind(this),t.onmouseout=this.onMouseOut.bind(this),t.ontouchend=this.onTouchEnd.bind(this),t.onwheel=this.onWheel.bind(this)}disable(){const{CANVAS:t}=this;t.onmousedown=void 0,t.ontouchstart=void 0,t.onmousemove=void 0,t.ontouchmove=void 0,t.onmouseup=void 0,t.onmouseout=void 0,t.ontouchend=void 0,t.onwheel=void 0}onMouseDown(t){t.preventDefault();const e=this.CANVAS.getBoundingClientRect();this.onInteractionStart(t.clientX-e.left,t.clientY-e.top)}onTouchStart(t){t.preventDefault();const e=t.changedTouches[0],i=this.CANVAS.getBoundingClientRect();this.onInteractionStart(e.clientX-i.left,e.clientY-i.top)}onInteractionStart(t,e){this.positionPreviousX=t,this.positionPreviousY=e,this.isDown=!0}onMouseMove(t){t.preventDefault();const e=this.CANVAS.getBoundingClientRect();this.onInteractionMove(t.clientX-e.left,t.clientY-e.top)}onTouchMove(t){t.preventDefault();const e=t.changedTouches[0],i=this.CANVAS.getBoundingClientRect();this.onInteractionMove(e.clientX-i.left,e.clientY-i.top)}onInteractionMove(t,e){if(!0===this.isDown){const{CONTROLLER:i}=this;i.rotateHorizontal(-(t-this.positionPreviousX)/500),i.rotateVertical(-(e-this.positionPreviousY)/500)}this.positionPreviousX=t,this.positionPreviousY=e}onMouseUp(t){t.preventDefault();const e=this.CANVAS.getBoundingClientRect();this.onInteractionEnd(t.clientX-e.left,t.clientY-e.top)}onTouchEnd(t){t.preventDefault();const e=t.changedTouches[0],i=this.CANVAS.getBoundingClientRect();this.onInteractionEnd(e.clientX-i.left,e.clientY-i.top)}onMouseOut(t){t.preventDefault();const e=this.CANVAS.getBoundingClientRect();this.onInteractionEnd(t.clientX-e.left,t.clientY-e.top)}onInteractionEnd(t,e){this.positionPreviousX=t,this.positionPreviousY=e,this.isDown=!1}onWheel(t){t.preventDefault(),t.deltaY<0?this.CONTROLLER.onInteractionZoom(-1):t.deltaY>0&&this.CONTROLLER.onInteractionZoom(1)}}function ti(t,e,i){const n=t.createShader(t.VERTEX_SHADER);t.shaderSource(n,e),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)||console.error("Util. getShaderProgram. Vert. "+t.getShaderInfoLog(n));const r=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(r,i),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)||console.error("Util. getShaderProgram. Frag. "+t.getShaderInfoLog(r));const s=t.createProgram();return t.attachShader(s,n),t.attachShader(s,r),t.linkProgram(s),t.getProgramParameter(s,t.LINK_STATUS)||console.error("Util. getShaderProgram. Link. "+t.getProgramInfoLog(s)),null!==s?s:null}function ei(){return new Float32Array([0,0,1,0,1,1,1,1,0,1,0,0])}var ii=i(20),ni=i.n(ii),ri=i(67),si=i.n(ri);class oi{constructor(t,e,i,n,r,s,o){this.GL=t,this.CALLBACK_LOADED=s,this.IS_TEXTURE_A=o,this.IS_EXTENSION_ANISOTROPIC=e.getIsExtensionAnisotropic(),!0===this.IS_EXTENSION_ANISOTROPIC&&(this.EXTENSION_ANISOTROPIC=e.getExtensionAnisotropic(),this.EXTENSION_ANISOTROPIC_MAX=e.getExtensionAnisotropicMax());const{GL:a}=this;this.TEXTURE=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.TEXTURE),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,i),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),!0===this.IS_EXTENSION_ANISOTROPIC&&a.texParameterf(a.TEXTURE_2D,this.EXTENSION_ANISOTROPIC.TEXTURE_MAX_ANISOTROPY_EXT,this.EXTENSION_ANISOTROPIC_MAX),a.bindTexture(a.TEXTURE_2D,null),this.IMAGE=new Image,this.IMAGE.width=n,this.IMAGE.height=r,this.IMAGE.crossOrigin="",this.IMAGE.onload=this.onImageLoaded.bind(this),this.IMAGE.onerror=this.onImageLoadError.bind(this),this.url="",this.IMAGE_RELOAD_COUNT_MAX=3,this.IMAGE_RELOAD_DELAY_MS=500,this.imageReloadCount=this.IMAGE_RELOAD_COUNT_MAX,this.imageReloadTimeout=void 0,this.isImageLoaded=!1}loadImage(t){void 0!==this.imageReloadTimeout&&(clearTimeout(this.imageReloadTimeout),this.imageReloadTimeout=void 0),this.imageReloadCount=this.IMAGE_RELOAD_COUNT_MAX,this.isImageLoaded=!1,this.url=t,this.IMAGE.src=t}onImageLoaded(){this.updateTexture(),this.isImageLoaded=!0,this.CALLBACK_LOADED(this.IS_TEXTURE_A,this.url)}onImageLoadError(){this.imageReloadCount>0&&(this.imageReloadTimeout=setTimeout(this.onDelayedImageReload.bind(this),this.IMAGE_RELOAD_DELAY_MS))}onDelayedImageReload(){this.imageReloadTimeout=void 0,!0!==this.isImageLoaded&&(this.imageReloadCount-=1,this.IMAGE.src=this.url)}updateTexture(){const{GL:t,IMAGE:e,TEXTURE:i}=this;t.bindTexture(t.TEXTURE_2D,i),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.generateMipmap(t.TEXTURE_2D),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),!0===this.IS_EXTENSION_ANISOTROPIC&&t.texParameterf(t.TEXTURE_2D,this.EXTENSION_ANISOTROPIC.TEXTURE_MAX_ANISOTROPY_EXT,this.EXTENSION_ANISOTROPIC_MAX),t.bindTexture(t.TEXTURE_2D,null)}getTexture(){return this.TEXTURE}}class ai{constructor(t,e,i,n){this.GL=t,this.CUBE_FACE=e;const{GL:r}=this;this.PROGRAM=ti(r,ni.a,si.a),r.useProgram(this.PROGRAM),this.U_MATRIX_MVP=r.getUniformLocation(this.PROGRAM,"uMVP"),this.BUFFER_POSITIONS=r.createBuffer(),this.A_POSITION=r.getAttribLocation(this.PROGRAM,"aPosition"),r.enableVertexAttribArray(this.A_POSITION),this.TEXTURE_COORDINATES=ei(),this.BUFFER_TEXTURE_COORDINATES=r.createBuffer(),this.A_TEXTURE_COORDINATES=r.getAttribLocation(this.PROGRAM,"aTexcoord"),r.enableVertexAttribArray(this.A_TEXTURE_COORDINATES),r.bindBuffer(r.ARRAY_BUFFER,this.BUFFER_TEXTURE_COORDINATES),r.bufferData(r.ARRAY_BUFFER,this.TEXTURE_COORDINATES,r.STATIC_DRAW),r.vertexAttribPointer(this.A_TEXTURE_COORDINATES,2,r.FLOAT,!1,0,0),this.U_SAMPLER_A=r.getUniformLocation(this.PROGRAM,"uSamplerA"),this.U_SAMPLER_B=r.getUniformLocation(this.PROGRAM,"uSamplerB"),this.TEXTURE_A=new oi(r,i,n,512,512,this.onTextureLoaded.bind(this),!0),this.TEXTURE_B=new oi(r,i,n,512,512,this.onTextureLoaded.bind(this),!1),this.U_MIX_AB=r.getUniformLocation(this.PROGRAM,"uMixAB"),this.U_ALPHA=r.getUniformLocation(this.PROGRAM,"uAlpha"),r.useProgram(null)}render(t,e,i,n,r){const{GL:s}=this;s.useProgram(this.PROGRAM),s.uniformMatrix4fv(this.U_MATRIX_MVP,!1,t),s.bindBuffer(s.ARRAY_BUFFER,this.BUFFER_POSITIONS),s.bufferData(s.ARRAY_BUFFER,i,s.STATIC_DRAW),s.vertexAttribPointer(this.A_POSITION,3,s.FLOAT,!1,0,0),s.bindBuffer(s.ARRAY_BUFFER,this.BUFFER_TEXTURE_COORDINATES),s.vertexAttribPointer(this.A_TEXTURE_COORDINATES,2,s.FLOAT,!1,0,0),s.activeTexture(s.TEXTURE0),s.uniform1i(this.U_SAMPLER_A,0),s.bindTexture(s.TEXTURE_2D,this.TEXTURE_A.getTexture()),s.activeTexture(s.TEXTURE1),s.uniform1i(this.U_SAMPLER_B,1),s.bindTexture(s.TEXTURE_2D,this.TEXTURE_B.getTexture()),s.uniform1f(this.U_MIX_AB,n),s.uniform1f(this.U_ALPHA,r),s.drawArrays(s.TRIANGLES,0,e),s.bindBuffer(s.ARRAY_BUFFER,null),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,null),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,null),s.useProgram(null)}loadTextureA(t){this.TEXTURE_A.loadImage(t)}loadTextureB(t){this.TEXTURE_B.loadImage(t)}onTextureLoaded(t,e){this.CUBE_FACE.onTextureLoaded(t,e)}}var hi=i(68),ci=i.n(hi);class li{constructor(t){this.GL=t;const{GL:e}=this;this.PROGRAM=ti(e,ni.a,ci.a),e.useProgram(this.PROGRAM),this.U_MATRIX_MVP=e.getUniformLocation(this.PROGRAM,"uMVP"),this.BUFFER_POSITIONS=e.createBuffer(),this.A_POSITION=e.getAttribLocation(this.PROGRAM,"aPosition"),e.enableVertexAttribArray(this.A_POSITION),this.U_BLURRED=e.getUniformLocation(this.PROGRAM,"uBlurred"),e.useProgram(null)}render(t,e,i,n){const{GL:r}=this;r.useProgram(this.PROGRAM),r.uniformMatrix4fv(this.U_MATRIX_MVP,!1,t),r.bindBuffer(r.ARRAY_BUFFER,this.BUFFER_POSITIONS),r.bufferData(r.ARRAY_BUFFER,i,r.STATIC_DRAW),r.vertexAttribPointer(this.A_POSITION,3,r.FLOAT,!1,0,0),r.uniform1f(this.U_BLURRED,n),r.drawArrays(r.TRIANGLES,0,e),r.bindBuffer(r.ARRAY_BUFFER,null),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,null),r.activeTexture(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,null),r.useProgram(null)}}class ui{constructor(t,e,i,n,s,o,a,h,c,l){this.GL=t,this.ID_SURFACE=e,this.ID_X=i,this.ID_Y=n,this.VERTICES=new Float32Array([s[0],s[1],s[2],o[0],o[1],o[2],a[0],a[1],a[2],a[0],a[1],a[2],h[0],h[1],h[2],s[0],s[1],s[2]]),this.VERTEX_TOTAL=this.VERTICES.length/3,this.CENTER_POINT=r.fromValues((s[0]+a[0])/2,(s[1]+a[1])/2,(s[2]+a[2])/2),this.RENDERER_COLOUR=new ai(t,this,l,c),this.RENDERER_BLUR_MASK=new li(t),this.MIX_AB_LERP=.05,this.mixAB=0,this.mixABTarget=0,this.ALPHA_LERP=.05,this.alpha=0,this.alphaTarget=1,this.isTextureA=!1,this.BLUR_LERP=.05,this.blur=1,this.blurTarget=1,this.DISTANCE_MOVE_FOR_CHANGE=1e-4,this.hasChangedThisFrame=!0,this.hasDelayedLoad=!1,this.isActive=!1}tick(){const{DISTANCE_MOVE_FOR_CHANGE:t}=this,e=this.alpha,i=this.mixAB,n=this.blur;this.alpha+=(this.alphaTarget-this.alpha)*this.ALPHA_LERP,this.mixAB+=(this.mixABTarget-this.mixAB)*this.MIX_AB_LERP,this.blur+=(this.blurTarget-this.blur)*this.BLUR_LERP;let r=!1;Math.abs(e-this.alpha)>t&&(r=!0),Math.abs(i-this.mixAB)>t&&(r=!0),Math.abs(n-this.blur)>t&&(r=!0),this.hasChangedThisFrame=r}renderColour(t){!1!==this.isActive&&this.RENDERER_COLOUR.render(t,this.VERTEX_TOTAL,this.VERTICES,this.mixAB,this.alpha)}renderBlurMask(t){!1!==this.isActive&&this.RENDERER_BLUR_MASK.render(t,this.VERTEX_TOTAL,this.VERTICES,this.blur)}setActive(){!0!==this.isActive&&(!0===this.hasDelayedLoad&&this.loadImage(this.latestRequestedUrl),this.isActive=!0)}setInactive(){!1!==this.isActive&&(this.isActive=!1)}setImagePath(t){const e=`${t}${this.ID_SURFACE}_${this.ID_X}_${this.ID_Y}.jpg`;this.latestRequestedUrl=e,!1===this.isActive?this.hasDelayedLoad=!0:this.loadImage(e),this.blurTarget=1}loadImage(t){t===this.latestRequestedUrl&&(!0===this.isTextureA?this.RENDERER_COLOUR.loadTextureA(t):this.RENDERER_COLOUR.loadTextureB(t),this.hasDelayedLoad=!1)}onTextureLoaded(t,e){e===this.latestRequestedUrl&&(this.alphaTarget=1,this.mixABTarget=!0===t?0:1,this.blurTarget=0,this.isTextureA=!t)}getCenterPoint(){return this.CENTER_POINT}getHasChangedThisFrame(){return this.hasChangedThisFrame}}class di{constructor(t){this.CONTROLLER=t}init(t,e,i,n,s,o){this.RENDER_CONTROLLER=e,this.CUBE_DETAIL=i,this.FACE_ANGLE_ACTIVE=n;const a=function(t,e,i,n){function r(t){const e=t.toString(16);return 1===e.length?"0"+e:e}function s(t,e,i){return`#${r(t)}${r(e)}${r(i)}`}const o=document.createElement("canvas");o.width=t,o.height=e;const a=o.getContext("2d"),h=s(Math.floor(255*i[0]),Math.floor(255*i[1]),Math.floor(255*i[2]));a.fillStyle=h,a.fillRect(0,0,t,e);const c=s(Math.floor(255*n[0]),Math.floor(255*n[1]),Math.floor(255*n[2]));return a.fillStyle=c,a.fillRect(0,0,2,2),a.fillRect(0,e-2,2,2),a.fillRect(t-2,0,2,2),a.fillRect(t-2,e-2,2,2),a.fillRect(.5*t-2,.5*e-2,4,4),o}(256,256,s,o);this.FACE_TOTAL=this.CUBE_DETAIL*this.CUBE_DETAIL*6,this.FACES=[];const h=1/this.CUBE_DETAIL,c=h*(-.5*this.CUBE_DETAIL);let l,u,d,E,m,f,p,T,R;for(l=0;l<this.CUBE_DETAIL;l+=1)for(u=0;u<this.CUBE_DETAIL;u+=1)E=c+l*h+1,m=c+u*h,d=this.CUBE_DETAIL-u-1,f=[c,m,1-E],p=[c,m,1-(E+h)],T=[c,m+h,1-(E+h)],R=[c,m+h,1-E],this.FACES.push(new ui(t,0,l,d,f,p,T,R,a,this.RENDER_CONTROLLER));for(l=0;l<this.CUBE_DETAIL;l+=1)for(u=0;u<this.CUBE_DETAIL;u+=1)E=c+l*h,m=c+u*h,d=this.CUBE_DETAIL-u-1,f=[-c,m,E],p=[-c,m,E+h],T=[-c,m+h,E+h],R=[-c,m+h,E],this.FACES.push(new ui(t,1,l,d,f,p,T,R,a,this.RENDER_CONTROLLER));for(l=0;l<this.CUBE_DETAIL;l+=1)for(u=0;u<this.CUBE_DETAIL;u+=1)E=c+l*h+1,m=c+u*h+1,d=this.CUBE_DETAIL-u-1,f=[1-E,-c,1-m],p=[1-(E+h),-c,1-m],T=[1-(E+h),-c,1-(m+h)],R=[1-E,-c,1-(m+h)],this.FACES.push(new ui(t,2,l,d,f,p,T,R,a,this.RENDER_CONTROLLER));for(l=0;l<this.CUBE_DETAIL;l+=1)for(u=0;u<this.CUBE_DETAIL;u+=1)E=c+l*h+1,m=c+u*h,d=this.CUBE_DETAIL-u-1,f=[1-E,c,m],p=[1-(E+h),c,m],T=[1-(E+h),c,m+h],R=[1-E,c,m+h],this.FACES.push(new ui(t,3,l,d,f,p,T,R,a,this.RENDER_CONTROLLER));for(l=0;l<this.CUBE_DETAIL;l+=1)for(u=0;u<this.CUBE_DETAIL;u+=1)E=c+l*h+1,m=c+u*h,d=this.CUBE_DETAIL-u-1,f=[1-E,m,-c],p=[1-(E+h),m,-c],T=[1-(E+h),m+h,-c],R=[1-E,m+h,-c],this.FACES.push(new ui(t,4,l,d,f,p,T,R,a,this.RENDER_CONTROLLER));for(l=0;l<this.CUBE_DETAIL;l+=1)for(u=0;u<this.CUBE_DETAIL;u+=1)E=c+l*h,m=c+u*h,d=this.CUBE_DETAIL-u-1,f=[E,m,c],p=[E+h,m,c],T=[E+h,m+h,c],R=[E,m+h,c],this.FACES.push(new ui(t,5,l,d,f,p,T,R,a,this.RENDER_CONTROLLER));this.faceDirectionNormalised=r.create(),this.hasChangedThisFrame=!1}tick(t){const{FACES:e,FACE_ANGLE_ACTIVE:i,faceDirectionNormalised:n}=this;let s=!1;for(let o=0;o<e.length;o+=1){const a=e[o];r.normalize(n,a.getCenterPoint());r.angle(t,n)<i?a.setActive():a.setInactive(),a.tick(),!0===a.getHasChangedThisFrame()&&(s=!0)}this.hasChangedThisFrame=s}setPathTiles(t,e){const{FACES:i,faceDirectionNormalised:n}=this,s=[];for(let t=0;t<i.length;t+=1){const o=i[t];r.normalize(n,o.getCenterPoint());const a=r.angle(e,n);s.push({id:t,angle:a})}s.sort(this.angleSort);for(let e=0;e<s.length;e+=1)i[s[e].id].setImagePath(t)}angleSort(t,e){return t.angle<e.angle?1:t.angle>e.angle?-1:0}getFaces(){return this.FACES}getFaceTotal(){return this.FACE_TOTAL}getHasChangedThisFrame(){return this.hasChangedThisFrame}}class Ei{constructor(t){this.GL=t,this.TEXTURE=t.createTexture(),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.TEXTURE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),this.FRAMEBUFFER=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this.FRAMEBUFFER),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.TEXTURE,0);const e=t.checkFramebufferStatus(t.FRAMEBUFFER);e!==t.FRAMEBUFFER_COMPLETE&&console.error("Error. FBOTwo. Status "+e),t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null)}setSize(t,e){const{GL:i}=this;i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,this.TEXTURE),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,t,e,0,i.RGBA,i.UNSIGNED_BYTE,null),i.bindTexture(i.TEXTURE_2D,null)}getTexture(){return this.TEXTURE}getFramebuffer(){return this.FRAMEBUFFER}}class mi{constructor(t,e,i){this.GL=t,this.CUBE_CONTROLLER=e,this.SPRITE_CONTROLLER=i}render(t,e,i){const{GL:n,CUBE_CONTROLLER:r,SPRITE_CONTROLLER:s}=this;n.clear(n.COLOR_BUFFER_BIT),n.viewport(0,0,e,i),n.enable(n.CULL_FACE),n.enable(n.BLEND),n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);const o=r.getFaceTotal(),a=r.getFaces();for(let e=0;e<o;e+=1){a[e].renderColour(t)}const h=s.getSpriteTotal(),c=s.getSprites();for(let e=0;e<h;e+=1){c[e].render(t)}n.enable(n.CULL_FACE),n.disable(n.BLEND)}}class fi{constructor(t,e,i){this.GL=t,this.CUBE_CONTROLLER=e,this.SPRITE_CONTROLLER=i}render(t,e,i){const{GL:n,CUBE_CONTROLLER:r,SPRITE_CONTROLLER:s}=this;n.clear(n.COLOR_BUFFER_BIT),n.viewport(0,0,e,i),n.enable(n.CULL_FACE);const o=r.getFaceTotal(),a=r.getFaces();for(let e=0;e<o;e+=1){a[e].renderBlurMask(t)}n.enable(n.CULL_FACE)}}function pi(){return new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1])}function Ti(){return new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1])}var Ri=i(69),Ai=i.n(Ri),gi=i(70),vi=i.n(gi),_i=i(34),Oi=i.n(_i);class Ii{constructor(t,e){this.GL=t;const{GL:i}=this;this.PROGRAM=ti(i,Oi.a,!0===e?Ai.a:vi.a),i.useProgram(this.PROGRAM),this.BUFFER_POSITIONS=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.BUFFER_POSITIONS),t.bufferData(t.ARRAY_BUFFER,pi(),t.STATIC_DRAW),this.A_POSITION=t.getAttribLocation(this.PROGRAM,"aPosition"),t.enableVertexAttribArray(this.A_POSITION),t.vertexAttribPointer(this.A_POSITION,2,t.FLOAT,!1,0,0),this.BUFFER_TEXTURE_COORDINATES=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.BUFFER_TEXTURE_COORDINATES),t.bufferData(t.ARRAY_BUFFER,Ti(),t.STATIC_DRAW),this.A_TEXTURE_COORDINATES=t.getAttribLocation(this.PROGRAM,"aTexcoord"),t.enableVertexAttribArray(this.A_TEXTURE_COORDINATES),t.vertexAttribPointer(this.A_TEXTURE_COORDINATES,2,t.FLOAT,!1,0,0),this.U_RESOLUTION=t.getUniformLocation(this.PROGRAM,"uResolution"),t.uniform2f(this.U_RESOLUTION,1,1),this.U_SAMPLER=t.getUniformLocation(this.PROGRAM,"uSampler"),t.uniform1i(this.U_SAMPLER,0),i.useProgram(null)}render(t,e,i){const{GL:n}=this;n.useProgram(this.PROGRAM),n.clear(n.COLOR_BUFFER_BIT),n.viewport(0,0,t,e),n.bindBuffer(n.ARRAY_BUFFER,this.BUFFER_POSITIONS),n.vertexAttribPointer(this.A_POSITION,2,n.FLOAT,!1,0,0),n.bindBuffer(n.ARRAY_BUFFER,this.BUFFER_TEXTURE_COORDINATES),n.vertexAttribPointer(this.A_TEXTURE_COORDINATES,2,n.FLOAT,!1,0,0),n.uniform2f(this.U_RESOLUTION,t,e),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,i),n.uniform1i(this.U_SAMPLER_COLOUR,0),n.drawArrays(n.TRIANGLES,0,6),n.bindBuffer(n.ARRAY_BUFFER,null),n.useProgram(null)}}var Ci=i(71),Li=i.n(Ci),Ni=i(72),yi=i.n(Ni);class Si{constructor(t){this.GL=t;const{GL:e}=this;this.PROGRAM=ti(e,Li.a,yi.a),e.useProgram(this.PROGRAM),this.BUFFER_POSITIONS=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.BUFFER_POSITIONS),t.bufferData(t.ARRAY_BUFFER,pi(),t.STATIC_DRAW),this.A_POSITION=t.getAttribLocation(this.PROGRAM,"aPosition"),t.enableVertexAttribArray(this.A_POSITION),t.vertexAttribPointer(this.A_POSITION,2,t.FLOAT,!1,0,0),this.BUFFER_TEXTURE_COORDINATES=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.BUFFER_TEXTURE_COORDINATES),t.bufferData(t.ARRAY_BUFFER,Ti(),t.STATIC_DRAW),this.A_TEXTURE_COORDINATES=t.getAttribLocation(this.PROGRAM,"aTexcoord"),t.enableVertexAttribArray(this.A_TEXTURE_COORDINATES),t.vertexAttribPointer(this.A_TEXTURE_COORDINATES,2,t.FLOAT,!1,0,0),this.U_SAMPLER_COLOUR=t.getUniformLocation(this.PROGRAM,"uSamplerColour"),t.uniform1i(this.U_SAMPLER_COLOUR,0),this.U_SAMPLER_MASK=t.getUniformLocation(this.PROGRAM,"uSamplerMask"),t.uniform1i(this.U_SAMPLER_MASK,1),this.U_SAMPLER_BLUR=t.getUniformLocation(this.PROGRAM,"uSamplerBlur"),t.uniform1i(this.U_SAMPLER_BLUR,2),e.useProgram(null)}render(t,e,i,n,r){const{GL:s}=this;s.useProgram(this.PROGRAM),s.clear(s.COLOR_BUFFER_BIT),s.viewport(0,0,t,e),s.bindBuffer(s.ARRAY_BUFFER,this.BUFFER_POSITIONS),s.vertexAttribPointer(this.A_POSITION,2,s.FLOAT,!1,0,0),s.bindBuffer(s.ARRAY_BUFFER,this.BUFFER_TEXTURE_COORDINATES),s.vertexAttribPointer(this.A_TEXTURE_COORDINATES,2,s.FLOAT,!1,0,0),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,i),s.uniform1i(this.U_SAMPLER_COLOUR,0),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,n),s.uniform1i(this.U_SAMPLER_MASK,1),s.activeTexture(s.TEXTURE2),s.bindTexture(s.TEXTURE_2D,r),s.uniform1i(this.U_SAMPLER_BLUR,2),s.drawArrays(s.TRIANGLES,0,6),s.bindBuffer(s.ARRAY_BUFFER,null),s.useProgram(null)}}class bi{constructor(t){this.CONTROLLER=t}init(t,e,i,n){this.GL=t,this.GL.clearColor(n[0],n[1],n[2],1),this.isExtensionAnisotropic=!1,this.extensionAnisotropicMax=-1,this.EXTENSION_ANISOTROPIC=this.GL.getExtension("EXT_texture_filter_anisotropic")||this.GL.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.GL.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.EXTENSION_ANISOTROPIC&&(this.isExtensionAnisotropic=!0,this.extensionAnisotropicMax=this.GL.getParameter(this.EXTENSION_ANISOTROPIC.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.FBO_COLOUR=new Ei(t),this.FBO_BLUR_MASK=new Ei(t),this.FBO_BLURRED_1=new Ei(t),this.FBO_BLURRED_2=new Ei(t),this.RENDERER_COLOUR=new mi(t,e,i),this.RENDERER_BLUR_MASK=new fi(t,e,i),this.RENDERER_BLURRED_1=new Ii(t,!0),this.RENDERER_BLURRED_2=new Ii(t,!1),this.RENDERER_SCREEN=new Si(t)}render(t){const{GL:e,FBO_COLOUR:i,FBO_BLUR_MASK:n,FBO_BLURRED_1:r,FBO_BLURRED_2:s,RENDERER_COLOUR:o,RENDERER_BLUR_MASK:a,RENDERER_BLURRED_1:h,RENDERER_BLURRED_2:c,RENDERER_SCREEN:l}=this,u=this.width,d=this.height,E=.5*u,m=.5*d;e.bindFramebuffer(e.FRAMEBUFFER,i.getFramebuffer()),o.render(t,u,d),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,n.getFramebuffer()),a.render(t,u,d),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,r.getFramebuffer()),h.render(E,m,i.getTexture()),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,s.getFramebuffer()),c.render(E,m,r.getTexture()),e.bindFramebuffer(e.FRAMEBUFFER,null),l.render(u,d,i.getTexture(),n.getTexture(),s.getTexture())}setSize(t,e){const i=.5*t,n=.5*e;this.FBO_COLOUR.setSize(t,e),this.FBO_BLUR_MASK.setSize(t,e),this.FBO_BLURRED_1.setSize(i,n),this.FBO_BLURRED_2.setSize(i,n),this.width=t,this.height=e}getIsExtensionAnisotropic(){return this.isExtensionAnisotropic}getExtensionAnisotropic(){return this.EXTENSION_ANISOTROPIC}getExtensionAnisotropicMax(){return this.extensionAnisotropicMax}}function Mi(t,e){const i=Math.sin(t),n=Math.cos(t),s=Math.sin(e),o=Math.cos(e);return r.fromValues(s*i,o,s*n)}class Di{constructor(t,e,i,n,r,s,o,a){this.HOTSPOT_CONTROLLER=t,this.CONTAINER=e,this.ID=r,this.THETA=s,this.PHI=o,this.DIRECTION=a,this.ANGLE_FADE_START=.15,this.ANGLE_FADE_DELTA=.1,this.ANGLE_FADE_END=this.ANGLE_FADE_START+this.ANGLE_FADE_DELTA,this.HOTSPOT=document.createElement("div"),this.HOTSPOT.id="hotspot_"+r,this.HOTSPOT.className="pano-hotspot",this.HOTSPOT.style.position="absolute",this.HOTSPOT.style.width="0px",this.HOTSPOT.style.height="0px",this.HOTSPOT.style.userDrag="none",this.HOTSPOT.draggable=!1,this.CONTAINER.appendChild(this.HOTSPOT);const h=document.createElement("IMG");h.className="pano-hotspot-image",h.src=n,h.style.width=i[0]+"px",h.style.height=i[1]+"px",h.style.marginLeft=.5*-i[0]+"px",h.style.marginTop=.5*-i[1]+"px",this.HOTSPOT.appendChild(h),this.HOTSPOT.onclick=this.onClick.bind(this),this.HOTSPOT.onmouseenter=this.onOver.bind(this),this.HOTSPOT.onmouseleave=this.onOut.bind(this),this.enableInteraction()}tick(t,e,i,n){const{ANGLE_FADE_START:o,ANGLE_FADE_DELTA:a,ANGLE_FADE_END:h,HOTSPOT:c,DIRECTION:l}=this,u=.5*t,d=.5*e;let E=r.angle(i,l);!0===Number.isNaN(E)&&(E=0),E/=Math.PI;let m=0,f="none";E<o?(m=1,f="initial"):E<h&&(m=1-(E-o)/a,f="initial");const p=s.fromValues(.5*-l[0],.5*-l[1],.5*-l[2],1);s.transformMat4(p,p,n);let T=p[3];T<.01&&(T=.01),p[0]/=T,p[1]/=T,p[2]/=T;const R=u+u*p[0],A=e-(d+d*p[1]);c.style.opacity=m,c.style.display=f,c.style.transform=`translate3d(${R}px, ${A}px, 0px)`}highlight(){this.HOTSPOT.classList.add("highlighted")}lowlight(){this.HOTSPOT.classList.remove("highlighted")}onClick(t){t.preventDefault(),this.HOTSPOT_CONTROLLER.onHotspotClick(this.ID,this.THETA,this.PHI)}enableInteraction(){this.HOTSPOT.style.pointerEvents="auto"}disableInteraction(){this.HOTSPOT.style.pointerEvents="none"}onOver(t){t.preventDefault(),this.HOTSPOT.classList.add("over")}onOut(t){t.preventDefault(),this.HOTSPOT.classList.remove("over")}destroy(){this.CONTAINER.removeChild(this.HOTSPOT),this.HOTSPOT=null}getID(){return this.ID}getDirection(){return this.DIRECTION}getThetaPhi(){return[this.THETA,this.PHI]}}class Ui{constructor(t){this.CONTROLLER=t}init(t,e,i){this.HOLDER=t,this.DIMENSIONS=e,this.URL_ASSET_HOTSPOT=i,this.HOTSPOTS=[]}tick(t,e,i,n){const{HOTSPOTS:r}=this;for(let s=0;s<r.length;s+=1)r[s].tick(t,e,i,n)}add(t,e,i){const n=Mi(e,i);r.normalize(n,n);const s=new Di(this,this.HOLDER,this.DIMENSIONS,this.URL_ASSET_HOTSPOT,t,e,i,n);this.HOTSPOTS.push(s)}remove(t){const{HOTSPOTS:e}=this;let i=!1;const n=[];for(let r=0;r<e.length;r+=1){const s=e[r];s.getID()===t?(s.destroy(),i=!0):n.push(s)}return this.HOTSPOTS=n,i}highlight(t){console.log("HotspotController. highlight "+t);const{HOTSPOTS:e}=this;for(let i=0;i<e.length;i+=1){const n=e[i];n.getID()===t?n.highlight():n.lowlight()}}lowlightAll(){const{HOTSPOTS:t}=this;for(let e=0;e<t.length;e+=1)t[e].lowlight()}clear(){const{HOTSPOTS:t}=this;for(let e=0;e<t.length;e+=1)t[e].destroy();this.HOTSPOTS=[]}onHotspotClick(t,e,i){this.CONTROLLER.onHotspotClick(t,e,i)}enableHotspots(){const{HOTSPOTS:t}=this;for(let e=0;e<t.length;e+=1)t[e].enableInteraction()}disableHotspots(){const{HOTSPOTS:t}=this;for(let e=0;e<t.length;e+=1)t[e].disableInteraction()}getHotspotById(t){const{HOTSPOTS:e}=this;for(let i=0;i<e.length;i+=1){const n=e[i];if(n.getID()===t)return n}}}class xi{constructor(t,e,i,n,r,s){this.ELEMENT_HOLDER_CONTROLLER=t,this.CONTAINER=e,this.ID=i,this.THETA=n,this.PHI=r,this.DIRECTION=s,this.ANGLE_HIDE=.5,this.ELEMENT=document.createElement("div"),this.ELEMENT.id="element_holder_"+i,this.ELEMENT.style.position="absolute",this.ELEMENT.style.width="0px",this.ELEMENT.style.height="0px",this.CONTAINER.appendChild(this.ELEMENT)}tick(t,e,i,n){const{ANGLE_HIDE:o,ELEMENT:a,DIRECTION:h}=this,c=.5*t,l=.5*e;let u=r.angle(i,h);!0===Number.isNaN(u)&&(u=0),u/=Math.PI;let d=0,E="none";u<o&&(d=1,E="initial");const m=s.fromValues(.5*-h[0],.5*-h[1],.5*-h[2],1);s.transformMat4(m,m,n);let f=m[3];f<.01&&(f=.01),m[0]/=f,m[1]/=f,m[2]/=f;const p=c+c*m[0],T=e-(l+l*m[1]);a.style.opacity=d,a.style.display=E,a.style.transform=`translate3d(${p}px, ${T}px, 0px)`}enableInteraction(){this.ELEMENT.style.pointerEvents="auto"}disableInteraction(){this.ELEMENT.style.pointerEvents="none"}destroy(){this.CONTAINER.removeChild(this.ELEMENT),this.ELEMENT=null}getID(){return this.ID}getElement(){return this.ELEMENT}}class Fi{constructor(t){this.CONTROLLER=t}init(t){this.HOLDER=t,this.ELEMENT_HOLDERS=[]}tick(t,e,i,n){const{ELEMENT_HOLDERS:r}=this;for(let s=0;s<r.length;s+=1)r[s].tick(t,e,i,n)}add(t,e,i){const n=Mi(e,i);r.normalize(n,n);const s=new xi(this,this.HOLDER,t,e,i,n);return this.ELEMENT_HOLDERS.push(s),s.getElement()}remove(t){const{ELEMENT_HOLDERS:e}=this;let i=!1;const n=[];for(let r=0;r<e.length;r+=1){const s=e[r];s.getID()===t?(s.destroy(),i=!0):n.push(s)}return this.ELEMENT_HOLDERS=n,i}clear(){const{ELEMENT_HOLDERS:t}=this;for(let e=0;e<t.length;e+=1)t[e].destroy();this.ELEMENT_HOLDERS=[]}enableElementHolders(){const{ELEMENT_HOLDERS:t}=this;for(let e=0;e<t.length;e+=1)t[e].enableInteraction()}disableElementHolders(){const{ELEMENT_HOLDERS:t}=this;for(let e=0;e<t.length;e+=1)t[e].disableInteraction()}}var Pi=i(73),wi=i.n(Pi),Bi=i(74),Hi=i.n(Bi);class Gi{constructor(t,e,i,n,r,s,o,a){this.GL=t,this.ID=n,this.VERTICES=function(t,e,i){const n=.5*t[0],r=.5*t[1],s=[-n,-r,0],o=[n,-r,0],a=[n,r,0],h=[-n,r,0],c=new Float32Array([s[0],s[1],s[2],o[0],o[1],o[2],a[0],a[1],a[2],a[0],a[1],a[2],h[0],h[1],h[2],s[0],s[1],s[2]]);let l;for(let t=0;t<c.length/3;t+=1)l=3*t,c[l]+=e[0],c[l+1]+=e[1],c[l+2]+=e[2];return c}(r,s),this.VERTEX_TOTAL=this.VERTICES.length/3,this.TEXTURE_COORDINATES=ei();const{GL:h}=this;this.PROGRAM=ti(h,wi.a,Hi.a),h.useProgram(this.PROGRAM),this.U_MATRIX_MVP=h.getUniformLocation(this.PROGRAM,"uMVP"),this.BUFFER_POSITIONS=h.createBuffer(),this.A_POSITION=h.getAttribLocation(this.PROGRAM,"aPosition"),h.enableVertexAttribArray(this.A_POSITION),this.BUFFER_TEXTURE_COORDINATES=h.createBuffer(),this.A_TEXTURE_COORDINATES=h.getAttribLocation(this.PROGRAM,"aTexcoord"),h.enableVertexAttribArray(this.A_TEXTURE_COORDINATES),h.bindBuffer(h.ARRAY_BUFFER,this.BUFFER_TEXTURE_COORDINATES),h.bufferData(h.ARRAY_BUFFER,this.TEXTURE_COORDINATES,h.STATIC_DRAW),h.vertexAttribPointer(this.A_TEXTURE_COORDINATES,2,h.FLOAT,!1,0,0),this.U_SAMPLER=h.getUniformLocation(this.PROGRAM,"uSampler"),this.TEXTURE=new oi(h,e,i,this.onTextureLoaded.bind(this),!1),this.TEXTURE.loadImage(a),h.useProgram(null)}render(t){const{GL:e}=this;e.useProgram(this.PROGRAM),e.uniformMatrix4fv(this.U_MATRIX_MVP,!1,t),e.bindBuffer(e.ARRAY_BUFFER,this.BUFFER_POSITIONS),e.bufferData(e.ARRAY_BUFFER,this.VERTICES,e.STATIC_DRAW),e.vertexAttribPointer(this.A_POSITION,3,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this.BUFFER_TEXTURE_COORDINATES),e.vertexAttribPointer(this.A_TEXTURE_COORDINATES,2,e.FLOAT,!1,0,0),e.activeTexture(e.TEXTURE0),e.uniform1i(this.U_SAMPLER,0),e.bindTexture(e.TEXTURE_2D,this.TEXTURE.getTexture()),e.drawArrays(e.TRIANGLES,0,this.VERTEX_TOTAL),e.bindBuffer(e.ARRAY_BUFFER,null),e.useProgram(null)}onTextureLoaded(t,e){console.log("Sprite. onTextureLoaded. "+e)}destroy(){}}class ki{constructor(t){this.CONTROLLER=t}init(t,e){this.GL=t,this.RENDER_CONTROLLER=e,this.COLOUR_BACKGROUND=[1,1,1],this.SPRITES=[]}tick(){}add(t,e,i,n,r){this.SPRITES.push(new Gi(this.GL,this.RENDER_CONTROLLER,this.COLOUR_BACKGROUND,t,e,i,n,r))}clear(){const{SPRITES:t}=this;for(let e=0;e<t.length;e+=1)t[e].destroy();this.SPRITES=[]}getSpriteTotal(){return this.SPRITES.length}getSprites(){return this.SPRITES}}class Yi{constructor(t){this.fps=0,this.timeStartPreviousFrame=0,this.timeStartPreviousSample=0,this.frameCount=0,this.FRAME_DURATION_EXPECTED_MS=1/60,this.HOLDER=document.createElement("div"),this.HOLDER.id="debug_performance",this.HOLDER.style.position="absolute",this.HOLDER.style.bottom="10px",this.HOLDER.style.left="10px",this.HOLDER.style.fontFamily="Arial, Helvetica, sans-serif",this.HOLDER.style.fontSize="12px",t.appendChild(this.HOLDER)}tick(t,e,i){this.frameCount+=1,t>this.timeStartPreviousSample+1e3&&(this.fps=this.frameCount,this.timeStartPreviousSample=t,this.frameCount=0);const n=(t-this.timeStartPreviousFrame).toFixed(1),r=(e-t).toFixed(1),s=(i-e).toFixed(1);this.HOLDER.innerHTML=`${n}ms ${this.fps}Hz.\n\t\t\tTick ${r}ms. Render ${s}ms`,this.timeStartPreviousFrame=t}}class Xi{constructor(t){this.PERFORMANCE=new Yi(t),this.QUARTER=document.createElement("div"),this.QUARTER.id="debug_quarter",this.QUARTER.style.position="absolute",this.QUARTER.style.left=0,this.QUARTER.style.top="50%",this.QUARTER.style.width="50%",this.QUARTER.style.height="50%",this.QUARTER.style.background="#ffffff",this.QUARTER.style.opacity=.2,this.QUARTER.style.pointerEvents="none",t.appendChild(this.QUARTER)}tick(t,e,i){this.PERFORMANCE.tick(t,e,i)}}class Vi{constructor(t){this.CONTAINER=t.container,this.CALLBACK_HOTSPOT_CLICK=t.callbackHotspotClick,this.DEVICE_PIXEL_RATIO=window.devicePixelRatio||1,this.IS_DEBUG=!!t.isDebug&&t.isDebug,!0===this.IS_DEBUG&&(console.log("PikViewerPano 0.1.2. Created with:"),console.log(t));const e=t.cubeDetail?t.cubeDetail:4,i=t.cubeCullAngle?t.cubeCullAngle:.4*Math.PI,n=t.colourClear?t.colourClear:[1,1,1],r=t.colourBackground?t.colourBackground:[1,1,1],s=t.colourBackgroundInitialDetail?t.colourBackgroundInitialDetail:[1,1,1];this.CANVAS=document.createElement("canvas"),this.CONTAINER.appendChild(this.CANVAS),this.GL=this.CANVAS.getContext("webgl",{alpha:!1,depth:!1,antialias:!0}),this.GL||(this.log("webgl context not found, trying experimental-webgl"),this.GL=this.CANVAS.getContext("experimental-webgl",{alpha:!1,antialias:!0})),this.CAMERA_CONTROLLER=new Ke,this.CUBE_CONTROLLER=new di(this),this.RENDER_CONTROLLER=new bi(this),this.HOTSPOT_CONTROLLER=new Ui(this),this.ELEMENT_HOLDER_CONTROLLER=new Fi(this),this.SPRITE_CONTROLLER=new ki(this),this.RENDER_CONTROLLER.init(this.GL,this.CUBE_CONTROLLER,this.SPRITE_CONTROLLER,n),this.CAMERA_CONTROLLER.init({}),this.CUBE_CONTROLLER.init(this.GL,this.RENDER_CONTROLLER,e,i,r,s),this.HOTSPOT_CONTROLLER.init(t.containerHotspot,t.dimensionsHotspot,t.pathAssetHotspot),this.ELEMENT_HOLDER_CONTROLLER.init(t.containerElementHolder),this.SPRITE_CONTROLLER.init(this.GL,this.RENDER_CONTROLLER),this.INTERACTION_SURFACE=new Je(this,this.CANVAS),!0===this.IS_DEBUG&&(this.log("isDebug. Debug display is enabled."),this.DEBUG_CONTROLLER=new Xi(this.CONTAINER),this.CANVAS.onclick=this.onCanvasDebugClick.bind(this)),this.log(`EXT_texture_filter_anisotropic. ${this.RENDER_CONTROLLER.getIsExtensionAnisotropic()}. Max `+this.RENDER_CONTROLLER.getExtensionAnisotropicMax()),this.clientWidth=-1,this.clientHeight=-1,this.width=-1,this.height=-1,void 0!==t.pathTilesInitial&&(this.tick(),this.setPathTiles(t.pathTilesInitial)),this.overrideRenderThisFrame=!1}tick(){const{CONTAINER:t,CAMERA_CONTROLLER:e,CUBE_CONTROLLER:i}=this;let n=!1;const r=performance.now(),s=t.clientWidth,o=t.clientHeight;s===this.clientWidth&&o===this.clientHeight||(this.setSize(s,o),n=!0),e.tick(),!0===e.getHasChangedThisFrame()&&(n=!0);const a=e.getMatrixMVP(),h=e.getDirectionNormalised(),c=e.getDirectionNormalisedInverted();i.tick(c),!0===i.getHasChangedThisFrame()&&(n=!0),!0===this.overrideRenderThisFrame&&(n=!0,this.overrideRenderThisFrame=!1),!0===n&&(this.HOTSPOT_CONTROLLER.tick(this.clientWidth,this.clientHeight,h,a),this.ELEMENT_HOLDER_CONTROLLER.tick(this.clientWidth,this.clientHeight,h,a),this.SPRITE_CONTROLLER.tick());const l=performance.now();!0===n&&this.RENDER_CONTROLLER.render(a);const u=performance.now();!0===this.IS_DEBUG&&this.DEBUG_CONTROLLER.tick(r,l,u)}setPathTiles(t){t!==this.pathTiles?(this.pathTiles=t,this.log("setPathTiles:\n"+this.pathTiles),this.CUBE_CONTROLLER.setPathTiles(t,this.CAMERA_CONTROLLER.getDirectionNormalised())):this.log("setPathTiles. Ignoring as identical to current:\n"+this.pathTiles)}addHotspot(t,e,i){this.log(`addHotspot '${t}' at ${e} ${i}`),this.HOTSPOT_CONTROLLER.add(t,e,i),this.overrideRenderThisFrame=!0}removeHotspot(t){this.log(`removeHotspot '${t}'`);!1===this.HOTSPOT_CONTROLLER.remove(t)&&this.log(` - Hotspot ${t} not found, abandoning`),this.overrideRenderThisFrame=!0}clearHotspots(){this.log("clearHotspots"),this.HOTSPOT_CONTROLLER.clear(),this.overrideRenderThisFrame=!0}focusHotspot(t){this.log(`focusHotspot '${t}'`);const e=this.HOTSPOT_CONTROLLER.getHotspotById(t);if(void 0===e)return void this.log(`focusHotspot. Hotspot '${t}' not found, abandoning`);const i=e.getThetaPhi();this.CAMERA_CONTROLLER.setRotationTarget(i[0],i[1]),this.overrideRenderThisFrame=!0}onHotspotClick(t,e,i){this.log(`onHotspotClick '${t}' ${e},${i}`),this.CALLBACK_HOTSPOT_CLICK(t,e,i)}highlightHotspot(t){this.log(`highlightHotspot '${t}'`),this.HOTSPOT_CONTROLLER.highlight(t)}lowlightHotspots(){this.log("lowlightHotspots"),this.HOTSPOT_CONTROLLER.lowlightAll()}addElementHolder(t,e,i){return this.log(`addElementHolder ${t} ${e} ${i}`),this.overrideRenderThisFrame=!0,this.ELEMENT_HOLDER_CONTROLLER.add(t,e,i)}removeElementHolder(t){this.log("removeElementHolder "+t);!1===this.ELEMENT_HOLDER_CONTROLLER.remove(t)&&this.log(` - ElementHolder ${t} not found, abandoning`),this.overrideRenderThisFrame=!0}clearElementHolders(){this.log("clearElementHolders"),this.ELEMENT_HOLDER_CONTROLLER.clear(),this.overrideRenderThisFrame=!0}addSprite(t,e,i,n,r){this.log(`addSprite [${e}] [${i}] [${n}] ${r}`),this.SPRITE_CONTROLLER.add(t,e,i,n,r),this.overrideRenderThisFrame=!0}clearSprites(){this.log("clearSprites"),this.SPRITE_CONTROLLER.clear(),this.overrideRenderThisFrame=!0}setZoom(t){this.log("setZoom "+t),this.CAMERA_CONTROLLER.setZoom(t)}setZoomTarget(t){this.log("setZoomTarget "+t),this.CAMERA_CONTROLLER.setZoomTarget(t)}zoomIn(){this.log("zoomIn"),this.CAMERA_CONTROLLER.zoomIn()}zoomOut(){this.log("zoomOut"),this.CAMERA_CONTROLLER.zoomOut()}onInteractionZoom(t){t<0?this.CAMERA_CONTROLLER.zoomIn():this.CAMERA_CONTROLLER.zoomOut()}rotateHorizontal(t){this.CAMERA_CONTROLLER.rotateHorizontal(t)}rotateVertical(t){this.CAMERA_CONTROLLER.rotateVertical(t)}setRotation(t,e){this.CAMERA_CONTROLLER.setRotation(t,e)}setRotationTarget(t,e){this.CAMERA_CONTROLLER.setRotationTarget(t,e)}getRotation(){const{CAMERA_CONTROLLER:t}=this;return{theta:t.getRotationTheta(),phi:t.getRotationPhi()}}setRotationLimitsTheta(t,e){this.log(`setRotationLimitsTheta ${t} ${e}`),this.CAMERA_CONTROLLER.setRotationLimitsTheta(t,e)}clearRotationLimitsTheta(){this.log("clearRotationLimitsTheta"),this.CAMERA_CONTROLLER.clearRotationLimitsTheta()}setRotationLimitsPhi(t,e){this.log(`setRotationLimitsPhi ${t} ${e}`),this.CAMERA_CONTROLLER.setRotationLimitsPhi(t,e)}clearRotationLimitsPhi(){this.log("clearRotationLimitsPhi"),this.CAMERA_CONTROLLER.clearRotationLimitsPhi()}getCanvas(){return this.CANVAS}enableInteraction(){this.log("enableInteraction"),this.INTERACTION_SURFACE.enable()}disableInteraction(){this.log("disableInteraction"),this.INTERACTION_SURFACE.disable()}onInteractionStart(){this.HOTSPOT_CONTROLLER.disableHotspots(),this.ELEMENT_HOLDER_CONTROLLER.disableElementHolders()}onInteractionEnd(){this.HOTSPOT_CONTROLLER.enableHotspots(),this.ELEMENT_HOLDER_CONTROLLER.enableElementHolders()}devSetExternalView(t){this.log("devSetExternalView "+t),this.CAMERA_CONTROLLER.setExternalView(t)}onCanvasDebugClick(t){t.preventDefault(),this.logCameraInfo()}logCameraInfo(){const{CAMERA_CONTROLLER:t}=this,e=t.getRotationTheta(),i=t.getRotationPhi();console.log("PikViewerPano. logCameraInfo:"),console.log(` - Client             ${this.clientWidth} ${this.clientHeight} px`),console.log(" - Device Pixel Ratio "+this.DEVICE_PIXEL_RATIO),console.log(` - Canvas             ${this.width} ${this.height} px`),console.log(` - Camera. Theta, Phi ${e}, ${i}`)}setSize(t,e){const{CANVAS:i,CAMERA_CONTROLLER:n,DEVICE_PIXEL_RATIO:r}=this;this.clientWidth=t,this.clientHeight=e,this.width=t*r,this.height=e*r,i.style.width=t+"px",i.style.height=e+"px",i.width=this.width,i.height=this.height,n.setSize(t,e),this.RENDER_CONTROLLER.setSize(this.width,this.height)}log(t){!0===this.IS_DEBUG&&console.log("PikViewerPano. "+t)}getScreenshot(t,e){console.log("PikViewerPano. getScreenshot");const i=this.CAMERA_CONTROLLER.getMatrixMVP();this.RENDER_CONTROLLER.render(i);const n=this.CANVAS.toDataURL("image/"+t,e),r=document.createElement("img");return r.src=n,this.CONTAINER.appendChild(r),n}}class $i{constructor(t){this.CONTROLLER=new Vi(t),this.tick()}tick(){requestAnimationFrame(this.tick.bind(this)),this.CONTROLLER.tick()}setPathTiles(t){this.CONTROLLER.setPathTiles(t)}addHotspot(t,e,i){this.CONTROLLER.addHotspot(t,e,i)}removeHotspot(t){this.CONTROLLER.removeHotspot(t)}clearHotspots(){this.CONTROLLER.clearHotspots()}focusHotspot(t){this.CONTROLLER.focusHotspot(t)}highlightHotspot(t){this.CONTROLLER.highlightHotspot(t)}lowlightHotspots(){this.CONTROLLER.lowlightHotspots()}addElementHolder(t,e,i){return this.CONTROLLER.addElementHolder(t,e,i)}removeElementHolder(t){this.CONTROLLER.removeElementHolder(t)}clearElementHolders(){this.CONTROLLER.clearElementHolders()}addSprite(t,e,i,n,r){this.CONTROLLER.addSprite(t,e,i,n,r)}clearSprites(){this.CONTROLLER.clearSprites()}rotateHorizontal(t){this.CONTROLLER.rotateHorizontal(t)}rotateVertical(t){this.CONTROLLER.rotateVertical(t)}setRotation(t,e){this.CONTROLLER.setRotation(t,e)}setRotationTarget(t,e){this.CONTROLLER.setRotationTarget(t,e)}getRotation(){return this.CONTROLLER.getRotation()}setZoom(t){this.CONTROLLER.setZoom(t)}setZoomTarget(t){this.CONTROLLER.setZoomTarget(t)}zoomIn(){this.CONTROLLER.zoomIn()}zoomOut(){this.CONTROLLER.zoomOut()}setRotationLimitsTheta(t,e){this.CONTROLLER.setRotationLimitsTheta(t,e)}clearRotationLimitsTheta(){this.CONTROLLER.clearRotationLimitsTheta()}setRotationLimitsPhi(t,e){this.CONTROLLER.setRotationLimitsPhi(t,e)}clearRotationLimitsPhi(){this.CONTROLLER.clearRotationLimitsPhi()}enableInteraction(){this.CONTROLLER.enableInteraction()}disableInteraction(){this.CONTROLLER.disableInteraction()}onInteractionStart(){this.CONTROLLER.onInteractionStart()}onInteractionEnd(){this.CONTROLLER.onInteractionEnd()}getCanvas(){return this.CONTROLLER.getCanvas()}devLogCameraInfo(t){this.CONTROLLER.logCameraInfo(t)}devSetExternalView(t){this.CONTROLLER.devSetExternalView(t)}getScreenshot(t,e){return this.CONTROLLER.getScreenshot(t,e)}}class ji{constructor(){this.IS_AVAILABLE_FULLSCREEN=!0;const t=!!navigator.userAgent.match(/Version\/[\d\.]+.*Safari/),e=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;!0===t&&!0===e&&(this.IS_AVAILABLE_FULLSCREEN=!1)}isAvailableFullscreen(){return this.IS_AVAILABLE_FULLSCREEN}}class zi{constructor(t,e,i,n){this.CONFIGURATOR=t,this.CONTAINER_UI=i,this.ELEMENT_FULLSCREEN=n,this.HIDE_MENU=e.hideMenu||!1,n||(this.HIDE_MENU=!1),this.BUTTON_HOLDER=document.createElement("div"),this.BUTTON_HOLDER.className="fullscreen-button-holder",this.CONTAINER_UI.appendChild(this.BUTTON_HOLDER),this.BUTTON_OPEN=document.createElement("div"),this.BUTTON_OPEN.className="fullscreen-button-open",this.BUTTON_HOLDER.appendChild(this.BUTTON_OPEN),this.BUTTON_CLOSE=document.createElement("div"),this.BUTTON_CLOSE.className="fullscreen-button-close",this.BUTTON_HOLDER.appendChild(this.BUTTON_CLOSE),this.BUTTON_HOLDER.onclick=this.toggleFullScreen.bind(this),document.addEventListener("fullscreenchange",this.onFullScreenChanged.bind(this)),document.addEventListener("mozfullscreenchange",this.onFullScreenChanged.bind(this)),document.addEventListener("webkitfullscreenchange",this.onFullScreenChanged.bind(this)),document.addEventListener("msfullscreenchange",this.onFullScreenChanged.bind(this)),this.showButtonOpen()}showButtonOpen(){this.BUTTON_OPEN.classList.add("active"),this.BUTTON_CLOSE.classList.remove("active")}showButtonClose(){this.BUTTON_OPEN.classList.remove("active"),this.BUTTON_CLOSE.classList.add("active")}onFullScreenChanged(t){t.preventDefault();document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?(this.showButtonClose(),this.CONFIGURATOR.onEnterFullscreen()):(this.showButtonOpen(),this.CONFIGURATOR.onLeaveFullscreen())}toggleFullScreen(){const t=window.document,e=this.ELEMENT_FULLSCREEN,i=t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||t.msFullscreenElement,n=e.requestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullScreen||e.msRequestFullscreen,r=t.exitFullscreen||t.mozCancelFullScreen||t.webkitExitFullscreen||t.msExitFullscreen;i?(!0===this.HIDE_MENU&&this.showMenu(),r.call(t)):(!0===this.HIDE_MENU&&this.hideMenu(),n.call(e))}hideMenu(){this.ELEMENT_FULLSCREEN.classList.add("full-screen")}showMenu(){this.ELEMENT_FULLSCREEN.classList.remove("full-screen")}}class qi{constructor(t,e,i,n){this.CONFIGURATOR=t;const r=e||{};this.reset(),this.name=e.safe_name,this.filterCategoryName=i.name,this.filterCategory=i,n.registerFilter(e.name,this.name),this.set(r,{})}activate(t){if(this.CONFIGURATOR.log(`Filter. activate. '${this.filterCategoryName}' '${this.name}'`),!0===t);else{for(const t in this.filterCategory.filters){if(!this.filterCategory.filters.hasOwnProperty(t))continue;const e=this.filterCategory.filters[t];e!==this&&e.deactivate()}this.active=!0,this.filterCategory.currentActive=this,this.updateFilters(),void 0!==this.el&&(Array.isArray(this.el)?this.el.forEach(t=>{t.classList.add("active")}):this.el.classList.add("active"))}}deactivate(){this.active&&(this.CONFIGURATOR.log(`Filter. '${this.filterCategoryName}' '${this.name}' deactivating`),this.filterCategory.currentActive=!1,this.active=!1,this.updateFilters(),void 0!==this.el&&(Array.isArray(this.el)?this.el.forEach(t=>{t.classList.remove("active")}):this.el.classList.remove("active")))}triggerReactivate(){for(const t in this.filterCategory.filters){if(!this.filterCategory.filters.hasOwnProperty(t))continue;this.filterCategory.filters[t].reactive=!1}this.filterCategory.isReactiveSet=!0,this.filterCategory.currentReactive=this,this.reactive=!0}setListener(){}removeListener(){}addItem(){}getOption(){}setOption(){}updateFilters(t="reactive"){return this.hideInvalidatedFilters({hideMode:"disabled"}),"reactive"===t&&this.filterCategory.reactive.length>0?(this.CONFIGURATOR.log(`Filter. updateFilter. ${this.filterCategoryName} ${this.name} is reactive. Updating ${this.filterCategory.reactive.length} Items`),this.filterCategory.reactive.forEach(t=>{t.filterUpdate()})):"reactive"===t&&0!==this.filterCategory.reactive.length||(this.CONFIGURATOR.log(`Filter. updateFilter. ${this.filterCategoryName} ${this.name} is active. Updating ${this.filterCategory.active.length} Items`),this.filterCategory.active.forEach(t=>{t.filterUpdate()})),this}getFiltersWhichMayLoseValidity(t){const e=[];return this.filterCategory.active.forEach(t=>{t.filters.map(t=>{-1===e.indexOf(t)&&e.push(t)})}),e}hideInvalidatedFilters(t){(t=t||{}).hideMode&&t.hideMode;const e=t.groupsToCheck?t.groupsToCheck:[],i=t.groupsToExclude?t.groupsToExclude:[];let n=t.layersToCheck?t.layersToCheck:[];const r=t.layersToExclude?t.layersToExclude:[];t.filterMode&&t.filterMode;if(e.length);else if(i.length){this.getFiltersWhichMayLoseValidity().forEach(t=>{e.push(t.filterCategoryName)})}n.length||r.length||(n=["Feature","Floors","Walls","Worktops","Handles_Base"])}countValidItems(){return this.allNotifiables.reduce((t,e)=>t+!e.visibility,0)}countValidItemsPerLayer(){const t={};return this.allNotifiables.forEach(e=>{const i=e.layer.attributes.file_path,n=Number(e.filterCheck().active);t[i]?t[i]+=n:t[i]=n}),t}updateFilterMatchCount(){const t=this.layers.reduce((t,e)=>t+!e.hidden,0);return this.itemsMatch=t,t}set(t,e,i){let n;"object"==typeof t?n=t:(n={})[t]=e;const r=this.attributes;for(const t in n)r[t]=n[t];this.get("disabled")&&(this.disabled=!0)}get(t){return this.attributes[t]}reset(){this.type=!1,this.image=new Image,this.itemsMatch=0,this.active=!1,this.disabled=!1,this.currentActive=!1,this.reactive=!1,this.options={},this.allNotifiables=[],this.attributes={}}}class Zi{constructor(t,e){this.CONFIGURATOR=t,this.reset();const i=this;e.forEach(t=>{i.registerFilterCategory(t,t.filters)})}registerFilterCategory(t,e){const i=this;this.byGroup[t.safe_name]={name:t.name,filters:{},items:[],active:[],reactive:[],render_as:t.render_as};const n=this.byGroup[t.safe_name];e.forEach(t=>{t=new qi(this.CONFIGURATOR,t,n,i),i.filters.push(t),n.filters[t.name]=t})}set(t,e,i){return i=i||"active",(e=this.byGroup[t].filters[e]).activate(i),e}get(t){return this.filters[this.byName[t]]||!1}getFiltersByCategory(t){if(!t)return!1;const e=[],i=this.byGroup[t];for(const t in i.filters)e.push(i.filters[t]);return{name:i.name,filters:e,items:[]}||!1}registerFilter(t,e){const i=this.filterByName[t];i?i.push(e):this.filterByName[t]=[e]}updateAll(){this.filters.forEach((function(t){t.itemsMatch<1||t.el}))}on(t,e,i){const n=this.byGroup[t.group];if(void 0!==n){if(t.options.length){const r=i.filter.indexOf(t);i.filter[r].group=n;for(let s=0,o=t.options.length;s<o;s+=1){const o=n.filters[t.options[s].toLowerCase()];o&&(o.setListener(e,i),o.allNotifiables.push(i)),o.itemsMatch+=1,i.filters.push(o),i.filter[r].filters||(i.filter[r].filters=[]),i.filter[r].filters.push(o),n.visible||(n.visible=0),n[t.type].push(i),n.items.push(i),n.visible+=1}}}else console.log(`Missing Filter Group for ${t.group} on ${i.get("name")}`)}off(t,e,i){const n=this.byName[t];void 0===n||(t=this.filters[n]),t.removeListener(e,i)}reset(){this.filters=[],this.byName={},this.byGroup={},this.filterByName={}}}class Wi{constructor(t,e={},i={}){this.CONFIGURATOR=t,this.reset();const n=e;i.layer&&(this.layer=i.layer),this.set(n,i),this.set("hidden",!1),this.disabled=!1,this.hidden=!1;const r=this.CONFIGURATOR.getWebp()?".webp":".jpg";this.set("thumbnail",this.CONFIGURATOR.getDynamicThumbUrl()+this.get("image_path")+r)}set(t,e){let i;"object"==typeof t?i=t:(i={})[t]=e,i.filter&&i.filter.length&&(this.filter=i.filter,delete i.filter);const n=this.attributes;for(const t in i)n[t]=i[t];this.get("disabled")&&(this.disabled=!0)}get(t){return this.attributes[t]}registerFilters(){if(!this.filter||!this.filter.length)return!1;for(let t=this.filter.length,e=0;e<t;e+=1){const t=this.filter[e];this.layer.filters.on(t,t.type,this)}}parseFilters(){if(!this.filters||!this.filters.length)return!1;const t=[];for(let e=this.filters.length,i=0;i<e;i+=1){const e=this.filters[i],n={name:e.filterCategoryName,value:e.attributes.safe_name};e.attributes.thumbnail&&("#"===e.attributes.thumbnail.charAt(0)?n.colour=e.attributes.thumbnail:n.thumbnail=this.CONFIGURATOR.getStaticImageUrl()+e.attributes.thumbnail),t.push(n)}return t}filterUpdate(){if(this.disabled)return!1;const t=this.filterCheck();return this.checkIfAlternativeNeeded(t.reactive,"reactive"),this.toggleVisible(t.status,t.filter),t.status}checkIfAlternativeNeeded(t,e){if(this.active&&!t||this.disabled){this.CONFIGURATOR.log(`Item. Index:${this.attributes.index} Id:${this.attributes.id} checkIfAlternativeNeeded ${t} ${e}`),this.CONFIGURATOR.log(` - Looking for alternative ${this.layer.get("name")} found.`);const i=this.findAlternative(e);i?i.setActive():this.CONFIGURATOR.log(` - No valid alternative ${this.layer.get("name")} found.`)}}findAlternative(t){this.CONFIGURATOR.log(`Item. Index:${this.index} Id:${this.id} findAlternative ${t}`);const e=t||"reactive";let i,n,r,s;if(r=this.checkForValidSibling(e),r)return r;if(this.layer.previousActive){const t=this.layer.previousActive;if(t.filterCheck()[e])return t;if(r=t.checkForValidSibling(e),r)return r}for(i=0,n=this.layer.items.length;i<n;i+=1){const t=this.layer.items[i];if(t.filterCheck()[e]&&(void 0===s&&(s=t),t.attributes.name===this.attributes.name))return t}return void 0!==s&&s}checkForValidSibling(t){if(this.siblings.length)for(let e=0,i=this.siblings.length;e<i;e+=1)if(this.siblings[e].filterCheck()[t])return this.siblings[e];return!1}filterCheck(){let t=!0,e=!0,i=!1;return this.filter.forEach(n=>{"reactive"===n.type&&n.group.isReactiveSet?-1===n.options.indexOf(n.group.currentReactive.name)?e=!1:i=!0:n.group.currentActive&&-1===n.options.indexOf(n.group.currentActive.name)?t=!1:i=!0}),{active:t,reactive:e,status:t&&e,filter:i}}registerSibling(t){this.sibling=t,t.siblings.push(this)}layerUpdate(){}setActive(t={}){const e=t.linked||!1,i=t.resetting||!1;return e&&this.layer.events.linked.length&&this.layer.events.linked[this.get("index")].setActive(),this.active&&!i||(this.active=!0,this.layer.newItemActive(this)),this}clearActive(){this.active=!1}toggleActive(t){!0===t&&this.set("active",t)}toggleVisible(t,e){this.visibility!==t&&this.visible&&(this.visibility=t,!0===t?this.show():this.hide()),e?this.filters.map(t=>{t.itemsMatch+=1}):this.filters.map(t=>{t.itemsMatch-=1})}show(){this.hidden=!1,this.sibling&&this.sibling.set("hidden",!1),this.set("hidden",!1)}hide(){this.hidden=!0,this.sibling&&this.sibling.set("hidden",!0),this.set("hidden",!0)}getImage(){return this.get("thumbnail")}reset(){this.attributes={},this.active=!1,this.visible=!0,this.visibility=!0,this.loadedThumbs=!1,this.siblings=[],this.filters=[],this.menuEl=[]}}function Qi(t){const e=t[0],i=t[1],n=t[2],r=Math.max(e,i,n),s=Math.min(e,i,n);let o,a;const h=(r+s)/2;if(r===s)o=0,a=0;else{const t=r-s;switch(a=h>.5?t/(2-r-s):t/(r+s),r){case e:o=(i-n)/t+(i<n?6:0);break;case i:o=(n-e)/t+2;break;case n:o=(e-i)/t+4}o/=6}return[o,a,h]}function Ki(t,e){const i=t[0];let n=-1,r=1/0;for(let t=0;t<e.length;t+=1){const s=e[t][0],o=Math.abs(i-s);o<r&&(r=o,n=t)}return n}function Ji(t){const e=t.split(" ");for(let t=0;t<e.length;t+=1)e[t]/=256;return e}class tn{constructor(t){this.CONFIGURATOR=t,this.LAYER_TYPE="LAYER_DEFAULT",this.attributes={},this.events={range:[],events:[],linked:[]},this.options={}}init(){this.reset()}get length(){return this.items.length}create(t,e){const i=t;this.init(),"NULL"===i.layer_group&&(i.layer_group=null),i.markers&&i.markers.length&&(i.marker=i.markers[0]),this.set(i,e),this.type=this.get("type"),this.filters=this.CONFIGURATOR.getFilters()||!1,this.get("render_into")?this.parentComponent=this.CONFIGURATOR.get(this.get("render_into")):this.get("layer_group")&&(this.layerGroup=this.CONFIGURATOR.getLayerGroup({name:this.get("layer_group"),safeName:this.get("layer_group"),order:this.get("order"),container:!!e.menu&&e.menu.componentContainer}),this.parentComponent=this.layerGroup,this.layerGroup.addLayer(this)),this.panoViewer=this.CONFIGURATOR.panoViewer;const n=this.CONFIGURATOR.getCameraRotationLimits();n.limit_camera_rotation>0&&this.panoViewer.setRotationLimitsTheta&&this.panoViewer.setRotationLimitsTheta(n.camera_rotation_min,n.camera_rotation_max);const{items:r}=i;let s=!1;const o=[];for(let t=0;t<r.length;t+=1){const{filterIds:e}=r[t];if(e.length>0)for(let i=0;i<e.length;i+=1){const e=r[t].filterIds[i];-1===o.indexOf(e)&&o.push(e)}}this.renderIntoFilterHolders=!1;for(let t=0,{length:i}=r;t<i;t+=1){const i=new Wi(this.CONFIGURATOR,r[t],e);i.get("siblings")&&i.get("siblings").length&&(s=!0);const n=i.get("index")||t;if(i.set("index",n),this.addReference(i,e),i.registerFilters(),this.items.push(i),i.visible&&!i.disabled&&!0===this.renderIntoFilterHolders){r[t].filterIds[0]}}if(s)for(let t=0,e=this.items.length;t<e;t+=1){const e=this.items[t],i=e.get("siblings");if(i&&i.length)for(let t=0,n=i.length;t<n;t+=1){const n=this.getItemById(i[t]);n&&e.siblings.push(n)}}return this}chooseReactiveNeighbours(){if(this.CONFIGURATOR.log("----------------------------------------"),this.CONFIGURATOR.log(`Layer. '${this.get("name")}' chooseReactiveNeighbours:`),!this.activeItem)return;if(!1===this.activeItem.get("hidden"))return void this.CONFIGURATOR.log(` - Item ${this.activeItem.get("id")} '${this.activeItem.get("name")}' is still visible, no change`);this.CONFIGURATOR.log(` - Finding neighbour for ${this.activeItem.get("id")} '${this.activeItem.get("name")}'`);const t=this.activeItem.siblings;if(this.CONFIGURATOR.log(` - Checking ${t.length} siblings`),t&&t.length>0)for(let e=0;e<t.length;e+=1){const i=t[e],n=i.get("hidden");if(this.CONFIGURATOR.log(`Checking sibling ${t[e].get("id")}. '${t[e].get("name")}' hidden ${n} disabled ${i.disabled}`),!n&&!i.disabled)return this.CONFIGURATOR.log(`   - Choosing sibling ${t[e].get("id")}. '${t[e].get("name")}'`),void i.setActive()}this.CONFIGURATOR.log(" - Checking RGB "+this.activeItem.get("rgb"));const e=this.activeItem.get("rgb");if(e){const t=Ji(e),i=Qi(t),n=[],r=[];for(let t=0;t<this.items.length;t+=1){const e=this.items[t];if(!e.get("hidden")&&!e.disabled){const i=Qi(Ji(e.attributes.rgb));n.push(t),r.push(i)}}if(this.CONFIGURATOR.log(`   - Matching RGB ${t[0].toFixed(2)} ${t[1].toFixed(2)} ${t[2].toFixed(2)} HSV ${i[0].toFixed(2)} ${i[1].toFixed(2)} ${i[2].toFixed(2)} Against ${r.length} available neighbours`),r.length>0){const t=n[Ki(i,r)];return this.CONFIGURATOR.log(`   - Choosing Item ${this.items[t].get("id")} '${this.items[t].get("name")}'`),void this.items[t].setActive()}}for(let t=0;t<this.items.length;t+=1){const e=this.items[t];if(!e.get("hidden")&&!e.disabled)return this.CONFIGURATOR.log(` - Choosing first available from visible items. ItemId ${e.get("id")} '${e.get("name")}'`),void e.setActive()}this.CONFIGURATOR.log(" - No neighbour found")}activateFilter(t,e){this.CONFIGURATOR.log("Layer. activateFilter "+type),this.CONFIGURATOR.log(" - this.itemsVisible: "+this.itemsVisible);const i=this.CONFIGURATOR.getFilters().byGroup[t].filters[e];return i.disabled?(console.log("filter is disabled abandoning"),!1):(i.activate(),!0)}set(t,e,i){let n;"object"==typeof t?(n=t,i=e):(n={})[t]=e;const r=this.attributes;this.options=i;for(const t in n)"items"!==t&&(r[t]=n[t])}setActive(t,e){if(this.active||this.get("layer_type")>=4)return this;if(this.configurator.newLayerActive(this,t,e),this.marker&&this.marker.el.classList?this.marker.el.classList.add("active"):this.marker&&this.marker.el.setAttribute("class","active"),this.active=!0,"function"==typeof this.options.layerActivatedCallback)this.options.layerActivatedCallback(this);else if(void 0!==this.options.layerActivatedCallback)throw new Error("layerActivatedCallback is not a function");return this}newItemActive(t){if(this.activeItem&&(this.activeItem.active=!1),this.activeItem=t,this.configurator.updateNotify(),this.events)for(const t in this.events)for(let e=0,i=this.events.length;e<i;e+=1)t[e].layerUpdate();if(t.filter){const e=[];for(let i=0,n=t.filter.length;i<n;i+=1){const{group:n}=t.filter[i];if("reactive"===t.filter[i].type)continue;let r=t.filter[i].options[0];r=n.filters[r],e.push(r),r.triggerReactivate()}e.forEach(t=>{t.updateFilters("reactive")})}if("function"==typeof this.options.itemChangeCallback)this.options.itemChangeCallback(t);else if(null!=this.options.itemChangeCallback)throw new Error("layerChangeCallback is not a function")}clearActive(){this.marker&&this.marker.el.classList?this.marker.el.classList.remove("active"):this.marker&&this.marker.el.setAttribute("class",""),this.active=!1,this.panoViewer&&this.panoViewer.layerDeactivated&&this.panoViewer.layerDeactivated()}filterUpdate(){}get validItemCount(){return Number.isInteger(this.itemsVisible)?this.itemsVisible:""}getNextItem(){let t=this.items.indexOf(this.activeItem);const e=t,{length:i}=this.items;for(t+=1,t===i&&(t=0);!this.items[t].visible;)if(t+=1,t===i&&(t=0),e===t)return!1;return this.items[t]}getItem(t){if(null===t)return;let e=this.byIndex[t]||this.byIndex[t.id];return!!e&&(e.disabled&&(e=e.checkForValidSibling()),e)}getItemById(t){if(null!==t)return this.byId[t]||this.byId[t.id]}getFilter(t){for(let e=0,i=this.filters.length;e<i;e+=1)if(this.filters[e].name===t)return this.filters[e];return!1}find(t,e){for(let e=0,i=this.items.length;e<i;e+=1)this.items[e].get(t);return[]}addReference(t,e){return this.byId[t.get("id")]=t,this.byIndex[t.get("index")]=t,t.layer||(t.layer=this),this.get("parent_layer")&&(t.parentLayer=this.CONFIGURATOR.get(this.get("parent_layer"))),this}deactive(){}reset(){this.CURRENT_CONFIGURATION="",this.itemsVisible=0,this.items=[],this.byId={},this.byIndex={},this.active=!1,this.activeItem=!1,this.activeSubMenuEl=!1,this.activeSubmenu=!1,this.filters=[],this.panoViewer=!1,this.type=!1,this.scrollValue=0,this.previouslyActive=!1,this.previousActive=!1}getItemTotalFiltered(t){const e=this.items;let i=0;for(let n=0;n<e.length;n+=1){const r=e[n].filters;for(let e=0;e<r.length;e+=1){r[e].name===t&&(i+=1)}}return i}onHotspotClick(t,e,i){this.CONFIGURATOR.onHotspotClick(t,e,i)}destroy(){this.reset()}get(t){return this.attributes[t]}}class en{constructor(t){this.reset(),this.init(t)}init(t){this.name=t.name,this.safeName=t.safeName;const e=function(t){t=t||{};const e=document.createElement("a");e.className="collection__title list_order_"+t.order,e.dataset.collection=t.safeName,e.innerHTML=t.name;const i=document.createElementNS("http://www.w3.org/2000/svg","svg");if(void 0!==i.innerHTML)i.innerHTML='<g fill="none" stroke="%2327ae60"><path d="M31.9 19.2h5.8M31 21.2h16.8v23H31v-23z"/><path d="M31 29.2h-7.4v-13H46v5"/><path d="M23.6 27.7l-10.9-4.4v-8.1l11 4"/><path d="M12.7 23.4v-8.5h22.4l3.4 1.4M44.4 24.2v3.7"/></g>';else{const t=(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg"><g fill="none"><path d="M32.3 16.7h7.2m-8.3 2.5H52v28.5H31.2V19.2z"/><path d="M31.2 29.1H22V13h27.7v6.2"/><path d="M22 27.3L8.5 21.9V11.8l13.6 5"/><path d="M8.5 21.9V11.4h27.7l4.2 1.7m7.4 9.8v4.6"/></g></svg>',"image/svg+xml");i.appendChild(document.adoptNode(t.documentElement))}e.appendChild(i);const n=document.createElement("li");n.dataset.collection=t.safeName,n.className="js-select-component",n.className="js-select-component-group configuration__elements__components__component configuration__elements__components__component--group",n.appendChild(e);const r=document.createElement("ul");r.className="configuration__elements__components__component__group_menu",n.appendChild(r);const s=document.createElement("ul");return s.className="configuration__elements__components__component__group__container",n.appendChild(s),{layerGroupContainer:n,layerGroupMenu:r,layerGroupComponentContainer:s}}(t);this.el.container=e.layerGroupContainer,this.el.menu=e.layerGroupMenu,this.el.componentContainer=e.layerGroupComponentContainer}addLayer(t){const e=document.createElement("li");e.className="js-select-component js-layer-group",e.dataset.collection=t.get("file_path"),e.innerText=t.get("name"),this.el.menu.appendChild(e),this.layers.push(t)}newLayerActive(t){t.options.menu&&(Array.prototype.forEach.call(this.el.menu.getElementsByTagName("li"),t=>{t.classList.remove("active")}),this.el.menu.querySelectorAll(`[data-collection="${t.get("file_path")}"]`)[0].classList.add("active"),this.el.container.classList.add("active"))}setActive(t){t||(t=this.lastActiveLayer||this.layers[0]),this.lastActiveLayer=this.activeLayer,this.activeLayer=this.layers.filter(e=>e===t)[0],this.activeLayer.setActive(!0),this.active=!0,this.el.container.classList.add("active")}deactivate(){this.el.container.classList.remove("active"),this.active=!1}reset(){this.layers=[],this.activeLayer=!1,this.lastActiveLayer=!1,this.el={},this.active=!1}}class nn{constructor(t,e,i){this.CONFIGURATOR=t,this.INTERACTION_SURFACE=e,this.GESTURE_HANDLE_CONTAINER=i,this.rotationScalar=600/window.devicePixelRatio,this.touchZoomDelta=25/window.devicePixelRatio,this.touchZoomOutputScalar=.01,this.isTouchToZoom=!1,this.touchZoomScale=0,this.isTouchToRotate=!1,this.touchRotateTotal=0,this.hinterMessageZoom="Use ctrl + scroll to zoom",this.hinterMessageTouch="Use two fingers to look around",this.hinterMessageZoomShown=!1,this.hinterMessageTouchShown=!1;const n=t.options.gestureHandling;this.gestureHandlingMode=n.mode,this.enabledZoom=n.enabledZoom,this.enabledRotate=n.enabledRotate,this.enabledZoomFullscreen=n.enabledZoomFullscreen,this.enabledRotateFullscreen=n.enabledRotateFullscreen,this.rotationScalar=n.rotationScalar/window.devicePixelRatio,this.touchZoomDelta=n.touchZoomDelta/window.devicePixelRatio,console.log(n),this.CONFIGURATOR.log("GestureHandler. "+this.gestureHandlingMode+" zoom/rotate: "+this.enabledZoom+" "+this.enabledRotate+" fullscreen zoom/rotate: "+this.enabledZoomFullscreen+" "+this.enabledRotateFullscreen+" rotationScalar: "+this.rotationScalar+" touchZoomDelta: "+this.touchZoomDelta),this.isFullscreen=!1,this.positionPreviousX=-1,this.positionPreviousY=-1,this.isDown=!1,this.enable()}enable(){const{INTERACTION_SURFACE:t}=this;this.disable(),t.addEventListener("touchstart",this.onTouchStart.bind(this)),t.addEventListener("touchend",this.onTouchEnd.bind(this)),t.addEventListener("touchmove",this.onTouchMove.bind(this)),t.addEventListener("mousedown",this.onMouseDown.bind(this)),t.addEventListener("mousemove",this.onMouseMove.bind(this)),t.addEventListener("mouseup",this.onMouseUp.bind(this)),t.addEventListener("mouseout",this.onMouseOut.bind(this)),t.addEventListener("wheel",this.onWheel.bind(this))}disable(){const{INTERACTION_SURFACE:t}=this;t.removeEventListener("touchstart",this.onTouchStart.bind(this)),t.removeEventListener("touchend",this.onTouchEnd.bind(this)),t.removeEventListener("touchmove",this.onTouchMove.bind(this)),t.removeEventListener("mousedown",this.onMouseDown.bind(this)),t.removeEventListener("mousemove",this.onMouseMove.bind(this)),t.removeEventListener("mouseup",this.onMouseUp.bind(this)),t.removeEventListener("mouseout",this.onMouseOut.bind(this)),t.removeEventListener("wheel",this.onWheel.bind(this))}onMouseDown(t){t.preventDefault();const e=this.INTERACTION_SURFACE.getBoundingClientRect();this.onInteractionStart(t.clientX-e.left,t.clientY-e.top)}onTouchStart(t){const e=t.changedTouches[0],i=t.touches.length,n=this.INTERACTION_SURFACE.getBoundingClientRect();if("cooperative"===this.gestureHandlingMode&&i>=2){t.preventDefault();let e=!1;if(this.enabledRotate&&!1===this.isFullscreen&&(e=!0),this.enabledRotateFullscreen&&!0===this.isFullscreen&&(e=!0),t.touches&&t.touches.length<2&&!0===e)return void(!1===this.hinterMessageTouchShown&&(this.showHinter(this.hinterMessageTouch),this.hinterMessageTouchShown=!0))}else"greedy"===this.gestureHandlingMode&&1===i&&t.preventDefault();this.onInteractionStart(e.clientX-n.left,e.clientY-n.top)}onInteractionStart(t,e){this.positionPreviousX=t,this.positionPreviousY=e,this.isDown=!0,this.CONFIGURATOR.onInteractionStart()}onMouseMove(t){t.preventDefault();const e=this.INTERACTION_SURFACE.getBoundingClientRect();this.onInteractionMove(t.clientX-e.left,t.clientY-e.top)}onTouchMove(t){const e=this.INTERACTION_SURFACE.getBoundingClientRect(),i=t.targetTouches,n=i.length;let r=0,s=0;if(n>=2){t.preventDefault();let o=!1;const a=this.getTouchScale(t);if(!1===this.isTouchToZoom)this.touchZoomScale=a,this.isTouchToZoom=!0;else{const t=this.touchZoomScale-a;Math.abs(t)>this.touchZoomDelta&&(this.CONFIGURATOR.onInteractionZoom(t*this.touchZoomOutputScalar),this.touchZoomScale=a,o=!0)}if(!0===o)return;if("cooperative"===this.gestureHandlingMode){for(let t=0;t<n;t+=1)r+=i[t].clientX-e.left,s+=i[t].clientY-e.top;r/=n,s/=n}}else{if("greedy"!==this.gestureHandlingMode||1!==n)return;t.preventDefault(),r+=i[0].clientX-e.left,s+=i[0].clientY-e.top}!1===this.isTouchToRotate||n!==this.touchRotateTotal?(this.positionPreviousX=r,this.positionPreviousY=s,this.isTouchToRotate=!0,this.touchRotateTotal=n):this.onInteractionMove(r,s)}onInteractionMove(t,e){if(!0===this.isDown){const{CONFIGURATOR:i,rotationScalar:n}=this;i.rotateHorizontal(-(t-this.positionPreviousX)/n),i.rotateVertical(-(e-this.positionPreviousY)/n)}this.positionPreviousX=t,this.positionPreviousY=e}onMouseUp(t){t.preventDefault();const e=this.INTERACTION_SURFACE.getBoundingClientRect();this.onInteractionEnd(t.clientX-e.left,t.clientY-e.top)}onTouchEnd(t){t.preventDefault();const e=t.changedTouches[0],i=this.INTERACTION_SURFACE.getBoundingClientRect();this.onInteractionEnd(e.clientX-i.left,e.clientY-i.top)}onMouseOut(t){t.preventDefault();const e=this.INTERACTION_SURFACE.getBoundingClientRect();this.onInteractionEnd(t.clientX-e.left,t.clientY-e.top)}onInteractionEnd(t,e){this.positionPreviousX=t,this.positionPreviousY=e,this.isDown=!1,this.isTouchToZoom=!1,this.isTouchToRotate=!1,this.CONFIGURATOR.onInteractionEnd()}onWheel(t){let e=!1;if("cooperative"===this.gestureHandlingMode){let i=!1;if(this.enabledZoom&&!1===this.isFullscreen&&(i=!0),this.enabledZoomFullscreen&&!0===this.isFullscreen&&(i=!0),i&&!0!==t.ctrlKey)return void(!1===this.hinterMessageZoomShown&&(this.showHinter(this.hinterMessageZoom),this.hinterMessageZoomShown=!0));e=!0}else"greedy"===this.gestureHandlingMode&&(e=!0);e&&(t.preventDefault(),t.deltaY<0?this.CONFIGURATOR.onInteractionZoom(-1):t.deltaY>0&&this.CONFIGURATOR.onInteractionZoom(1))}startTimer(){this.clearTimer(),this.timer=setTimeout(this.hideHinter.bind(this),1500)}clearTimer(){this.timer&&(clearTimeout(this.timer),this.timer=void 0)}showHinter(t){const{GESTURE_HANDLE_CONTAINER:e}=this;e.innerHTML=`<p>${t}</p>`,e.classList.remove("configurator__gesture-hinter--hidden"),this.startTimer()}hideHinter(){this.GESTURE_HANDLE_CONTAINER.classList.add("configurator__gesture-hinter--hidden")}getTouchScale(t){let e,i,n,r,s,o=0;for(r=0;r<t.targetTouches.length;r+=1)for(s=0;s<t.targetTouches.length;s+=1)e=t.targetTouches[r].clientX-t.targetTouches[s].clientX,i=t.targetTouches[r].clientY-t.targetTouches[s].clientY,n=Math.sqrt(e*e+i*i),n>o&&(o=n);return o}onEnterFullscreen(){this.isFullscreen=!0}onLeaveFullscreen(){this.isFullscreen=!1}}class rn{constructor(){this.currentConfigurationString=null,this.LAYER_DETAILS=[],this.SCENE_LAYER_DETAILS={}}setString(t){this.currentConfigurationString=t}getString(){return this.currentConfigurationString}setLayerDetails(t,e){this.LAYER_DETAILS=[];const{length:i}=t;let n;void 0===this.SCENE_LAYER_DETAILS[e]&&(this.SCENE_LAYER_DETAILS[e]=[]);for(let r=0;r<i;r+=1){let i,s;n=t[r],"LAYER_GROUP_BY"===n.LAYER_TYPE?(i=n.LAYERDATA.name,s=parseInt(n.itemIndexActive)):(i=n.attributes.name,s=n.activeItem.attributes.index),this.LAYER_DETAILS.push({name:i,index:s}),this.SCENE_LAYER_DETAILS[e].push({name:i,index:s})}}getIndexForLayer(t){const{LAYER_DETAILS:e}=this;for(let i=0;i<e.length;i+=1)if(e[i].name===t)return e[i].index;return 0}getAreLayerDetailsSet(){return 0!==this.LAYER_DETAILS.length}getAreSceneLayerDetailsSet(t){return void 0!==this.SCENE_LAYER_DETAILS[t]&&0!==this.SCENE_LAYER_DETAILS[t].length}}class sn{constructor(t,e){this.CONFIGURATOR=t,this.HOLDER=document.createElement("div"),this.HOLDER.className="zoom-controller-holder",e.appendChild(this.HOLDER),this.BUTTON_IN=document.createElement("div"),this.BUTTON_IN.className="zoom-controller-in",this.HOLDER.appendChild(this.BUTTON_IN),this.BUTTON_OUT=document.createElement("div"),this.BUTTON_OUT.className="zoom-controller-out",this.HOLDER.appendChild(this.BUTTON_OUT),this.BUTTON_IN.onclick=this.onZoomIn.bind(this),this.BUTTON_OUT.onclick=this.onZoomOut.bind(this)}onZoomIn(t){t.preventDefault(),this.CONFIGURATOR.onInteractionZoom(-1)}onZoomOut(t){t.preventDefault(),this.CONFIGURATOR.onInteractionZoom(1)}}class on{constructor(t,e){this.CONFIGURATOR=t,this.options=e,this.remoteControl=!1}setRemoteType(t){if("slave"!==t.type&&"master"!==t.type)return void(this.remoteControl=!1);window.WebSocket=window.WebSocket||window.MozWebSocket;let e=t.wsURL;t.port&&(e+=":"+t.port),e=new WebSocket(e),this.remoteControl={type:t.type,ws:e,connected:!1},e.onerror=this.webSocketError,e.onmessage=this.webSocketReceive.bind(this),e.onopen=this.webSocketOpened.bind(this),e.onclose=this.webSocketClosed.bind(this)}webSocketOpened(){this.remoteControl.connected=!0;const t={type:"register",data:this.remoteControl.type,id:!1,date:Date.now()};this.remoteControl.ws.send(JSON.stringify(t))}webSocketClosed(){if("master"===this.remoteControl.type){const t=document.getElementsByClassName("ws-status")[0];t&&(t.classList.remove("connected"),t.classList.remove("populated"),t.innerText="0")}this.remoteControl.connected=!1}webSocketDisconnect(){this.remoteControl.ws.close(),this.remoteControl.connected=!1;const t=document.getElementsByClassName("ws-status")[0];t&&(t.classList.remove("connected"),t.innerText="0")}webSocketStatus(){switch(this.remoteControl.ws.readyState){case this.remoteControl.ws.CLOSED:case this.remoteControl.ws.CLOSING:case this.remoteControl.ws.CONNECTING:case this.remoteControl.ws.OPEN:}}webSocketError(){this.remoteControl=!1}webSocketReceive(t){const e=JSON.parse(t.data);let i;switch(e.type){case"message":break;case"connection:created":if(this.remoteControl.id=e.id,"slave"===this.remoteControl.type){const t=document.createElement("div");t.className="pairing";const i=new Image;i.src=e.qr,t.appendChild(i),document.body.appendChild(t)}else i=document.getElementsByClassName("ws-status")[0],i||(i=document.createElement("div"),i.className="ws-status",document.body.append(i)),i.classList.add("connected");break;case"connection:destroyed":break;case"room:join":"slave"===this.remoteControl.type&&document.getElementsByClassName("pairing")[0]&&document.getElementsByClassName("pairing")[0].remove(),void 0!==e.config&&this.setRemoteConfig(e.config);break;case"room:left":"master"===this.remoteControl.type&&(i=document.getElementsByClassName("ws-status")[0],i&&(i.innerText=e.userCount-1));break;case"room:userJoined":"slave"===this.remoteControl.type||(i=document.getElementsByClassName("ws-status")[0],i||(i=document.createElement("div"),i.className="ws-status",document.body.append(i)),i.classList.remove("connected"),i.classList.add("populated"),i.innerText=e.userCount-1);break;case"room:userLeft":"slave"===this.remoteControl.type||(i=document.getElementsByClassName("ws-status")[0],i||(i=document.createElement("div"),i.className="ws-status",document.body.append(i)),e.userCount>1?(i.classList.remove("connected"),i.classList.add("populated")):(i.classList.remove("populated"),i.classList.add("connected")),i.innerText=e.userCount-1);break;case"config:update":void 0!==e.config&&this.setRemoteConfig(e.config)}}webSocketAuthUser(t){const e={type:"room:authorise",userId:t,room:this.remoteControl.room};this.remoteControl.ws.send(JSON.stringify(e))}webSocketSend(t){const e={config:t,type:"config"};this.remoteControl.ws.send(JSON.stringify(e))}close(){}}class an{constructor(t,e,i){this.CONFIGURATOR=t,this.APPLICATION_OPTIONS=e,this.FILTER_DATA=i,this.FILTER_GROUP_ID=i.safe_name,this.items=[],this.attributes={name:i.name,layer_type:"pallets"};const n=i.filters;for(let t=0;t<n.length;t+=1){const e=n[t];this.items.push({itemIndex:t,filterGroupId:i.safe_name,filterId:e.safe_name,attributes:{thumbnail:`${this.CONFIGURATOR.getDynamicThumbUrl()}${e.thumbnail}`,name:e.safe_name},disabled:e.disabled,active:!1})}this.isActive=!1,this.itemIndexActive=0,this.activeItem={attributes:{}}}setActive(){this.isActive=!0}clearActive(){!1!==this.isActive&&(this.isActive=!1)}toggleActive(){return!0===this.isActive?this.clearActive():this.setActive(),this.isActive}onItemClick(t){t.preventDefault();const{CONFIGURATOR:e}=this,i=t.target;this.setItemByIndex(i.dataset.itemIndex),e.onItemClick()}chooseReactiveNeighbours(){!0!==this.protectFromReactiveUpdates?console.log(`LayerFilter ${this.FILTER_DATA.name}. chooseReactiveNeighbours`):console.log(`LayerFilter ${this.FILTER_DATA.name}. chooseReactiveNeighbours PROTECTED`)}setItemByFilterId(t){const e=this.getItemIndexByFilterId(t);this.setItemByIndex(e)}getItemIndexByFilterId(t){const e=this.FILTER_DATA.filters;let i=0;for(let n=0;n<e.length;n+=1)e[n].safe_name===t&&(i=n);return i}setItemByIndex(t){const{CONFIGURATOR:e}=this,i=this.FILTER_DATA.filters[t];e.setFilter(this.FILTER_GROUP_ID,i.safe_name),this.highlightItemByIndex(t),this.itemIndexActive=t,e.chooseReactiveNeighbours(),e.updateNotify(),this.updateActiveItem()}highlightItemByIndex(t){const{items:e}=this;for(let i=0;i<e.length;i+=1){const n=e[i];i===parseInt(t,10)?n.active=!0:n.active=!1}}updateActiveItem(){this.activeItem.attributes=this.FILTER_DATA.filters[this.itemIndexActive]}getIsActive(){return this.isActive}getSafeName(){return this.FILTER_DATA.safe_name}getName(){return this.FILTER_DATA.name}}class hn{constructor(t,e,i){this.LAYERDATA=t,this.APPLICATION_OPTIONS=e,this.CONFIGURATOR=i,this.LAYER_TYPE="LAYER_GROUP_BY",this.FILTER_GROUP_ID=parseInt(t.group_by,10),this.FILTER_SUBGROUP_ID=parseInt(t.sub_group,10),this.FILTER_DATA_GROUP=this.getFilterGroupDataById(this.FILTER_GROUP_ID),this.FILTER_GROUP_NAME=this.FILTER_DATA_GROUP.safe_name,isNaN(this.FILTER_SUBGROUP_ID)||(this.FILTER_DATA_SUBGROUP=this.getFilterGroupDataById(this.FILTER_SUBGROUP_ID),this.FILTER_SUBGROUP_NAME=this.FILTER_DATA_SUBGROUP.safe_name),console.log(`LayerGroupBy. Created '${t.name}' Group ${this.FILTER_GROUP_ID} ${this.FILTER_GROUP_NAME} SubGroup ${this.FILTER_SUBGROUP_ID} ${this.FILTER_SUBGROUP_NAME} _____`),this.FILTER_ELEMENTS=[],this.items=[],this.groupedItems=[];const n=this.LAYERDATA.items;for(let t=0;t<n.length;t+=1){const e=n[t];0===t&&(e.active=!0),e.index=t,this.items.push(e),this.groupItem(e)}this.itemsVisible=1,this.itemIndexActive=0,this.isActive=!1,this.activeItem={attributes:{}},this.AVAILABLE_FILTERED_ITEM_INDEXES=[]}setActive(){this.applyFiltering(),this.isActive=!0,this.CONFIGURATOR.newLayerActive(this)}clearActive(){!1!==this.isActive&&(this.isActive=!1,this.CONFIGURATOR.collapseMenu())}toggleActive(){return!0===this.isActive?this.clearActive():this.setActive(),this.isActive}chooseReactiveNeighbours(){const{LAYERDATA:t,items:e}=this,i=this.itemIndexActive;this.CONFIGURATOR.log("----------------------------------------"),this.CONFIGURATOR.log(`LayerGroupBy. '${t.name}' chooseReactiveNeighbours:`),this.applyFiltering(),console.log(e[i]);if(!1===e[i].hidden)return void this.CONFIGURATOR.log(` - Item ${t.items[i].id} '${t.items[i].name}' is still visible, no change`);this.CONFIGURATOR.log(` - Finding neighbour for ${t.items[i].id} '${t.items[i].name}'`);const n=this.LAYERDATA.items[i].siblings;if(this.CONFIGURATOR.log(` - Checking ${n.length} siblings ${n}`),n&&n.length>0)for(let i=0;i<n.length;i+=1){const r=n[i];for(let i=0;i<e.length;i+=1){const n=t.items[i],s=e[i];if(n.id===r){const t=s.hidden;if(this.CONFIGURATOR.log(`    - Found sibling ${r} hidden ${t}`),!t)return this.CONFIGURATOR.log(`   - Choosing sibling ${n.id} ${n.name}.`),void this.setItemByIndex(i)}}}this.CONFIGURATOR.log(` - Checking RGB '${this.activeItem.attributes.rgb}'`);const r=this.activeItem.attributes.rgb;if(r){const e=Ji(r),i=Qi(e),n=[];for(let e=0;e<this.AVAILABLE_FILTERED_ITEM_INDEXES.length;e+=1){const i=Qi(Ji(t.items[this.AVAILABLE_FILTERED_ITEM_INDEXES[e]].rgb));n.push(i)}if(this.CONFIGURATOR.log(`   - Matching RGB ${e[0].toFixed(2)} ${e[1].toFixed(2)} ${e[2].toFixed(2)} HSV ${i[0].toFixed(2)} ${i[1].toFixed(2)} ${i[2].toFixed(2)} Against ${n.length} available neighbours`),n.length>0){const e=Ki(i,n),r=this.AVAILABLE_FILTERED_ITEM_INDEXES[e];return this.CONFIGURATOR.log(`   - Choosing Item ${t.items[r].id} '${t.items[r].name}'`),void this.setItemByIndex(r)}}for(let t=0;t<this.AVAILABLE_FILTERED_ITEM_INDEXES.length;t+=1){const e=this.AVAILABLE_FILTERED_ITEM_INDEXES[t],i=this.LAYERDATA.items[e];if(this.activeItem.attributes.name===i.name)return this.CONFIGURATOR.log(" - Found neighbour with same name. Index "+e),void this.setItemByIndex(e)}if(this.AVAILABLE_FILTERED_ITEM_INDEXES.length>0)return this.CONFIGURATOR.log(" - Choosing first available from visible items. Index "+this.AVAILABLE_FILTERED_ITEM_INDEXES[0]),void this.setItemByIndex(this.AVAILABLE_FILTERED_ITEM_INDEXES[0]);this.CONFIGURATOR.log(" - No neighbour found")}applyFiltering(){const t=this.CONFIGURATOR.filters,e=this.LAYERDATA.items,{items:i}=this;this.AVAILABLE_FILTERED_ITEM_INDEXES=[];let n=0;this.groupedItems=[];for(let r=0;r<i.length;r+=1){const s=e[r],o=s.filter,a=[];for(let t=0;t<o.length;t+=1){const e=o[t];e.group!==this.FILTER_SUBGROUP_NAME&&e.group!==this.FILTER_GROUP_NAME&&a.push({group:e.group,option:e.options})}let h=0;for(let e=0;e<a.length;e+=1){const i=a[e].group,n=a[e].option;null!=t.byGroup[i].currentActive&&n.includes(t.byGroup[i].currentActive.name)&&(h+=1)}h>=a.length?"true"!==s.disabled&&(this.showItem(r),n+=1,this.AVAILABLE_FILTERED_ITEM_INDEXES.push(r)):this.hideItem(r),this.groupItem(i[r])}this.itemsVisible=n}showItem(t){this.items[t].hidden=!1}hideItem(t){this.items[t].hidden=!0}hideEmptyFilterHolders(){const{CONTENT_HOLDER:t}=this,e=t.children;for(let t=0;t<e.length;t+=1){const i=e[t];let n,r=0;n=this.FILTER_SUBGROUP_NAME?i.getElementsByClassName("filter-holder"):i.getElementsByClassName("filter-items");for(let t=0;t<n.length;t+=1){const e=n[t],i=e.getElementsByClassName("js-select-item"),s=e.getElementsByClassName("js-select-item hidden");i.length===s.length?e.classList.add("hidden"):e.classList.remove("hidden"),r+=i.length-s.length}r-1<=0?i.classList.add("hidden"):i.classList.remove("hidden")}}onItemClick(t){t.preventDefault();const e=t.target.dataset.itemIndex;this.setItemByIndex(e),this.CONFIGURATOR.updateNotify(),this.CONFIGURATOR.onItemClick()}setItemByIndex(t){this.itemIndexActive=t,this.highlightItemByIndex(t),this.updateActiveItem(),this.CONFIGURATOR.updateNotify(),this.CONFIGURATOR.onItemClick()}setItemByItemId(t){const e=this.LAYERDATA.items;let i=0;for(let n=0;n<e.length;n+=1){e[n].id===t&&(i=n)}this.itemIndexActive=i,this.highlightItemByIndex(i),this.updateActiveItem(),this.CONFIGURATOR.updateNotify()}highlightItemByIndex(t){const{items:e}=this;for(let i=0;i<e.length;i+=1){const n=e[i];i===parseInt(t,10)?n.active=!0:n.active=!1}}updateActiveItem(){this.activeItem.attributes=this.LAYERDATA.items[this.itemIndexActive]}parseFilters(){if(!this.activeItem.attributes.filter||!this.activeItem.attributes.filter.length)return!1;const t=[];for(let e=this.activeItem.attributes.filter.length,i=0;i<e;i+=1){const e=this.activeItem.attributes.filter[i],n={name:e.name,value:e.options[0]};t.push(n)}return t}getIsActive(){return this.isActive}getItemIndexActive(){return this.itemIndexActive}getSafeName(){return this.LAYERDATA.file_path}getName(){return this.LAYERDATA.name}get(t){switch(t){case"build_order":return this.LAYERDATA.build_order;case"file_path":return this.LAYERDATA.file_path;case"name":return this.LAYERDATA.name}}getItem(t){return this.ITEMS[t]}getElement(t){switch(t){case"menuContainer":return this.COMPONENT_ELEMENT}}groupItem(t){let e,i=this.getItemFilter(t,this.FILTER_GROUP_NAME).options[0];if(i.replace(/_/g," "),this.FILTER_SUBGROUP_NAME){e=this.groupedItems.findIndex(t=>t.group.safe_name===i&&t.sub_group.safe_name===n);let n=this.getItemFilter(t,this.FILTER_SUBGROUP_NAME).options[0];e<0?this.groupedItems.push({group:{name:i.replace(/_/g," "),safe_name:i},sub_group:{name:n.replace(/_/g," "),safe_name:n},items:[t]}):this.groupedItems[e].items.push(t)}else e=this.groupedItems.findIndex(t=>t.group.safe_name===i),e<0?this.groupedItems.push({group:{name:i.replace(/_/g," "),safe_name:i},items:[t]}):this.groupedItems[e].items.push(t)}getOrCreateItemHolder(t){const{CONTENT_HOLDER:e}=this,i=this.getItemFilter(t,this.FILTER_GROUP_NAME),n="filter-holder filter-holder-"+i.options[0];let r=e.getElementsByClassName(n)[0];if(!r){r=document.createElement("div"),r.className=n,e.appendChild(r);const t=document.createElement("div");t.innerHTML=""+i.options[0].replace(/_/g," "),t.className="filter-title",r.appendChild(t)}if(this.FILTER_SUBGROUP_NAME){const e=this.getItemFilter(t,this.FILTER_SUBGROUP_NAME),i="filter-holder filter-holder-"+e.options[0];let n=r.getElementsByClassName(i)[0];if(!n){n=document.createElement("div"),n.className=i,r.appendChild(n);const t=document.createElement("div");t.innerHTML=""+e.options[0],t.className="subfilter-title",n.appendChild(t);const s=document.createElement("ul");s.className="subfilter-items",n.appendChild(s)}return n.children[1]}{const t=document.createElement("ul");return t.className="filter-items",r.appendChild(t),r.children[1]}}sortSubfiltergroupElements(t){const e=t.children;[].slice.call(e).sort(this.compareSubfilterElements).forEach((function(e){t.appendChild(e)}))}compareSubfilterElements(t,e){return t.classList<e.classList?1:t.classList>e.classList?-1:0}getItemFilter(t,e){const i=t.filter;for(let t=0;t<i.length;t+=1){const n=i[t];if(n.group===e)return n}}getFilterGroupDataById(t){const e=this.LAYERDATA.filter_groups;for(let i=0;i<e.length;i+=1){const n=e[i];if(parseInt(n.id,10)===t)return n}}destroy(){}}class cn{constructor(t){this.CONFIGURATOR=t,this.HISTORY=[]}add(t){const{HISTORY:e}=this;(0===e.length||t!==e[e.length-1])&&e.push(t)}rewind(t){const{HISTORY:e,CONFIGURATOR:i}=this;let n;for(let i=0;i<=t;i+=1)n=e.pop();void 0!==n&&(i.openLayerFilterByName(n),i.openLayerByName(n))}reset(){this.HISTORY=[]}}i(98);function ln(t){return("0"+Number(t).toString(16)).slice(-2).toUpperCase()}function un(t){return parseInt(t,16).toString()}function dn(t){return("0"+parseInt(t,10).toString(36)).slice(-2).toUpperCase()}function En(t){return parseInt(t,36)}const mn={};class fn{constructor(t){this.INITIALISED=!1,this.IS_DEBUG=t.isDebug,this.log("Configurator 0.1.2. Created with:"),this.log(t),this.filters=[],this.options=t,this.USER_AGENT_INFO=new ji,this.CONFIG_STRING_BASE=t.configStringBase||16,this.log(" - ConfigStringBase "+this.CONFIG_STRING_BASE),this.mode=!1,this.notify=!0,this.loaded=!1,this.touchState=!0,this.attributes={},this.layers=[],this.layerGroups=[],this.allLayers=[],this.el={},this.touchClick=!1,this.activeLayer=null,this.byId=[],this.menu=!1,this.remoteControl=!1,this.data={},this.options=t,this.enableKeyShortcuts=t.enableKeyShortcuts||!1,this.CONTAINER={},this.CONTAINER.main=t.configuratorElement,this.CONTAINER.stage=this.createContainer({type:"section",id:"stage",class:"",container:this.CONTAINER.main}),this.CONTAINER.stage.style.height="100%",this.CONTAINER.stage.style.width="100%",this.CONTAINER.stage.style.position="relative",this.CONTAINER.stage.style.overflow="hidden",this.CONTAINER.gestureHinter=this.createContainer({type:"section",id:"gesture-hinter",className:"configurator__gesture-hinter configurator__gesture-hinter--hidden",container:this.CONTAINER.main}),this.CONTAINER.hotspot=this.createContainer({type:"section",id:"hotspot-holder",className:"configurator__hotspot-holder",container:this.CONTAINER.main}),this.CONTAINER.elementHolder=this.createContainer({type:"section",id:"element-holder",className:"configurator__element-holder",container:this.CONTAINER.main}),this.CONTAINER.hotspot.style.position="absolute",this.CONTAINER.hotspot.style.top=0,this.CONTAINER.hotspot.style.left=0,this.CONTAINER.hotspot.style.width="100%",this.CONTAINER.hotspot.style.height="100%",this.CONTAINER.hotspot.style.pointerEvents="auto",this.CONTAINER.hotspot.style.zIndex=1,this.CONTAINER.hotspot.style.overflow=1,t.filters&&t.filters.length&&(this.postLoadFilters=t.filters),this.cache="none",this.isMobile=window.matchMedia("only screen and (max-width: 600px)").matches||window.matchMedia("only screen and ( max-height : 640px) and ( orientation: landscape )").matches,t.hideUI&&this.hideUI(),!0===this.USER_AGENT_INFO.isAvailableFullscreen()&&t.fullscreen.enabled&&(this.FULLSCREEN_CONTROLLER=new zi(this,t.fullscreen,this.CONTAINER.stage,t.configuratorElement)),this.ZOOM_CONTROLLER=new sn(this,this.CONTAINER.stage),t.remote&&(this.WEBSOCKET_CONTROLLER=new on(this,t)),this.GESTURE_HANDLER=new nn(this,this.CONTAINER.stage,this.CONTAINER.gestureHinter),this.LAYER_HISTORY_CONTROLLER=new cn(this),this.enableKeyShortcuts&&document.addEventListener("keydown",t=>{"n"===t.key&&this.nextLayer()}),t.mode?this.mode=t.mode:this.mode="web",this.CACHEABLE=t.settings.CACHEABLE||!1,this.CONFIGURATION=new rn,this.scene=t.scene;const e=t.settings.BASE_PATH||"/";if(this.setBasePath(e),mn.DYNAMIC_BASE_URL=t.settings.DYNAMIC_BASE_URL,mn.DYNAMIC_DATA_FILENAME=t.settings.DYNAMIC_DATA_FILENAME||"liveDataExport",mn.DYNAMIC_VERSION=t.settings.DYNAMIC_VERSION,this.generateDynamicUrls(this.scene),mn.STATIC_BASE_URL=t.settings.STATIC_BASE_URL,mn.STATIC_IMAGE_URL=mn.STATIC_BASE_URL+"image/",mn.ASSETURL="/",mn.IMAGEPATH="/",mn.DATAPATH="/",mn.THUMBPATH="/",!0===this.options.updateUrl||"true"===this.options.updateUrl){const t=this.parseUrl();t&&(this.options.config=t)}if(mn.WEBP=t.settings.WEBP||!1,t.settings.WEBP){const t=document.createElement("canvas");if(t.getContext&&t.getContext("2d")){const e=t.getContext("2d");e.width=1,e.height=1,mn.WEBP=0===t.toDataURL("image/webp").indexOf("data:image/webp")}else mn.WEBP=!1}}get(t){if(this.byId.length){if(e=t,!isNaN(parseFloat(e))&&isFinite(e))return this.allLayers[t];var e;for(let e=0,{length:i}=this.allLayers;e<i;e+=1)if(this.allLayers[e].get("file_path")===t)return this.allLayers[e]}}getActiveLayer(){return this.activeLayer}get listLayers(){return this.layers.map(t=>{console.log(t);const{order:e,name:i,layer_type:n,marker:r}=t.attributes;return{order:e,name:i,type:n,marker:r}})}nextLayer(){let t=this.layers.indexOf(this.activeLayer);t+=1,t===this.layers.length&&(t=0);this.get(t).setActive()}previousLayer(){let t=this.layers.indexOf(this.activeLayer);t-=1,t<0&&(t=this.layers.length-1),this.get(t).setActive()}getLayerGroup(t){"string"==typeof t&&(t={safeName:t});let e=this.layerGroups.filter(e=>e.safeName===t.safeName)[0];return e||(e=new en(t),t.container&&t.container.appendChild(e.el.container),this.layerGroups.push(e)),e}create(t){this.log("Create"),!0===this.isMobile&&!1===this.ENABLE_MOBILE_HOTSPOTS&&(this.options.hotspots=!1),0==this.INITIALISED&&this.initialiseAPI();const{length:e}=t;for(let i=0;i<e;i+=1)if("true"!==t[i].disabled)if(null===t[i].group_by){this.log(" - Creating layer "+t[i].name);const e=new tn(this);e.create(t[i],this.options,this),this.addReference(e),this.allLayers.push(e),"pallets"!==e.get("layer_type")&&"palletoptions"!==e.get("layer_type")||this.layers.push(e),this.length+=1}else{this.log(" - Creating layerGroupBy "+t[i].name);const e=new hn(t[i],this.options,this);this.layerGroupBys.push(e),this.allLayers.push(e)}return this.postLoadFilters&&this.postLoadFilters.forEach(t=>{this.setFilter(t[0],t[1])}),!0===this.CONFIGURATION.getAreLayerDetailsSet()?this.setConfigurationFromLayerDetails():this.setConfiguration(this.options.config),this}randomise(){this.setting=!0;for(let t=0,e=this.layers.length;t<e;t+=1){const e=this.get(t),i=Math.floor(Math.random()*e.items.length);e.byIndex[i].setActive()}this.setting=!1,this.updateNotify()}combinationCount(){let t=1;for(let e=0,i=this.layers.length;e<i;e+=1)t*=this.get(e).items.length;return t}setRemoteConfig(t){this.notify=!1,this.setConfiguration(t),this.notify=!0}setConfiguration(t){this.log("setConfiguration. "+t);const e=t||[];let i;if("string"==typeof e&&e.length===2*this.allLayers.length)i=e.match(/.{1,2}/g);else if(Array.isArray(e)&&e.length===this.allLayers.length)i=e;else{i=[];const{length:t}=this.allLayers;for(let e=0;e<t;e+=1)i[e]=0}this.setting=!0;for(let t in i)if(i.hasOwnProperty(t)){const e=this.get(t);if("LAYER_GROUP_BY"===e.LAYER_TYPE)16===this.CONFIG_STRING_BASE?e.setItemByIndex(un(i[e.get("build_order")])):e.setItemByIndex(En(i[e.get("build_order")]));else if(t=16===this.CONFIG_STRING_BASE?e.getItem(un(i[e.get("build_order")])):e.getItem(En(i[e.get("build_order")])),t||(t=e.getItem(0)),t){t.setActive();const e={};t.filters.forEach(t=>{e[t.filterCategoryName]||(e[t.filterCategoryName]=[]),e[t.filterCategoryName].push(t)});for(let t in e)if(1===e[t].length){const i=this.layerFilters.find(e=>t===e.FILTER_DATA.name);i?i.setItemByFilterId(e[t][0].name):!1===e[t].reactive&&e[t][0].activate()}}else this.log(" - Invalid Configuration, defaulting to basic load."),this.setConfiguration()}this.setting=!1,this.updateNotify()}setConfigurationFromLayerDetails(){const{length:t}=this.allLayers;let e,i,n;for(let r=0;r<t;r+=1){let t;e=this.allLayers[r],t="LAYER_GROUP_BY"===e.LAYER_TYPE?e.LAYERDATA.name:e.attributes.name,i=this.CONFIGURATION.getIndexForLayer(t),"LAYER_GROUP_BY"===e.LAYER_TYPE?e.setItemByIndex(i):(n=e.getItem(i),n&&n.setActive())}}activateFilter(){}setFilter(t,e){if(this.log(`setFilter. group:${t} filter:${e}`),!this.filters)return this.log("setFilter. this.filters not found. Abandoning"),!1;const i=this.filters.byGroup[t];if(!i)return this.log("setFilter. The filter group does not exist. Abandoning"),!1;const n=i.filters[e];return n?(this.log(" - Activating filter."),n.activate(),this.log(" - Activating filter. Complete"),"layer"===i.render_as&&(this.log(" - found Filter render_as ",n),this.setLayerFilterHighlight(t,e)),n):(this.log("setFilter. The filter group was found but no filter with that name exists."),i)}activateFiltersInGroup(t){if(this.log("activateFiltersInGroup. group:"+t),!this.filters)return this.log("activateFiltersInGroup. this.filters not found. Abandoning"),!1;const e=this.filters.byGroup[t];if(!e)return this.log(`activateFiltersInGroup. The filter group '${t}' does not exist. Abandoning`),!1;const i=e.filters;return Object.keys(i).forEach(t=>{const e=i[t];e.activate(!0),e.updateFilters()}),!0}getFilters(){return this.filters}setFilters(t){this.filters=t}setLayerFilterHighlight(t,e){const i=this.layerFilters.find(e=>e.FILTER_GROUP_ID===t);if(i){const t=i.getItemIndexByFilterId(e);i.highlightItemByIndex(t)}}closeLayerFilters(){const t=this.layerFilters;for(let e=0;e<t.length;e+=1)t[e].clearActive()}updateNotify(t=!0){if(t&&this.setting)return;const e=this.CONFIGURATION.getString(),i=this.buildConfigString();if(i===e)return;const n=[];if(e)for(let t=0,r=i.length/2;t<r;t+=1)i.charAt(t)+i.charAt(t+1)!==e.charAt(t)+e.charAt(t+1)&&n.push(t);if(this.log("Configurator. updateNotify. Setting config to "+i),this.CONFIGURATION.setString(i),i){"web"===this.mode&&1===this.options.urlUpdate?"true"===this.options.updateUrl&&window.history.replaceState({set:"system"},"",`${mn.BASEPATH}${i}`):"web"===this.mode&&2===this.options.urlUpdate&&"true"===this.options.updateUrl&&window.history.replaceState({set:"system"},"",`${mn.BASEPATH}${this.scene}/${i}`);const t=`${mn.DYNAMIC_TILE_URL}${i}_${this.CONFIG_STRING_BASE}_`;if(this.panoViewer.setPathTiles(t),i.length/2===this.allLayers.length){const t=this.getActiveElements();delete t.previewImage;const e=new CustomEvent("config-update",{detail:{config:t}});this.CONTAINER.main.dispatchEvent(e)}}}buildConfigString(){if(this.setting)return!1;let t;return this.log("buildConfigString. base "+this.CONFIG_STRING_BASE),t=16===this.CONFIG_STRING_BASE?this.buildConfigStringHex():this.buildConfigStringBase36(),t||(t=this.options.config),t}buildConfigStringHex(){this.log("buildConfigStringHex");let t=[];const e=this.allLayers;for(let i=0;i<e.length;i+=1){const n=e[i],r=n.get("build_order");if("LAYER_GROUP_BY"===n.LAYER_TYPE)t[r]=ln(n.getItemIndexActive());else{if(!n.activeItem)break;t[r]=ln(n.activeItem.get("index"))}}return t=t.join(""),t}buildConfigStringBase36(){this.log("buildConfigStringBase36");let t=[];const e=this.allLayers;for(let i=0;i<e.length;i+=1){const n=e[i],r=n.get("build_order");if("LAYER_GROUP_BY"===n.LAYER_TYPE){const e=dn(n.getItemIndexActive());t[r]=e}else{if(!n.activeItem)break;t[r]=dn(n.activeItem.get("index"))}}return t=t.join(""),t}getScreenshot(){const{format:t,quality:e}=this.options.screenshot;this.log("getScreenshot");const i=this.panoViewer.getScreenshot(t,e),n=document.createElement("img");return n.src=i,this.CONTAINER.main.appendChild(n),this.onInteractionZoom(100),n}openLayerByName(t){this.log(`openLayerByName '${t}'`);const e=this.allLayers;for(let i=0;i<e.length;i+=1){const n=e[i];n.get("name")===t&&n.setActive()}}closeLayers(){const t=this.allLayers;for(let e=0;e<t.length;e+=1)t[e].clearActive();this.activeLayer=!1}newLayerActive(t){if(this.log("newLayerActive "+t),this.addLayerHistory(t.get("name")),t.get("render_into")){const e=this.get(t.get("render_into"));this.activeLayer!==e&&e.setActive(),e.active=!1}else if(t.get("layer_group")){const e=this.getLayerGroup(t.get("layer_group"));this.activeLayer?(this.activeLayer.get("render_into")?this.get(this.activeLayer.get("render_into")).clearActive():this.activeLayer.clearActive(),this.activeLayer.get("layer_group")&&this.activeLayer.get("layer_group")!==t.get("layer_group")?this.getLayerGroup(this.activeLayer.get("layer_group")).deactivate():e.newLayerActive(t)):e.newLayerActive(t)}else this.activeLayer&&(this.activeLayer.get("render_into")&&this.activeLayer.get("render_into")!==t.get("file_path")&&(this.activeLayer.parentComponent.clearActive(),this.activeLayer.parentComponent.get("layer_group")&&this.activeLayer.parentComponent.parentComponent.deactivate()),this.activeLayer.get("layer_group")&&this.activeLayer.parentComponent&&this.activeLayer.parentComponent.deactivate(),this.activeLayer.clearActive());t.get("layer_group")&&this.getLayerGroup(t.get("layer_group")).newLayerActive(t),this.activeLayer=t,"LAYER_GROUP_BY"!==this.activeLayer.LAYER_TYPE&&this.options.hotspotFocus&&this.panoViewer.focusHotspot(this.activeLayer.attributes.name)}openMenu(){this.CONTAINER.menu.parentElement.classList.add("active")}collapseMenu(){this.CONTAINER.menu.parentElement.classList.remove("active")}menuItemClicked(t){let e,{target:i}=t;if("change"===t.type&&"itemGroup"===i.name){const e=t.target.getAttribute("data-item-index");return void this.getActiveLayer().getItem(e).setActive()}if("BUTTON"===i.tagName)return!0;if("UL"===i.tagName)return!1;if(i.classList&&i.classList.contains("js-hide-config-menu"))return void this.collapseMenu();for(;null!==i&&"LI"!==i.tagName;)i=i.parentNode;if(null===i)return!1;if(i.classList.contains("js-select-submenu"),i.classList.contains("js-select-component-group")){const t=this.getLayerGroup({safeName:i.dataset.collection});return void(this.menu.accordianMediaQuery.matches&&t.active?(t.deactivate(),this.activeLayer.clearActive(),this.activeLayer=!1,this.collapseMenu()):t.setActive())}if(i.classList.contains("js-select-component")){e=this.get(i.dataset.collection);const t=e.active;if(this.activeLayer===e&&t)return e.el.itemContainer.classList.remove("active"),void(e.active=!1);if(i.classList.contains("js-layer-group")&&e.layerGroup)return void e.layerGroup.setActive(e);e.setActive(!0);const n=this.menu.accordianMediaQuery.matches;let r,s;return e.get("layer_group")?(r=e.el.itemContainer.offsetTop,n?(r+=e.parentComponent.el.componentContainer.offsetTop,s=e.el.menuContainer.parentElement):s=e.parentComponent.el.componentContainer):(r=e.el.itemContainer.offsetTop,n?(r+=e.el.itemMenu.parentElement.offsetTop,s=e.el.menuContainer.parentElement):s=e.el.itemMenu.parentElement),void(t||function(t,e,i,n){const r=t,s="horizontal"===n?"scrollLeft":"scrollTop",o=t[s],a=e-o,h=Date.now();!function t(){const e=Date.now()-h,n=Math.easeInOutQuad(e,o,a,i);e<i?(r[s]=n,requestAnimationFrame(t,20)):r[s]=o+a}()}(s,r,500,"vertical"))}if(i.classList.contains("js-select-filter-group"))return void(i.parentElement.classList.contains("active")&&i.parentElement.classList.remove("active"));if(this.activeLayer&&i.dataset.collection===this.activeLayer.get("file_path"))return this.menu.accordianMediaQuery.matches?(this.activeLayer.clearActive(),this.activeLayer.get("layer_group")&&this.getLayerGroup(this.activeLayer.get("layer_group")).deactivate(),this.activeLayer=!1):this.CONTAINER.menu.parentElement.classList.add("active"),!1;void 0!==i.dataset.collection?(e=this.get(i.dataset.collection),e&&(this.closeLayerFilters(),e.setActive(!0))):void 0!==i.dataset.itemIndex&&(e=this.get(i.dataset.layerName),this.setting=!0,e&&("LAYER_GROUP_BY"===e.LAYER_TYPE?e.setItemByIndex(i.dataset.itemIndex):(e.getItem(i.dataset.itemIndex).setActive({scroll:!1,linked:!0,details:!0}),this.onItemClick())),this.setting=!1,this.updateNotify());const n=this.layerFilters;let r,s=!1;for(let t=0;t<n.length;t+=1){const e=n[t];i.dataset.collection===e.getSafeName()&&(s=e.toggleActive(),r=e.getName())}!0===s&&(this.addLayerHistory(r),this.closeLayers())}getDownloadLink(){return mn.ASSETURL+this.buildConfigString()+".jpg"}getScaledLink(t){return`${mn.ASSETURL+t}/${this.buildConfigString()}.jpg`}getTile(t,e){return`${mn.ASSETURL}tile/1024/${t}/${e}/${this.buildConfigString()}.jpg`}getCubicTile(t,e,i,n){return`${mn.DYNAMIC_TILE_URL}${this.buildConfigString()}_${e}_${i}_${n}.jpg`}getSocialImage(){return 36===this.CONFIG_STRING_BASE?mn.DYNAMIC_SOCIAL_URL+this.buildConfigString()+"_36.jpg":mn.DYNAMIC_SOCIAL_URL+this.buildConfigString()+".jpg"}addReference(t){const e=t.get("id");e?this.byId[e]=t:this.byId.push(t),t.layers||(t.configurator=this)}chooseReactiveNeighbours(){const t=this.allLayers;for(let e=0;e<t.length;e+=1)t[e].chooseReactiveNeighbours()}showScene(t){this.CONFIGURATION.setLayerDetails(this.allLayers,this.scene),this.reset(),this.generateDynamicUrls(t),this.scene=t,this.loadData()}setScene(t){t!==this.scene&&(this.clearHotspots(),this.showScene(t))}reset(){let t;for(t=0;t<this.allLayers.length;t+=1)this.allLayers[t].destroy();this.filters=[],this.attributes={},this.layers=[],this.layerGroups=[],this.layerFilters=[],this.layerGroupBys=[],this.allLayers=[],this.el={},this.activeLayer=null,this.byId=[],this.postLoadTickboxElements=[]}resetMenus(){}getActiveElements(){const t={current:this.buildConfigString(),sceneName:this.getCurrentSceneDisplayName(),url:document.location.href,previewImage:this.getSocialImage(),items:[]};for(let e=0;e<this.allLayers.length;e++){const i=this.allLayers[e],n=i.activeItem;if(!n)break;let r;if(r=i.layerGroup?i.layerGroup.name:i.parentComponent?i.parentComponent.layerGroup?i.parentComponent.layerGroup.name:i.parentComponent.get("name"):i.get("name"),"LAYER_GROUP_BY"===i.LAYER_TYPE){let e={component:i.get("name"),componentGroup:r,componentId:i.get("build_order"),id:n.attributes.id,name:n.attributes.name,thumbnail:mn.THUMBPATH+n.attributes.image_path+".jpg",description:n.attributes.description,productCode:n.attributes.product_code,filters:i.parseFilters()};void 0!==e.productCode&&null!==e.productCode||delete e.productCode,t.items.push(e)}else{let e={component:i.get("name"),componentGroup:r,componentId:i.get("build_order"),id:n.get("index"),name:n.get("name"),thumbnail:mn.THUMBPATH+n.get("image_path")+".jpg",description:n.get("description"),productCode:n.get("product_code"),filters:n.parseFilters()};void 0!==e.productCode&&null!==e.productCode||delete e.productCode,t.items.push(e)}}return t}reload(t){this.options.url=t,this.reset(),this.resetMenus(),this.loadData()}loadData(){const t=new XMLHttpRequest;t.open("GET",mn.DYNAMIC_DATA_URL,!0);const e=this;t.onreadystatechange=function(){if(t.readyState===XMLHttpRequest.DONE&&200===t.status){e.data=JSON.parse(t.responseText),!0===e.IS_DEBUG&&(console.log("Configurator. loaded data:"),console.log(e.data)),e.reset(),this.panoViewer&&this.panoViewer.clearHotspots(),e.LAYER_HISTORY_CONTROLLER.reset();const i=e.data.filter_groups;if(e.filters=!(!i||!i.length)&&new Zi(e,i),!e.postLoadFilters){e.postLoadFilters=[];for(const t in e.filters.byGroup){const i=Object.keys(e.filters.byGroup[t].filters)[0];e.postLoadFilters.push([t,i])}}for(let t=0;t<i.length;t+=1){const n=i[t];"layer"!==n.render_as&&"layerFilter"!==n.menu_type||e.layerFilters.push(new an(e,e.options,i[t]))}e.options.sceneSelector=e.options.sceneSelector||e.data.project_info.scene_selector;const{layers:n}=e.data;e.create(n),e.loaded=!0;const r=new CustomEvent("scene-data-loaded",{});e.CONTAINER.main.dispatchEvent(r)}else t.readyState===XMLHttpRequest.DONE&&t.status},t.send()}postLoad(){this.filters.filters.forEach(t=>{void 0!==t.el&&t.active?Array.isArray(t.el)?t.el.forEach(t=>{t.classList.add("active")}):t.el.classList.add("active"):t.el&&(Array.isArray(t.el)?t.el.forEach(t=>{t.classList.remove("active")}):t.el.classList.remove("active"))})}onItemClick(){const t=new CustomEvent("item-click",{detail:{}});this.CONTAINER.main.dispatchEvent(t)}rotateHorizontal(t){this.panoViewer.rotateHorizontal&&this.panoViewer.rotateHorizontal(t)}rotateVertical(t){this.panoViewer.rotateVertical&&this.panoViewer.rotateVertical(t)}onInteractionZoom(t){t<0?this.panoViewer.zoomIn&&this.panoViewer.zoomIn():this.panoViewer.zoomOut&&this.panoViewer.zoomOut()}onInteractionStart(){this.panoViewer.onInteractionStart&&this.panoViewer.onInteractionStart()}onInteractionEnd(){this.panoViewer.onInteractionEnd&&this.panoViewer.onInteractionEnd()}setRotation(t,e){this.panoViewer.setRotation(t,e)}getRotation(){return this.panoViewer.getRotation()}setZoom(t){this.onInteractionZoom(t)}onHotspotClick(t,e,i){this.log(`onHotspotClick ${t} ${e},${i}`),this.allLayers.forEach(e=>{"LAYER_GROUP_BY"===e.LAYER_TYPE?e.getName()===t&&e.setActive():e.attributes.name===t&&e.setActive()});const n=new CustomEvent("hotspot-click",{detail:{hotspotId:t,hotspotTheta:e,hotspotPhi:i}});this.CONTAINER.main.dispatchEvent(n)}addLayerHistory(t){this.LAYER_HISTORY_CONTROLLER.add(t)}rewindLayerHistory(t){this.LAYER_HISTORY_CONTROLLER.rewind(t)}onEnterFullscreen(){this.GESTURE_HANDLER.onEnterFullscreen()}onLeaveFullscreen(){this.GESTURE_HANDLER.onLeaveFullscreen()}generateDynamicUrls(t){"liveDataExport"===mn.DYNAMIC_DATA_FILENAME||mn.DYNAMIC_VERSION.includes(".")?(mn.DYNAMIC_DATA_URL=`${mn.DYNAMIC_BASE_URL}${t}/${mn.DYNAMIC_VERSION}/${mn.DYNAMIC_DATA_FILENAME}.json`,mn.DYNAMIC_THUMB_URL=`${mn.DYNAMIC_BASE_URL}${t}/${mn.DYNAMIC_VERSION}/thumb/`,mn.DYNAMIC_SOCIAL_URL=`${mn.DYNAMIC_BASE_URL}${t}/${mn.DYNAMIC_VERSION}/social/`,mn.DYNAMIC_SCENE_URL=`${mn.DYNAMIC_BASE_URL}${t}/${mn.DYNAMIC_VERSION}/`):(mn.DYNAMIC_DATA_URL=`${mn.DYNAMIC_BASE_URL}${t}/${mn.DYNAMIC_DATA_FILENAME}.json`,mn.DYNAMIC_THUMB_URL=`${mn.DYNAMIC_BASE_URL}${t}/thumb/`,mn.DYNAMIC_SOCIAL_URL=`${mn.DYNAMIC_BASE_URL}${t}/social/`,mn.DYNAMIC_SCENE_URL=`${mn.DYNAMIC_BASE_URL}${t}/`),mn.DYNAMIC_PREVIEW_URL=`${mn.DYNAMIC_BASE_URL}${t}/${mn.DYNAMIC_VERSION}/preview/`,mn.DYNAMIC_TILE_URL=`${mn.DYNAMIC_BASE_URL}${t}/${mn.DYNAMIC_VERSION}/tiles/`}getCacheable(){return this.CACHEABLE}getWebp(){return mn.WEBP}getDynamicBaseUrl(){return mn.DYNAMIC_BASE_URL}getStaticImageUrl(){return mn.STATIC_IMAGE_URL}getDynamicThumbUrl(){return mn.DYNAMIC_THUMB_URL}getDynamicSceneUrl(){return mn.DYNAMIC_SCENE_URL}getDynamicVersionUrl(){return mn.DYNAMIC_VERSION}getAssetUrl(){return mn.ASSETURL}getCurrentSceneId(){return this.scene}getCurrentSceneDisplayName(){if(!this.options.sceneSelector||!this.options.sceneSelector.scenes)return this.options.scene;{const{scenes:t}=this.options.sceneSelector;for(let e=0;e<t.length;e+=1)if(t[e].id===this.scene)return t[e].displayName}return""}getCameraRotationLimits(){return{limit_camera_rotation:this.data.limit_camera_rotation,camera_rotation_min:this.data.camera_rotation_min,camera_rotation_max:this.data.camera_rotation_max}}devLogCameraInfo(){this.panoViewer.devLogCameraInfo()}log(t){!0===this.IS_DEBUG&&console.log("Configurator. "+t)}createContainer(t){const e=document.createElement(t.type);return e.id=t.id,e.className=t.className,void 0!==t.container&&t.container.appendChild(e),e}initialiseAPI(){this.INITIALISED=!0;const{options:t}=this,e=t.dimensionsHotspot||[32,32];let i;i=void 0!==t.pathAssetHotspot?`${t.settings.STATIC_BASE_URL}${t.pathAssetHotspot}`:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACCCAYAAACO9sDAAAAAAXNSR0IArs4c6QAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAgKADAAQAAAABAAAAggAAAAARhnUtAAAPLklEQVR4Ae2dWYwcVxWGZ8aT2I63SbAzNnbiGdtJlNXOhi3LgEHigRdeWAQ8AC+AEBIRQgICElGiCFCQEA9ErEJ5AQmBxCIQvBAcObGceHdsjPcZr5lxjMfJeBtv/F9PV890Ty9VXedUV3fXkX5XdXXVufee8997zz11e9zZ0YJy8+bNW9SsOcLsSUeuTSsB15CrwvUScG1UeDc4dnZ2cq2lpLMVWiOHv0ftCIDjpzu164r0QoizQITg2NTSdASQs7tk8TuEwOE9OqdnN0IYNUaEtwXIcE6kuKFj00jTEECOnyWrLsnjtpRa+KLqdVw4KSJcSGkdi6qVagLI6fTsxQKOp8c3kzAiQIZTIgMjRSollQSQ4wnOlgt9QhCo6bQphcBxQDgsIqQuiEwVAeT4GTLUMmGp0C20klxTYwaFIyLC5bQ0LBUEkOOZ0+8RGOoJ8lpZCBKZGg6JCMQMDZWGEiA/x98rC9DrW93xpY6GCEeEA42MERpGADm/V41/WJgptLNcUuPfFAmGGmGExAkgx+NwHA8BMpmwAATYJSKQbEpMEiWAnH+nWvaocGtiLWyugsZU3R0iwXBS1U6EAHI88ztz/QohkTKTMqBDOTel85CwX0Tg3FXcnZEf8h9XK253bUnrKSeRxGhAjOAmrgTIhvzYfnOfEtwIIOf3q/kPCm5lxDZvcyhgGtitkeCYR3VdnCPn43jW9pnYWeC/IsFBO3XjmkwJIMej7xHhbuuKZvpyFhgUCXZb2sKMAHI+kf6TAku9TPwscFKqd4oIZBJjC06zEiL9zPlW1qysh9fj2NpETEYA9f6HVJt+kxr5KSH5RPaR5Sh7Bdlgwkso3kCSfePFDJs42Ad4XnhLSM1bO9WlVI5qFNhTejHq59ivXOV8Ejxpcz7OXiUwJbGvAMfPEaIKpDgj8NLmDWGHwLU0SL9sPyYSHIhTmVgjgCrQp8LJ66dB2DH0hPA+YaUACayFnT30ui3CZiGxlK3KqiTbRQLigrqkbgLI+fQqeljdOuqqcfFDlM2q40PCWoHhPClhgwdEeFnYJvC5EUIwuFUkqOttYl3Ok/N5o7deiD2FSEc9Qr3XC58WFgmNlnOqwB+EfwqNIAJlviISRJ6eIhNAzmflQG9rRG6f+lL2Z4W7hLQJ8cLvhX8JSW8EhYSbRAJGhNBSDwHul3be6iUtBJtfFfqTLriO8k7omV8L2+t4Ns4jbDPbF0VBJAKo98+X8jVCpOeiVKjMvZT5OeGDQpLllqlK5EvEBj8X6pqfI5fW0cF7g80iAT9UCSWhDSrnsz17vZBkoLVa5T0lsG5vViHH8DOBYDEJuaxCNogEobagRyEA6+qk5t1pKutLwkeFVhHigl8KlxJo0HERYGeYckIRQL2/R8reH0ahwT0LpeObQiPiDIPqV1VxSt/+QBisepfNlxtFgpFaqojoq4qcD0mSSvYsVVkvCK3ofOz8XuFHArkLbyE9X1NqEkAa7hYYAbyFKJ/ekURZ3m2ppp8Y6hmBjKWn3K7OW3PKrkoAKbhVNbzPs5Z53fSI54VmDvaimImA+mmBlY2n3C8fdlcroCoB9GCfML2aAoPv7pGO7whJri4Mqh1bBYEuK5yVsTVVVoDv+ip/XeXnWGIOFeyv9rDBdwR8DIe8lm1HoXcyEjD9eUlf3pdl9VcbAZboCaYAL5kjxc8Kc70KaBK9kP97gtc7jZnSjS/LSlkCiDGduntZ2SfsLrLU82q0XS2T0UQnYBqsOl/HqEpFX5YlgArCMZ4B2cek33Pui2Grhj3KEvgLTqXPVqdmup0ilRhXkTFTNES/QND3+eiP2TwxNjbWsWnTprLK1q1b19HdXckkZR+xvkjH2CLsslYsfSuEt0r1MtQXiZjCzpq1RRftPhBTvCj02qmMpmloaKhj4cKynaFjZGSkY968edEU2t99TiqfEmpm8eoo+lVlB9FfkHJTQHnrFB6JdfIZPd0w58eqeXIPs8/ii07FkYkskiIC5IM/th17CK91GeIyqW0B3rt4LA0X531cqEERAXQVJ3klfr4s3WTAMglnAY9RAN/i44KUEsCr9y9Tid6570KjWuTkPrVjtUNbinxcCHk1NJD581qXM/dPCTgdGldTZVdXV8UgUAFSzecTvuFTKu914zIXydf8KZqb6C0QQOcLSj7zvYVAqtT0/gULFnScPn3aol1J6GDJ/Jiw3bAwfM7fWj6LzslTAMs/D4HFqetaHg110vkJB70FX3sTgN6/3qEB7aSSjR2hNndEMEohEMwRQHMC0fncCArC3vqAbiS2yCSeBQgILaVHPs/5PhgBGBI8hmnmr0ziW2BNfBVFGuiUuR/2TCZA0R0GHwg2HjfQk6kYTwoV5m0jg+T0BQTwSIA/ooqmbqPH8PBwR09PT1mcP3/eyLbmahidVxlrzcUBwTLQ49VvKod/zX0dKXZ0NR9jT35bYCU5n3flA0BShNaSDf+2FoUAQYe10Dwd3zMFePR+0o1FKUeLGre5jllqP9Oqpcz0IoB11GrZ6GbWZT2tzoYAbBq0lmXWCjN9OQtY5wNyBPCYAhiuMrG3gLWvcgTwWKrlkgz27W97jdY/m5vBFACsJSOAtUXH9TGyWm6q0ctx+1w9aUbroWq8+dm/WMByes0tAy0ZRQX5xY/lehWdmUxYwHJ0zY0A1lOAJUMnmp2dBRawJMA0jxjAsoJBo7PjhAUs7dtt3fuppmUFJ5qdnQUWMF0JQIAbgWajY9EvT4x0ZmomLGD5i6FrGQEmDNssZ5Yd7DoEuGrcckuGGletJdRZEuCGBwEuOJCqJTxn1AhLAlz1mAJop2UljezWEmquqxXvGLYkR4CLhgoDVRkBAkvYHvkxh2XQfoURwIMAWRxg6/hAm3XHuggBPP52rXVFAwO0+9G6Y13yGgGOtLunnNp/wljvKAQYNVaKui1C7tenDrrbWeVm48aPdulnwlek1DoXQLAyYFzZdlfH8nq/oRGuyve5VQA6PQJBy580G7a7aVVZ2zPnc6YAxHJtOa5x/P/VC86zY3wLWA//OZ8HBMj9sYD4dSzSwHDFsJVJfAsQT22Lr6ZIQ87nAQHeLvrK7oP1sGVXs+bSdEDVtZ6mcz7PEUDBALkA6wIwcUYArBBfrIf/0bzPi3YEe0wDO9X2bDkYnwDWHWk4qFIwBfDZgwDofDUoLDvWZQFiqaN1PVn5oYKvJxNgSPdbvmgIiv+TTrJRILBG9OMfoz9S9Ql8fCa4o0AAzQljulgYGoIbDI6HpGOHgZ52VHFSjbb+O4HD8jWvlXNSIED+8/H80frwV2uF9err7e3t4I9ElEMK/lJ4abOsez/6i3xcSgCmAVLD1kIQQ0CYSXgL8OLnlfC3h7oT3+LjghQRQEMDc/WU/1SgcHe8k1/p8cLQE09VWzzN/z5+zbilJ/M+LqgtIkD+KvOOhzD0/N1DcQvqZN63XvphpqLhnwtTCCCGsETw2tDxW+k+T8GZVLQACblfVPy2/i/OybdT3vlMIUBeP5G7h5BxfNFDcQvp/J3a4pGaL+vTsgQQU4gDPDaK4CfSmqlZFVChFAlDv4dtSP2Wje3KEiBvEM9tXS+pDF5wZDJhAaLzn0x8ND0r2/spoRoBWIZ4bBilXKLb7wuFlCQX21iY958TPF6fX5beinsJKxJAQwZLtgHBS/4nxc8IUwITrwJTqpcM7PPClAjdqL6H5MuKqfiKBMgXPqCj1yhAEceEZwWM0I5CJ/uhsMep8fiuKrGqEkDMYaj2qlzQ5oM6eUFoxyTRj9XurYEhHI578j6sqLoqAXhKCogePV4STa7UG/rwLcFr5TG5rDScMy8/J2x0rAwvfcpG/pPLrEmA/M17dfTuoawKnhasf/2Sb0JqDpD8u4Jnz8dX+KymhCKAmESlj9bUFv+GQan4mtCqS8RTats3BKY9TyHwCzWahiJAvqY4JYmInRHg24JHQiTflIYcXlOpXxdOO5f+rvQfDlsG/xNFaNE79Dm6eZ3QHfqheDeu1eOMCLfFU9PQpwmkfyP8LYFaUNbGsL2f+kQiAA+IBHfpsIrzhGS+yvmK8GRC5VkWs0/KfipUXYoZFrhTzo9UVmQCUFmR4DEdFhtWPIyqJ3QTRFgQ5uYG38Pb1JeEDULFJIy+s5Tjcv7OqArrJcAtKugDQtJD860q8yPCxwVGhrQJ8y+xy18ElnpJCankDSJA5JVaXQSgVRoF5urAHA0ZkpZpKvDDwieFhUkXXqY8evyfhX8ISTqeqlwVXpPzIV9kqZsAlCQSMByvFmLpQVedQrmPCpBhjcAIkZQQcPF3EF4Wtgl8TlpuqMDX5fy69w/EdpxI0K9KPJR0y8uUN1PX1gkEqA8KdwjWQi/7j7Bb+LcwKjRSdsv5g3EqEJsAFC4SYPBlcSri8Owi6YSY1Av0CZAkrIzpxmPCgEDiBsfHMraet5Qjcv7euApNCEAlRAKidIyeZmHKImYgnzFLIIidIVwRCKQuCPTqYcE7YaMi6pbTcr5JKtmSAF1qDiTorbtZ2YNhLDCkm7aKAMz/scWMANREowD6HhaW8jkTcwsMSuObcr5ZbsGUAEFzRYQHdL48+JwdTSxwWI4nDjEVFwJQQ5EAAkCETOJZgN6+T84P/YInSnFuBKASIgFBIcuypF4eUWwrCbkF8vtuAakrAfCESEC0TXBI5jCT8BZ4R7cS7LEycRN3AlBzkYDULcEhbxIzqW2B47qFYC9ybr+26uI7EiFAUKSIAAEgAoTIZKoFcDiOhwCJSKIEoEUiAcmXlcJ8PmdSsAD5/F1yPgmpxCRxAgQtExFIGJGqhRDtLDh8rxxfcwevh5EaRgAak48N7tUpuXoyie0kZPKOCvuTmOsrGbahBAgqlZ8WVugzMUKrEwHHnxAOJj3cq8wpkgoCBLUSEXgxw2hAKrnVcges6Y8JZPSS3jSiYstLqggQVFFEYJfRcqFPaMSOIxVrJuzYGRBwPOepklQSILBQPkYgm7hEYNWQ6voG9daR9C1RPUM9r27d1/Mqpy5pFoMSME5XCyECSGtWcUR1w+mn5HT2GKRemoYAky0pMrCz506BDR6MDI2aJtg1RE8/A+T0Szo2lTQlAUotLEL06BpEAIwOjBYeQq8mR39WwOH0+KaWliBAqQdECEaEOcLsSUeukYKejGDkIDhjnp4Mro0KbATNHeXw1AVxqlss+T+JiCV7XFaNoQAAAABJRU5ErkJggg==",t.isDebug=!1,this.IS_DEBUG=t.isDebug,this.panoViewer=new $i({container:this.CONTAINER.stage,containerHotspot:this.CONTAINER.hotspot,containerElementHolder:this.CONTAINER.elementHolder,dimensionsHotspot:e,pathAssetHotspot:i,callbackHotspotClick:this.onHotspotClick.bind(this),isDebug:t.isDebug,colourClear:t.colourClear,colourBackground:t.colourBackground,colourBackgroundInitialDetail:t.colourBackgroundInitialDetail})}showUI(){this.CONTAINER.main.classList.remove("hide-ui")}hideUI(){this.CONTAINER.main.classList.add("hide-ui")}parseUrl(){if(document.location){let t=document.location.pathname.replace(mn.BASEPATH,"");if(this.log("Checking document location for config: "+t),t=t.split("/"),2===t.length?(this.log(`Setting scene and config from url ${t[0]} ${t[1]}`),this.scene=t[0],t=t[1]):1===t.length&&(this.log("Setting config from url: "+t[0]),t=t[0]),t.length)return t}}setBasePath(t){mn.BASEPATH=t}toggleFullScreen(){this.FULLSCREEN_CONTROLLER.toggleFullScreen()}addHotspot(t,e,i){this.panoViewer.addHotspot(t,e,i)}clearHotspots(){this.panoViewer.clearHotspots()}addElementHolder(t,e,i){this.panoViewer.addElementHolder(t,e,i)}clearElementHolders(){this.panoViewer.clearElementHolders()}getSkuList(){let t=[];return this.getActiveElements().items.forEach(e=>{e.productCode&&t.push(e.productCode)}),t}setSku(t){for(let e=0;e<this.allLayers.length;e++){const i=this.allLayers[e];if(i.items){const e=i.items;for(let i=0;i<e.length;i++)if(e[i].attributes.product_code===t){e[i].setActive();break}}}}setSkuList(t){for(let e=0;e<this.allLayers.length;e++){const i=this.allLayers[e];if(i.items){const e=i.items;if(0===t.length)break;for(let i=0;i<e.length;i++)if(t.includes(e[i].attributes.product_code)){e[i].setActive();let n=t.indexOf(e[i].attributes.product_code);if(-1!==n&&t.splice(n,1),0===t.length)break}}}}}mn.Configurator=fn;const pn={updateUrl:!1,updateBrowserUrlMode:2,isDebug:!0,fullscreen:{hideMenu:!0,enabled:!0},hotspots:!0,hotspotFocus:!0,configStringBase:16,gestureHandling:{mode:"cooperative",container:document.getElementById("gesture-hinter"),enabledZoom:!0,enabledRotate:!0,enabledZoomFullscreen:!0,enabledRotateFullscreen:!0,enabledZoomRotate:!0,hinterMessageZoom:"Use ctrl + scroll to zoom",hinterMessageTouch:"Use two fingers to look around",rotationScalar:500,touchZoomDelta:25},remote:!1,screenshot:{format:"jpeg",quality:.85},colourClear:[1,1,1],colourBackground:[.917,.914,.894],colourBackgroundInitialDetail:[.702,.631,.415]};class Tn{constructor(t={}){this.viewerElName="onfigr",this.create(t);const e=new CustomEvent("viewer-loaded",{});this.container.dispatchEvent(e)}create(t){const e=document.querySelectorAll(this.viewerElName);if(0===e.length)throw new Error(`The configurator couldn't locate a DOM element named <${this.viewerElName}>. Stopping initialisation.`);if(e.length>1)throw new Error(`Multiple <${this.viewerElName}> elements found in page. Stopping initialisation.`);this.container=e[0];let i=Tn.updateDefaults(t);i.configuratorElement=this.container,i=this.setUserAttributes(i),this.Configurator=new fn(i);return new MutationObserver(this.loadAttributeChange.bind(this)).observe(this.container,{attributes:!0,childList:!1,subtree:!1}),Object.defineProperty(this.container,"getAttribute",{value:t=>"config"===t?this.Configurator.buildConfigString():"screenshot"===t?this.Configurator.getScreenshot():window.HTMLElement.prototype.getAttribute.call(this.container,t)}),Object.defineProperty(this.container,"buildConfigString",{value:()=>this.Configurator.buildConfigString()}),Object.defineProperty(this.container,"setConfiguration",{value:t=>{this.Configurator.setConfiguration(t)}}),Object.defineProperty(this.container,"getActiveElements",{value:()=>this.Configurator.getActiveElements()}),Object.defineProperty(this.container,"api",{value:this.Configurator}),this.Configurator}setUserAttributes(t){const e=t;e.settings={},e.configuratorElement=this.container;const i=this.container.getAttribute("config");if(null!==i&&0!==i.length&&(e.config=i),null===this.container.getAttribute("image-src"))throw new Error(`Missing 'image-src' attribute of <${this.viewerElName}>.`);if(e.settings.DYNAMIC_BASE_URL=this.container.getAttribute("image-src"),null!==this.container.getAttribute("gesture-handling")&&(console.log(this.container.getAttribute("gesture-handling")),e.gestureHandling.mode=this.container.getAttribute("gesture-handling")),null!==this.container.getAttribute("base-path")&&(e.settings.BASE_PATH=this.container.getAttribute("base-path")),null===this.container.getAttribute("asset-src"))throw new Error(`Missing 'asset-src' attribute of <${this.viewerElName}>.`);if(e.settings.STATIC_BASE_URL=this.container.getAttribute("asset-src"),null===this.container.getAttribute("scene"))throw new Error(`Missing 'scene' attribute of <${this.viewerElName}>.`);if(e.scene=this.container.getAttribute("scene"),null===this.container.getAttribute("version"))throw new Error(`Missing 'version' attribute of <${this.viewerElName}>.`);return e.settings.DYNAMIC_VERSION=this.container.getAttribute("version"),null!==this.container.getAttribute("url-update")&&(e.updateBrowserUrl=this.container.getAttribute("url-update")),null!==this.container.getAttribute("data-filename")?e.settings.DYNAMIC_DATA_FILENAME=this.container.getAttribute("data-filename"):void 0===e.settings.DYNAMIC_DATA_FILENAME&&(e.settings.DYNAMIC_DATA_FILENAME="liveDataExport"),e}static updateDefaults(t){return{...pn,...t}}loadAttributeChange(t){for(const e of t){if("attributes"===e.type&&"config"===e.attributeName){const t=window.HTMLElement.prototype.getAttribute.call(this.container,"config");this.Configurator.setConfiguration(t)}if("attributes"===e.type&&"scene"===e.attributeName){const t=window.HTMLElement.prototype.getAttribute.call(this.container,"scene");this.Configurator.setScene(t)}if("attributes"===e.type&&"base-path"===e.attributeName){const t=window.HTMLElement.prototype.getAttribute.call(this.container,"base-path");this.Configurator.setBasePath(t)}}}}var Rn=Tn,An=(i(60),i(64),i(104),i(33),function(){function t(t,e){var i=this;this.HOLDER=t,this.CONTAINER=document.createElement("div"),this.CONTAINER.className="menu-bar__container active",this.API=e,this.BACK_BUTTON=document.createElement("div"),this.BACK_BUTTON.classList.add("back_btn"),this.BACK_BUTTON.onclick=function(t){i.HOLDER.dispatchEvent(new CustomEvent("nav-back"))},this.MENU_CONTAINER=document.createElement("div"),this.MENU_CONTAINER.classList.add("menu-container"),this.CONTAINER.appendChild(this.BACK_BUTTON),this.CONTAINER.appendChild(this.MENU_CONTAINER),this.HOLDER.appendChild(this.CONTAINER),this.ITEMS=[]}var e=t.prototype;return e.reset=function(){void 0!==this.MENU_CONTAINER&&this.MENU_CONTAINER.replaceChildren()},e.updateLayers=function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.reset();var n=document.createDocumentFragment();i?i.forEach((function(r,s){var o;if(r.nested_layers)o=e.createMenuItem({name:r.name,type:"pallets",thumbnail:r.thumbnail,isNested:!0},s,!0),e.ITEMS.push(o),e.UI_LAYERS=i;else{var a=t.findIndex((function(t){return r.layer_name===t.name}));if(a<0)return;o=e.createMenuItem({name:r.name,type:t[a].type,thumbnail:r.thumbnail},a),e.ITEMS.push(o)}n.appendChild(o)})):t.forEach((function(t,i){var r=e.createMenuItem(t,i);n.appendChild(r),e.ITEMS.push(r)})),this.MENU_CONTAINER.appendChild(n)},e.activateLayer=function(t){this.HOLDER.dispatchEvent(new CustomEvent("activate-layer",{detail:{layerIndex:t,isNested:!1}}))},e.activateNestedLayer=function(t){this.HOLDER.dispatchEvent(new CustomEvent("activate-layer",{detail:{layerIndex:t,isNested:!0,nestedLayers:this.UI_LAYERS[t].nested_layers}}))},e.createMenuItem=function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("hidden"!==t.type){var r=document.createElement("div");r.className="menu-bar__option";var s=document.createElement("p");if(s.innerText=t.name,r.appendChild(s),t.thumbnail){var o=document.createElement("img");o.src="./image/".concat(t.thumbnail),r.appendChild(o)}return r.addEventListener("click",(function(t){i.ITEMS.forEach((function(t){t.classList.remove("active"),t.classList.add("add-opacity")})),r.classList.add("active"),r.classList.remove("add-opacity"),n?i.activateNestedLayer(e,n):i.activateLayer(e)})),r}},e.onMenuClose=function(){this.ITEMS.forEach((function(t){t.classList.remove("active"),t.classList.remove("add-opacity")}))},e.hide=function(){this.CONTAINER.classList.remove("active")},e.show=function(){this.CONTAINER.classList.add("active")},t}()),gn=function(){function t(t,e,i,n,r){var s=this;this.HOLDER=i,this.PARENT=t,this.ITEMS=n,this.CONTAINER=document.createElement("div"),this.CONTAINER.classList.add("drop-down"),this.SELECTED=document.createElement("div"),this.SELECTED.classList.add("drop-down___selected");var o=document.createElement("p");o.classList.add("drop-down___name"),o.innerText=e,this.CURRENT_VALUE=document.createElement("p"),this.CURRENT_VALUE.classList.add("drop-down___value"),this.SELECTED.appendChild(o),this.SELECTED.appendChild(this.CURRENT_VALUE),this.OPTIONS=document.createElement("div"),this.OPTIONS.classList.add("drop-down___options"),this.CONTAINER.appendChild(this.SELECTED),this.CONTAINER.appendChild(this.OPTIONS),this.HOLDER.appendChild(this.CONTAINER),this.optionsActive=!1,this.SELECTED.onclick=function(){s.optionsActive?s.hideOptions():s.showOptions()},this.setSelected(r)}var e=t.prototype;return e.clearOptions=function(){void 0!==this.OPTIONS&&this.OPTIONS.replaceChildren()},e.buildOptions=function(){var t=this;this.clearOptions();for(var e=function(e){var i=document.createElement("div");i.classList.add("drop-down___option"),i.onclick=function(){t.setSelected(e)};var n=document.createElement("input");n.type="radio",e===t.SELECTED_INDEX&&(n.checked=!0,i.classList.add("selected"));var r=document.createElement("p");r.innerText=t.ITEMS[e].value,i.appendChild(n),i.appendChild(r),t.OPTIONS.appendChild(i)},i=0;i<this.ITEMS.length;i++)e(i)},e.setSelected=function(t){this.SELECTED_INDEX=t,this.CURRENT_VALUE.innerText=this.ITEMS[this.SELECTED_INDEX].value,this.buildOptions(),this.hideOptions()},e.showOptions=function(){this.OPTIONS.classList.add("active"),this.optionsActive=!0},e.hideOptions=function(){this.OPTIONS.classList.remove("active"),this.optionsActive=!1},t}(),vn=function(){function t(t,e,i,n){this.HOLDER=t,this.build(e,i,n)}var e=t.prototype;return e.build=function(t,e,i){if(!t.disabled){this.CONTAINER=document.createElement("div"),this.CONTAINER.className="menu-item",this.CONTAINER.dataset.index=e,this.HOLDER.appendChild(this.CONTAINER),this.createItemHeader();var n=document.createElement("p");n.className="menu-item__name",n.innerText=t.attributes.name;var r=document.createElement("p");r.className="menu-item__price",r.innerText="$800";var s=document.createElement("img");s.className="menu-item__thumb",s.src=t.attributes.thumbnail,this.CONTAINER.appendChild(s),this.CONTAINER.appendChild(n),this.CONTAINER.appendChild(r);new gn(this,"Size",this.CONTAINER,[{value:'30"'},{value:'20"'},{value:'20"'}],0);t.active&&this.setActive(!0)}},e.setActive=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t?(this.CONTAINER.classList.add("active"),this.active=!0):(this.CONTAINER.classList.remove("active"),this.active=!1)},e.createItemHeader=function(){var t=document.createElement("div");t.classList.add("item-header__container");var e=document.createElement("div");e.classList.add("selected_indicator");var i=document.createElement("div");i.classList.add("tick");var n=document.createElement("p");n.innerText="Selected",e.appendChild(i),e.appendChild(n),this.PRODUCT_INFO_BUTTON=document.createElement("div"),this.PRODUCT_INFO_BUTTON.classList.add("product-info__btn"),t.appendChild(e),t.appendChild(this.PRODUCT_INFO_BUTTON),this.CONTAINER.appendChild(t)},e.createColorSelector=function(t){var e=document.createElement("div");e.className="colour-selector__container",this.CONTAINER.appendChild(e);var i=document.createElement("div");i.className="colour-thumb__container",e.appendChild(i);var n=document.createDocumentFragment();t.forEach((function(t){var e=document.createElement("div");e.className="colour__thumb active";var i=document.createElement("img");i.src=t.thumbnail,e.appendChild(i),n.appendChild(e)})),i.appendChild(n);var r=document.createElement("p");r.className="colour__selected",r.innerText=t[0].name,e.appendChild(r)},t}(),_n=function(){function t(t,e,i,n){this.MENU=t,this.ITEM_CONTAINER=document.createElement("div"),this.ITEM_CONTAINER.className="item__container",e.appendChild(this.ITEM_CONTAINER),this.selectedIndex=0,this.build(i,n)}var e=t.prototype;return e.build=function(t,e){var i,n=this,r=document.createDocumentFragment(),s=[];t.forEach((function(t,o){if(!t.disabled){var a=new vn(r,t,o,e);s.push(a),a.CONTAINER.addEventListener("click",(function(t){n.setItemActive(a.CONTAINER.dataset.index),n.selectedIndex!=a.CONTAINER.dataset.index&&n.MENU.showSelectMenu()})),a.PRODUCT_INFO_BUTTON.addEventListener("click",(function(t){n.setProductInfo(a.CONTAINER.dataset.index)})),t.active&&(i=a,n.selectedIndex=o)}})),this.ITEM_CONTAINER.appendChild(r),this.ITEMS=s,this.ITEM_CONTAINER.prepend(i.CONTAINER);var o=this.createDecisionPanel();this.ITEM_CONTAINER.appendChild(o)},e.createDecisionPanel=function(){var t=document.createElement("div");t.className="decision_panel__container";var e=document.createElement("div");e.className="decision__heaading",e.innerText="Don't see anything you love?";var i=document.createElement("p");i.className="decision__text",i.innerText="Work directly with a Made designer to make updates to your chosen Design Package.";var n=document.createElement("button");return n.className="button transparent",n.innerText="Talk to our design Team",t.appendChild(e),t.appendChild(i),t.appendChild(n),t},e.setItemActive=function(t){this.ITEMS.forEach((function(e){e.CONTAINER.dataset.index===t?e.setActive(!0):e.setActive(!1)}))},e.setProductInfo=function(t){this.MENU.setProductInfo(t)},t}(),On=function(){function t(t,e,i){this.MENU=t,this.NESTED_CONTAINER=document.createElement("div"),this.NESTED_CONTAINER.className="nested-menu__container",e.appendChild(this.NESTED_CONTAINER),this.layers=[],this.selectedNestedItems=[],this.build(i)}var e=t.prototype;return e.build=function(t){var e=this;t.forEach((function(t,i){var n=e.createHeader(e.NESTED_CONTAINER,t.layerName),r=document.createElement("div");r.className="item__container collapse",e.NESTED_CONTAINER.appendChild(r);var s,o=document.createDocumentFragment(),a=[];t.items.forEach((function(r,h){if(!r.disabled){var c=new vn(o,r,h,t.layerName);c.CONTAINER.addEventListener("click",(function(r){e.setItemActive(i,c.CONTAINER.dataset.index),e.MENU.showSelectMenu(),n.selected.innerText="".concat(t.layerName," ").concat(h),s=c})),c.PRODUCT_INFO_BUTTON.addEventListener("click",(function(t){e.setProductInfo(c.CONTAINER.dataset.index)})),c.active&&(s=c,n.selected.innerText="".concat(t.layerName," ").concat(h),e.selectedNestedItems.push({layerIndex:t.layerIndex,index:h})),a.push(c)}})),r.appendChild(o),n.container.addEventListener("click",(function(t){n.container.classList.contains("active")?(r.classList.add("collapse"),n.container.classList.remove("active")):(r.classList.remove("collapse"),n.container.classList.add("active"),r.prepend(s.CONTAINER))})),r.prepend(s.CONTAINER),e.layers.push({items:a,layerIndex:t.layerIndex})}))},e.createDecisionPanel=function(){var t=document.createElement("div");t.className="decision_panel__container";var e=document.createElement("div");e.className="decision__heaading",e.innerText="Need help?";var i=document.createElement("p");i.className="decision__text",i.innerText="Work directly with a Made designer to make updates to your chosen Design Package.";var n=document.createElement("button");return n.className="button transparent",n.innerText="Upgrade to design modification",t.appendChild(e),t.appendChild(i),t.appendChild(n),t},e.setItemActive=function(t,e){this.layers[t].items.forEach((function(t){t.CONTAINER.dataset.index===e?t.setActive(!0):t.setActive(!1)}))},e.setProductInfo=function(t){this.MENU.setProductInfo(t)},e.createHeader=function(t,e){var i=document.createElement("div");i.className="nested-header__container";var n=document.createElement("h2");n.innerText=e;var r=document.createElement("p");return t.appendChild(i),i.appendChild(n),i.appendChild(r),{container:i,selected:r}},t}(),In=function(){function t(t,e){this.HOLDER=t,this.API=e,this.CONTAINER=document.createElement("div"),this.CONTAINER.className="menu__container",this.HOLDER.appendChild(this.CONTAINER),this.previousNestedItems=[],this.previousItemIndex=0,this.layerIndex=0}var e=t.prototype;return e.reset=function(){void 0!==this.CONTAINER&&(this.CONTAINER.replaceChildren(),this.CONTAINER.classList.remove("active"),this.createCancelHeader(this.CONTAINER),this.createBody(this.CONTAINER),this.createMenuHeader(this.BODY),this.createBottomBar())},e.create=function(t){var e=this,i=(t.layerType,t.layerDescription),n=t.layerName,r=t.items,s=t.layerIndex;this.reset(),this.addMenuDetails(n,i),this.MENU=new _n(this,this.BODY,r,n),this.previousItemIndex=this.MENU.selectedIndex,this.layerIndex=s,this.MENU.ITEMS.forEach((function(t){t.CONTAINER.addEventListener("click",(function(i){e.setItemActive(t.CONTAINER.dataset.index,s)}))})),this.show()},e.createNested=function(t){var e=this,i=(t.layerType,t.layerDescription),n=t.layerName,r=(t.items,t.layerIndex),s=t.nestedLayers;this.reset(),this.addMenuDetails(n,i),this.MENU=new On(this,this.BODY,s),this.previousNestedItems=this.MENU.selectedNestedItems,this.layerIndex=r,this.MENU.layers.forEach((function(t){t.items.forEach((function(i){i.CONTAINER.addEventListener("click",(function(n){e.setItemActive(i.CONTAINER.dataset.index,t.layerIndex)}))}))})),this.show()},e.createCancelHeader=function(t){this.SUB_HEADER=document.createElement("p");var e=document.createElement("div");this.CANCEL_HEADER=document.createElement("div"),this.CANCEL_HEADER.className="menu__canel-header",this.CANCEL_HEADER.appendChild(this.SUB_HEADER),this.CANCEL_HEADER.appendChild(e),e.onclick=this.hide.bind(this),t.appendChild(this.CANCEL_HEADER)},e.createMenuHeader=function(t){this.HEADER=document.createElement("div"),this.HEADER.className="menu__header",t.appendChild(this.HEADER)},e.createBody=function(t){this.BODY=document.createElement("div"),this.BODY.className="menu__body",this.BODY.addEventListener("scroll",this.scrollAnimation.bind(this)),t.appendChild(this.BODY)},e.createBottomBar=function(){var t=this;this.BOTTOM_BAR=document.createElement("div"),this.BOTTOM_BAR.className="menu__bottom-bar";var e=document.createElement("div");e.className="info_btn",e.onclick=function(){t.HOLDER.dispatchEvent(new CustomEvent("active-summary"))};var i=document.createElement("div");i.className="menu__price-details";var n=document.createElement("p");n.className="menu__price_detail",n.innerText="Est. materials total",this.PRICE=document.createElement("p"),this.PRICE.className="menu__price_value",this.PRICE.innerText="$8,200-$12,800",i.appendChild(n),i.appendChild(this.PRICE);var r=document.createElement("div");r.className="menu__buttons-container";var s=document.createElement("button");s.className="menu__button",s.innerText="Apply",s.onclick=this.hide.bind(this);var o=document.createElement("button");o.className="menu__button transparent",o.innerText="Cancel",o.onclick=this.cancel.bind(this),r.appendChild(s),r.appendChild(o),this.BOTTOM_BAR.appendChild(i),this.BOTTOM_BAR.appendChild(r),this.BOTTOM_BAR.appendChild(e),this.BODY.appendChild(this.BOTTOM_BAR)},e.addMenuDetails=function(t,e){var i=document.createElement("h1");i.className="menu__heading",i.innerText=t,this.SUB_HEADER.innerText=t;var n=document.createElement("p");n.className="menu__description",n.innerText=e,this.HEADER.appendChild(i),this.HEADER.appendChild(n)},e.setItemActive=function(t,e){this.API.layers[e].items[t].setActive(),this.HOLDER.dispatchEvent(new CustomEvent("item-selected",{}))},e.setProductInfo=function(t){this.HOLDER.dispatchEvent(new CustomEvent("active-product-info"))},e.scrollAnimation=function(t){t.target.scrollTop>25?this.CANCEL_HEADER.classList.add("scrolled"):this.CANCEL_HEADER.classList.remove("scrolled")},e.show=function(){this.CONTAINER.classList.add("active")},e.hide=function(){this.CONTAINER.classList.remove("active"),this.HOLDER.dispatchEvent(new CustomEvent("menu-closed",{}))},e.showSelectMenu=function(){this.BOTTOM_BAR.classList.add("active")},e.cancel=function(){var t=this;this.previousNestedItems.length>0?this.previousNestedItems.forEach((function(e){t.setItemActive(e.index,e.layerIndex)})):this.setItemActive(this.previousItemIndex,this.layerIndex),this.hide()},t}(),Cn=i(1),Ln=function(){function t(t,e){var i=this;this.HOLDER=t,this.CONTAINER=document.createElement("div"),this.CONTAINER.classList.add("room-title__container","active"),this.ROOM_TITLE=document.createElement("h1"),this.ROOM_TITLE.innerText="Sausalito";var n=document.createElement("div");n.classList.add("room-title__subtitle");var r=document.createElement("p");r.innerText="".concat("Primary bathroom"," / Est $").concat(24e3.toLocaleString());var s=document.createElement("div");s.classList.add("info-btn"),s.onclick=function(){i.HOLDER.dispatchEvent(new CustomEvent("active-summary"))},n.appendChild(r),n.appendChild(s),this.CONTAINER.appendChild(this.ROOM_TITLE),this.CONTAINER.appendChild(n),this.HOLDER.appendChild(this.CONTAINER)}var e=t.prototype;return e.setTitle=function(t){this.ROOM_TITLE.innerText=t},e.hide=function(){this.CONTAINER.classList.remove("active")},e.show=function(){this.CONTAINER.classList.add("active")},t}(),Nn=function(){function t(t,e){this.HOLDER=t,this.API=e,this.CONTAINER=document.createElement("div"),this.CONTAINER.classList.add("summary-panel"),this.HOLDER.appendChild(this.CONTAINER)}var e=t.prototype;return e.createBody=function(t){this.BODY=document.createElement("div"),this.BODY.className="summary__body",this.BODY.addEventListener("scroll",this.scrollAnimation.bind(this)),t.appendChild(this.BODY)},e.reset=function(){void 0!==this.CONTAINER&&(this.CONTAINER.replaceChildren(),this.CONTAINER.classList.remove("active"),this.createCancelHeader(this.CONTAINER),this.createBody(this.CONTAINER),this.createHeader(this.BODY))},e.create=function(t){this.reset(),this.show(),this.createRoomDetails(),this.createPrice(),this.createProductDetails(),this.createSaveButton()},e.createRoomDetails=function(){var t=document.createElement("div");t.classList.add("details-container"),[{id:1,item:"Room",description:"Primary bathroom"},{id:2,item:"Layout",description:"Separate tub & shower"},{id:3,item:"Size",description:"108 sq ft"},{id:4,item:"Package",description:"Sausalito"},{id:5,item:"Design offering",description:"Design modification"}].forEach((function(e){var i=document.createElement("div");i.classList.add("item-detail");var n=document.createElement("p");n.classList.add("left");var r=document.createElement("p");r.classList.add("right"),n.innerText=e.item,r.innerText=e.description,i.appendChild(n),i.appendChild(r),t.appendChild(i)})),this.BODY.appendChild(t)},e.createPrice=function(){var t=document.createElement("div");t.classList.add("details-container");var e=document.createElement("div");e.classList.add("item-detail"),e.classList.add("price");var i=document.createElement("p");i.classList.add("left");var n=document.createElement("p");n.classList.add("right"),i.innerText="Est. materials price",n.innerText="$8,200-$12,800",e.appendChild(i),e.appendChild(n),t.appendChild(e);var r=document.createElement("div");r.classList.add("item-detail"),r.classList.add("price");var s=document.createElement("p");s.classList.add("left");var o=document.createElement("p");o.classList.add("right"),s.innerText="Est. lead time",o.innerText="2-3 weeks",r.appendChild(s),r.appendChild(o),t.appendChild(r),this.BODY.appendChild(t)},e.createProductDetails=function(){var t=document.createElement("div");t.classList.add("products-container"),[{id:1,name:"Your materials",itemCount:12,items:[{imgUrl:null,name:"Vanity",qty:1},{imgUrl:null,name:"Mirror",qty:2},{imgUrl:null,name:"Lighting",qty:2},{imgUrl:null,name:"Fixtures",qty:2},{imgUrl:null,name:"Toilet",qty:2},{imgUrl:null,name:"Tub",qty:1}]}].forEach((function(e){var i=document.createElement("div");i.classList.add("product-detail");var n=document.createElement("div");n.classList.add("product-detail__header"),n.onclick=function(){i.classList.contains("active")?i.classList.remove("active"):i.classList.add("active")};var r=document.createElement("div");r.classList.add("product-detail__body");var s=document.createElement("p");s.classList.add("set-name"),s.innerText=e.name;var o=document.createElement("p");o.classList.add("set-price"),o.innerText="".concat(e.itemCount," items"),n.appendChild(s),n.appendChild(o),e.items.forEach((function(t){var e=document.createElement("div");e.classList.add("item_list");var i=document.createElement("div");i.classList.add("left");var n=document.createElement("div"),s=document.createElement("p");s.innerText=t.name,i.appendChild(n),i.appendChild(s);var o=document.createElement("div");o.classList.add("right");var a=document.createElement("p");a.innerText="".concat(t.qty,"x"),o.appendChild(a),e.appendChild(i),e.appendChild(o),r.appendChild(e)})),i.appendChild(n),i.appendChild(r),t.appendChild(i)})),this.BODY.appendChild(t)},e.createSaveButton=function(){var t=this,e=document.createElement("button");e.classList.add("save-button"),e.innerText="Save your design",e.onclick=function(){t.HOLDER.dispatchEvent(new CustomEvent("save-design"))},this.BODY.appendChild(e)},e.createHeader=function(t){var e=document.createElement("h1");e.innerText="Summary",t.appendChild(e)},e.createCancelHeader=function(t){var e=this,i=document.createElement("p");i.innerText="Summary";var n=document.createElement("div");n.classList="made-logo-dark";var r=document.createElement("div");r.className="cancel_icon",this.CANCEL_HEADER=document.createElement("div"),this.CANCEL_HEADER.className="summary__cancel-header",this.CANCEL_HEADER.appendChild(i),this.CANCEL_HEADER.appendChild(r),this.CANCEL_HEADER.appendChild(n),r.onclick=function(){e.HOLDER.dispatchEvent(new CustomEvent("hide-summary",{}))},t.appendChild(this.CANCEL_HEADER)},e.scrollAnimation=function(t){t.target.scrollTop>35?this.CANCEL_HEADER.classList.add("scrolled"):this.CANCEL_HEADER.classList.remove("scrolled")},e.show=function(){this.CONTAINER.classList.add("active")},e.hide=function(){this.CONTAINER.classList.remove("active")},t}(),yn=function(){function t(t,e,i,n){this.HOLDER=e,this.PARENT=t,this.ITEMS=i,this.CONTAINER=document.createElement("div"),this.CONTAINER.classList.add("radio-menu"),this.OPTIONS=document.createElement("div"),this.OPTIONS.classList.add("radio-menu___options"),this.CONTAINER.appendChild(this.OPTIONS),this.HOLDER.appendChild(this.CONTAINER),this.setSelected(n)}var e=t.prototype;return e.clearOptions=function(){void 0!==this.OPTIONS&&this.OPTIONS.replaceChildren()},e.buildOptions=function(){var t=this;this.clearOptions();for(var e=function(e){var i=document.createElement("div");i.classList.add("radio-menu___option"),t.SELECTED_INDEX===e&&i.classList.add("active"),t.SELECTED_INDEX!==e&&(i.onclick=function(){t.setSelected(e)});var n=document.createElement("div");if(n.classList.add("selector"),t.ITEMS[e].imgUrl){var r=document.createElement("img");n.appendChild(r)}else{var s=document.createElement("div");s.classList.add("dot"),n.appendChild(s)}var o=document.createElement("p");o.classList.add("selector-text"),o.innerText=t.ITEMS[e].value,i.appendChild(n),i.appendChild(o),t.OPTIONS.appendChild(i)},i=0;i<this.ITEMS.length;i++)e(i)},e.setSelected=function(t){this.SELECTED_INDEX=t,this.buildOptions()},t}(),Sn=function(){function t(t,e){this.HOLDER=t,this.API=e,this.CONTAINER=document.createElement("div"),this.CONTAINER.classList.add("product-info-panel"),this.HOLDER.appendChild(this.CONTAINER)}var e=t.prototype;return e.reset=function(){void 0!==this.CONTAINER&&(this.CONTAINER.replaceChildren(),this.CONTAINER.classList.remove("active"),this.createCancelHeader(this.CONTAINER))},e.create=function(t){this.reset(),this.show(),this.createInfoContent(),this.createSpecSheet()},e.createCancelHeader=function(){var t=document.createElement("div");this.CANCEL_HEADER=document.createElement("div"),this.CANCEL_HEADER.className="product__canel-header",this.CANCEL_HEADER.appendChild(t),t.onclick=this.hide.bind(this),this.CONTAINER.appendChild(this.CANCEL_HEADER)},e.createInfoContent=function(){var t={title:"Kai",description:"This sculptural, contemporary floating vanity features an offset vessel sink and plenty of countertop space for tools, jars, and anything else you need in the bathroom. The cabinet is made from solid maple or chestnut hardwood, with a vast drawer that seamlessly fits into the wave texture of the sides of the unit. Pull out the drawer to reveal an enormous storage space, ready to be organized however you see fit. To top it all off is the luxurious quartz counter in a striking dark shade.",size:[{value:'30" double sink'},{value:'40" double sink',selected:!0},{value:'30" double sink'}],finishes:[{value:"Natural Teak",selected:!0,imgUrl:""},{value:"Brown Reclaimed Wood",imgUrl:""}],price:1200,brand:"Avanity"},e=document.createElement("div");e.classList.add("content");var i=document.createElement("div");i.classList.add("header-container");var n=document.createElement("h2");n.innerText=t.title;var r=document.createElement("p");r.innerText=t.description;var s=document.createElement("p");s.classList.add("read-more"),s.innerText="Read More",i.appendChild(n),i.appendChild(r),i.appendChild(s);var o=document.createElement("div");o.classList.add("image-container");var a=document.createElement("div");o.appendChild(a);var h=document.createElement("div");h.classList.add("details-container"),t.size&&h.appendChild(this.buildList("Size",t.size)),t.finishes&&h.appendChild(this.buildList("Finishes",t.finishes)),t.price&&h.appendChild(this.buildList("Prices","$".concat(t.price.toLocaleString()))),t.brand&&h.appendChild(this.buildList("Brand",t.brand)),e.appendChild(i),e.appendChild(o),e.appendChild(h),this.CONTAINER.appendChild(e)},e.buildList=function(t,e){var i=document.createElement("div");i.classList.add("list");var n=document.createElement("p");if(n.innerText=t,i.appendChild(n),Array.isArray(e)){var r=e.findIndex((function(t){return t.selected}));new yn(this,i,e,r)}else{var s=document.createElement("p");s.classList.add("value-text"),s.innerText=e,i.appendChild(s)}return i},e.createSpecSheet=function(){var t=document.createElement("div");t.classList.add("spec-sheet-container"),this.SPEC_SHEET=document.createElement("p"),this.SPEC_SHEET.classList.add("spec-sheet"),t.appendChild(this.SPEC_SHEET),this.SPEC_SHEET.innerText="Specification Sheet",t.appendChild(this.SPEC_SHEET),this.CONTAINER.appendChild(t)},e.show=function(){this.CONTAINER.classList.add("active")},e.hide=function(){this.CONTAINER.classList.remove("active")},t}(),bn=function(){function t(t,e){var i=this;this.HOLDER=t,this.API=e,this.CONTAINER=document.createElement("div"),this.CONTAINER.classList.add("info-summary__container"),this.CONTAINER.classList.add("active"),this.SCENE_TITLE=document.createElement("h1"),this.SCENE_TITLE.innerText="Primary Bathroom";var n=document.createElement("div");n.classList.add("info-btn"),n.onclick=function(){i.HOLDER.dispatchEvent(new CustomEvent("active-summary"))},this.SUMMARY_LIST_CONTAINER=document.createElement("div"),this.SUMMARY_LIST_CONTAINER.classList.add("summary-list__container");var r=document.createElement("div");r.classList.add("summary-list");var s=document.createElement("p");s.class="summary-list__item type",s.innerText="Est. materials price",this.SUMMARY_PRICE=document.createElement("p"),this.SUMMARY_PRICE.class="summary-list__item",this.SUMMARY_PRICE.innerText="$8,000-$12,800",r.appendChild(s),r.appendChild(this.SUMMARY_PRICE),this.SUMMARY_LIST_CONTAINER.appendChild(r);var o=document.createElement("div");o.classList.add("summary-list");var a=document.createElement("p");a.class="summary-list__item type",a.innerText="Est. lead price",this.SUMMARY_LEAD_TIME=document.createElement("p"),this.SUMMARY_LEAD_TIME.class="summary-list__item",this.SUMMARY_LEAD_TIME.innerText="2-3 weeks",o.appendChild(a),o.appendChild(this.SUMMARY_LEAD_TIME),this.SUMMARY_LIST_CONTAINER.appendChild(o);var h=document.createElement("button");h.classList.add("info-summary__button"),h.innerText="Continue",h.onclick=function(){i.HOLDER.dispatchEvent(new CustomEvent("active-summary"))},this.CONTAINER.appendChild(this.SCENE_TITLE),this.CONTAINER.appendChild(n),this.CONTAINER.appendChild(this.SUMMARY_LIST_CONTAINER),this.CONTAINER.appendChild(h),this.HOLDER.appendChild(this.CONTAINER)}var e=t.prototype;return e.show=function(){this.CONTAINER.classList.add("active")},e.hide=function(){this.CONTAINER.classList.remove("active")},t}(),Mn=function(t,e){var i=this;this.HOLDER=t,this.API=e,this.BACK_ICON=document.createElement("div"),this.BACK_ICON.className="screen_back_btn",this.BACK_ICON.onclick=function(){i.HOLDER.dispatchEvent(new CustomEvent("hide-summary",{}))},this.MADE_LOGO=document.createElement("div"),this.MADE_LOGO.className="made-logo",this.HOLDER.appendChild(this.BACK_ICON),this.HOLDER.appendChild(this.MADE_LOGO)},Dn=function(){function t(t){this.API=t,this.MAIN_CONTAINER=document.querySelector("onfigr"),this.camera={kitchen:[.17318192108047598,1.4707983317206095],bathroom:[1.2400000173021017,1.4107963279304478],"4-piece":[1.8502256518705193,1.554798297474096]},this.addEventListeners()}var e=t.prototype;return e.build=function(){var t=this.API,e=this.MAIN_CONTAINER;this.SCREEN_ICONS=new Mn(e,t),this.MENU_BAR=new An(e,t),this.ITEM_MENU=new In(e,t),this.INFO_SUMMARY=new bn(e,t),this.ROOM_TITLE=new Ln(e,t),this.SUMMARY_PANEL=new Nn(e,t),this.PRODUCT_INFO_PANEL=new Sn(e,t),Cn.layerMenus?this.MENU_BAR.updateLayers(t.listLayers,Cn.layerMenus):this.MENU_BAR.updateLayers(t.listLayers)},e.addEventListeners=function(){var t=this;this.MAIN_CONTAINER.addEventListener("hotspot-click",(function(e){var i=e.detail;t.API.panoViewer.setRotationTarget(i.hotspotTheta,i.hotspotPhi);var n=Cn.layerMenus.findIndex((function(t){return t.layer_name===e.detail.hotspotId}));t.setActiveHotspot(e.detail.hotspotId),Cn.layerMenus[n].nested_layers?t.updateMenu(!0,n):(n=t.API.layers.findIndex((function(t){return t.attributes.name===e.detail.hotspotId})),t.API.layers[n].setActive(),t.updateMenu(!1,n)),t.API.CONTAINER.main.classList.add("menu-open"),t.ROOM_TITLE.hide(),t.SUMMARY_PANEL.hide(),t.INFO_SUMMARY.hide()})),this.MAIN_CONTAINER.addEventListener("scene-data-loaded",(function(){t.build(),t.setCameraPosition(),t.addHotspots()})),this.MAIN_CONTAINER.addEventListener("activate-layer",(function(e){if(e.detail.isNested||t.API.layers[e.detail.layerIndex].setActive(),t.updateMenu(e.detail.isNested,e.detail.layerIndex),t.ROOM_TITLE.hide(),t.SUMMARY_PANEL.hide(),t.INFO_SUMMARY.hide(),t.API.CONTAINER.main.classList.add("menu-open"),e.detail.isNested){var i=Cn.layerMenus[e.detail.layerIndex];t.API.panoViewer.setRotationTarget(i.hotspot.x,i.hotspot.y)}})),this.MAIN_CONTAINER.addEventListener("menu-closed",(function(e){t.ROOM_TITLE.show(),t.MENU_BAR.onMenuClose(),t.INFO_SUMMARY.show(),t.API.CONTAINER.main.classList.remove("menu-open")})),this.MAIN_CONTAINER.addEventListener("active-summary",(function(e){t.SUMMARY_PANEL.create(),t.ROOM_TITLE.hide(),t.MENU_BAR.hide(),t.SCREEN_ICONS.BACK_ICON.classList.add("active")})),this.MAIN_CONTAINER.addEventListener("hide-summary",(function(e){t.SUMMARY_PANEL.hide(),t.MENU_BAR.show(),t.ROOM_TITLE.show(),t.SCREEN_ICONS.BACK_ICON.classList.remove("active")})),this.MAIN_CONTAINER.addEventListener("active-product-info",(function(e){t.PRODUCT_INFO_PANEL.create()})),this.MAIN_CONTAINER.addEventListener("item-selected",(function(e){t.ROOM_TITLE.ROOM_TITLE.innerText=""})),this.API.loadData()},e.setActiveHotspot=function(t){this.activeHotspot&&this.activeHotspot.classList.remove("active"),this.activeHotspot=this.MAIN_CONTAINER.querySelector('[id="hotspot_'.concat(t,'"]')),this.activeHotspot&&this.activeHotspot.classList.add("active")},e.updateMenu=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){var n=[];Cn.layerMenus[i].nested_layers.forEach((function(e){var i=t.API.layers.findIndex((function(t){return e.layer_name===t.attributes.name}));n.push({layerName:e.name,items:t.API.layers[i].items,layerIndex:i})})),this.ITEM_MENU.createNested({layerType:"nested",layerName:Cn.layerMenus[i].name,layerDescription:Cn.layerMenus[i].description,nestedLayers:n})}else if(Cn.layerMenus){var r=Cn.layerMenus.find((function(e){return t.API.layers[i].attributes.name===e.layer_name}));this.ITEM_MENU.create({layerType:"LAYER_DEFAULT",layerName:r.name,layerDescription:r.description,items:this.API.layers[i].items,layerIndex:i})}else{var s=this.API.activeLayer;this.ITEM_MENU.create({layerType:s.LAYER_TYPE,layerDescription:s.attributes.description,layerName:s.attributes.name,items:s.items,layerIndex:s.attributes.order})}},e.setCameraPosition=function(){this.API.panoViewer.setRotation(this.camera[this.API.scene][0],this.camera[this.API.scene][1])},e.addHotspots=function(){var t=this;Cn.layerMenus.forEach((function(e){t.API.addHotspot(e.layer_name,e.hotspot.x,e.hotspot.y)}))},t}(),Un=function(){function t(t){var e=this;this.IS_DEBUG=t.isDebug,1==this.IS_DEBUG&&(console.log(),console.log(t)),t.fullscreen={},t.fullscreen.hideMenu=!0,t.fullscreen.enabled=!0,t.isDebug=!1,t.configStringBase=36,t.filters=[],t.gestureHandling={container:document.getElementById("gesture-hinter"),enabledZoom:!0,enabledRotate:!0,enabledZoomFullscreen:!0,enabledZoomRotate:!0};var i=document.querySelector("onfigr");new Rn({configStringBase:36,gestureHandling:{mode:"greedy",container:document.getElementById("gesture-hinter"),enabledZoom:!0,enabledRotate:!0,enabledZoomFullscreen:!0,enabledRotateFullscreen:!0,enabledZoomRotate:!0,hinterMessageZoom:"Use ctrl + scroll to zoom",hinterMessageTouch:"Use two fingers to look around",rotationScalar:500,touchZoomDelta:25}}),this.UIController=new Dn(i.api),i.api.setRoomName=function(t){e.UIController.ROOM_TITLE.setTitle(t)},i.api.getSummary=function(){var t=i.api.getActiveElements(),e=[];return t.items.forEach((function(t){e.push({type:t.component,name:t.name,sku:t.product_code,thumbnail:"".concat(i.api.getDynamicThumbUrl()).concat(t.thumbnail.substring(1)),price:null})})),{previewImage:t.previewImage,items:e}}}return t.prototype.getConfigurator=function(){return this.CONFIGURATOR},t}(),xn=function(){function t(t){this.CONTROLLER=new Un(t)}return t.prototype.getViewer=function(){return this.CONTROLLER.getConfigurator()},t}();function Fn(t){return new xn(t)}d(),E(),document.contains=Object(m.getPolyfill)(),Fn({})}])}));